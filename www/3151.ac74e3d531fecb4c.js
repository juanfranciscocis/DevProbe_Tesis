"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[3151],{5553:(R,F,m)=>{m.d(F,{h:()=>_});var g=m(177),v=m(7863),i=m(4438);let _=(()=>{var h;class e{}return(h=e).\u0275fac=function(y){return new(y||h)},h.\u0275mod=i.$C({type:h}),h.\u0275inj=i.G2t({imports:[g.MD,v.bv]}),e})()},3241:(R,F,m)=>{m.d(F,{p:()=>_});var g=m(4438),v=m(177),i=m(7863);let _=(()=>{var h;class e{constructor(y){this.location=y,this.title="Header Title"}ngOnInit(){}goBack(){this.location.back()}}return(h=e).\u0275fac=function(y){return new(y||h)(g.rXU(v.aZ))},h.\u0275cmp=g.VBU({type:h,selectors:[["app-header-return"]],inputs:{title:"title"},decls:6,vars:2,consts:[[3,"translucent"],["slot","start","menu","menu-id"],["name","arrow-back","slot","start",1,"p-4","bigger-icon",3,"click"]],template:function(y,M){1&y&&(g.j41(0,"ion-header",0)(1,"ion-toolbar"),g.nrm(2,"ion-menu-button",1),g.j41(3,"ion-icon",2),g.bIt("click",function(){return M.goBack()}),g.k0s(),g.j41(4,"ion-title"),g.EFF(5),g.k0s()()()),2&y&&(g.Y8G("translucent",!0),g.R7$(5),g.JRh(M.title))},dependencies:[i.eU,i.iq,i.MC,i.BC,i.ai],styles:[".bigger-icon[_ngcontent-%COMP%]{font-size:1.5em}"]}),e})()},3151:(R,F,m)=>{m.r(F),m.d(F,{FlameGraphComparePageModule:()=>L});var g=m(177),v=m(4341),i=m(7863),_=m(7650),h=m(467),e=m(4438),C=m(9032),y=m(6560),M=m(8453),w=m(3241),j=m(7616),E=m(9549);const D=["messagesContainer2"];function A(t,d){if(1&t&&(e.j41(0,"ion-col",32)(1,"ion-card",33)(2,"ion-card-header")(3,"ion-card-title")(4,"h1"),e.EFF(5),e.k0s()()(),e.nrm(6,"ngx-flamegraph",34),e.k0s()()),2&t){const l=d.$implicit,a=e.XpG(2);e.R7$(5),e.SpI("Data for: ",l,""),e.R7$(),e.Y8G("config",a.configurations[l])}}function k(t,d){if(1&t&&(e.j41(0,"ion-row",4),e.DNE(1,A,7,2,"ion-col",31),e.k0s()),2&t){const l=e.XpG();e.R7$(),e.Y8G("ngForOf",l.datesForComparison)}}function T(t,d){if(1&t&&(e.j41(0,"ion-col",36)(1,"ion-card",33),e.qex(2),e.j41(3,"ion-card")(4,"ion-card-header")(5,"ion-card-title"),e.EFF(6),e.k0s()(),e.nrm(7,"ngx-flamegraph",34),e.k0s(),e.bVm(),e.k0s()()),2&t){const l=d.$implicit,a=e.XpG(2);e.R7$(6),e.SpI("Data for: ",l,""),e.R7$(),e.Y8G("config",a.configurations[l])}}function I(t,d){if(1&t&&(e.j41(0,"ion-row",4),e.DNE(1,T,8,2,"ion-col",35),e.k0s()),2&t){const l=e.XpG();e.R7$(),e.Y8G("ngForOf",l.datesForComparison)}}function O(t,d){if(1&t&&(e.j41(0,"markdown",8),e.EFF(1),e.k0s()),2&t){const l=d.$implicit;e.R7$(),e.JRh(l.message)}}function B(t,d){if(1&t&&(e.j41(0,"div",40)(1,"markdown",41),e.EFF(2),e.k0s()()),2&t){const l=e.XpG().$implicit;e.R7$(2),e.JRh(l.message)}}function S(t,d){if(1&t&&(e.j41(0,"div",42)(1,"markdown",43),e.EFF(2),e.k0s()()),2&t){const l=e.XpG().$implicit;e.R7$(),e.Mz_("id","mk-",l.id,""),e.R7$(),e.JRh(l.message)}}function z(t,d){if(1&t&&(e.j41(0,"div",37),e.DNE(1,B,3,1,"div",38)(2,S,3,3,"div",39),e.k0s()),2&t){const l=d.$implicit;e.R7$(),e.Y8G("ngIf","User"===l.from),e.R7$(),e.Y8G("ngIf","AI"===l.from)}}const N=[{path:"",component:(()=>{var t;class d{constructor(a,o,s){this.flameGraphService=a,this.loadingCtrl=o,this.route=s,this.product={},this.datesForComparison=[],this.lenDates=0,this.configurations={},this.aiAnalytic=[],this.aiModal=!1,this.message="",this.vertexAI=(0,e.WQX)(C.L9),this.model=(0,C.oc)(this.vertexAI,{model:"gemini-1.5-flash"}),this.chatCPU=this.model.startChat({history:[{role:"user",parts:[{text:"Hola, desde ahora en adelante quiero que seas un modelo experto en Software Quality Assurance y analista de datos, tu nombre es DevProbeAI, nunca lo puedes olvidar"}]},{role:"model",parts:[{text:"Soy un modelo experto en Software Quality Assurance, de igual forma tengo un masterado en anla\xedtica de datos \xbfEn qu\xe9 puedo ayudarte?"}]},{role:"user",parts:[{text:"Gracias, te voy a entregar un json con datos en unos minutos, necesito que lo analices y me des un resumen de los datos, este json contiene datos de usos de CPU de un servidor por d\xeda, imagina que ,tu analisis tiene que ser detallado, si encuentras inconsistencias en los datos, por favor mencionalas, en caso de que creas que puede haber un uso excesivo de algun servicio por favor mencionalo, si encuentras algo interesante, por favor mencionalo, en resumen, necesito un analisis detallado de los datos"}]},{role:"model",parts:[{text:"Claro, env\xedame el json y yo me encargo de analizarlo"}]}]}),this.chatMemory=this.model.startChat({history:[{role:"user",parts:[{text:"Hola, desde ahora en adelante quiero que seas un modelo experto en Software Quality Assurance y analista de datos, tu nombre es DevProbeAI, nunca lo puedes olvidar"}]},{role:"model",parts:[{text:"Soy un modelo experto en Software Quality Assurance, de igual forma tengo un masterado en anla\xedtica de datos \xbfEn qu\xe9 puedo ayudarte?"}]},{role:"user",parts:[{text:"Gracias, te voy a entregar un json con datos en unos minutos, necesito que lo analices y me des un resumen de los datos, este json contiene datos de usos de MEMORIA de un servidor por d\xeda, imagina que ,tu analisis tiene que ser detallado, si encuentras inconsistencias en los datos, por favor mencionalas, en caso de que creas que puede haber un uso excesivo de algun servicio por favor mencionalo, si encuentras algo interesante, por favor mencionalo, en resumen, necesito un analisis detallado de los datos"}]},{role:"model",parts:[{text:"Claro, env\xedame el json y yo me encargo de analizarlo"}]}]}),this.messages=[],this.wasChatOpen=!1,this.usage_type=""}ngOnInit(){}ionViewWillEnter(){this.getProductAndDatesFromParams(),this.getFlameGraph().then(()=>{this.sendMessage().then(()=>{this.chatStyle()})})}getFlameGraph(){var a=this;return(0,h.A)(function*(){try{yield a.showLoading();const s=localStorage.getItem("user");if(!s)return;const n=JSON.parse(s).orgName;console.log(n),a.configurations={};for(const u of a.datesForComparison){let c;c="memory_usage"===a.usage_type?yield a.flameGraphService.getFlameGraphByDate(n,a.product.productObjective,u,!0):yield a.flameGraphService.getFlameGraphByDate(n,a.product.productObjective,u),console.log(c);let p=[],f=[];for(let W in c){var o;const x=null===(o=c)||void 0===o?void 0:o[W];f=Object.keys(x),console.log("keys",f);const X=100/f.length;for(let G in f){const P=[];for(let b=0;b<x[f[G]].length;b++)P[b]="memory_usage"===a.usage_type?a.transformToRawDataMemory(x[f[G]][b]):a.transformToRawDataCPU(x[f[G]][b]);console.log("server1",P);const H={label:f[G],value:X,children:[...P]};p.push(H)}console.log("server",p)}p=[{label:"root",value:100,children:p}],a.configurations[u]={data:p}}console.log("Final configurations",a.configurations),yield a.hideLoading()}catch(s){console.log(s),yield a.hideLoading()}})()}getProductAndDatesFromParams(){this.route.queryParams.subscribe(a=>{this.product=JSON.parse(a.product),this.datesForComparison=JSON.parse(a.dates),this.usage_type=this.route.snapshot.queryParamMap.get("usage_type")}),this.lenDates=this.datesForComparison.length,console.log(this.product.productObjective),console.log(this.datesForComparison),console.log(this.usage_type)}doRefresh(a){this.getFlameGraph().then(()=>{a.target.complete()})}showLoading(){var a=this;return(0,h.A)(function*(){yield(yield a.loadingCtrl.create({})).present()})()}hideLoading(){var a=this;return(0,h.A)(function*(){yield a.loadingCtrl.dismiss()})()}average(a){const o=a.map(Number);return o.reduce((r,n)=>r+n,0)/o.length}transformToRawDataCPU(a){const o=a.cpu_usage?this.average(a.cpu_usage):0,s=[];for(const r in a){if("id"===r||"cpu_usage"===r)continue;const n=a[r];if("object"!=typeof n||Array.isArray(n))"object"!=typeof n&&s.push({label:r,value:0,children:[]});else if("sub_services"===r)for(const u in n){const c=n[u],f={label:u,value:c.cpu_usage?this.average(c.cpu_usage):0,children:this.transformToRawDataCPU(c).children};s.push(f)}else{const c={label:r,value:n.cpu_usage?this.average(n.cpu_usage):0,children:this.transformToRawDataCPU(n).children};s.push(c)}}return{label:a.id,value:o,children:s}}transformToRawDataMemory(a){const o=a.memory_usage?this.average(a.memory_usage):0,s=[];for(const r in a){if("id"===r||"memory_usage"===r)continue;const n=a[r];if("object"!=typeof n||Array.isArray(n))"object"!=typeof n&&s.push({label:r,value:0,children:[]});else if("sub_services"===r)for(const u in n){const c=n[u],f={label:u,value:c.memory_usage?this.average(c.memory_usage):0,children:this.transformToRawDataMemory(c).children};s.push(f)}else{const c={label:r,value:n.memory_usage?this.average(n.memory_usage):0,children:this.transformToRawDataMemory(n).children};s.push(c)}}return{label:a.id,value:o,children:s}}chatStyle(){const a=document.getElementById("analytics");if(a){let c=a.getElementsByTagName("h1"),p=a.getElementsByTagName("h2");for(var o=0;o<c.length;o++)c[o].style.fontSize="2em",c[o].style.fontWeight="bold";for(o=0;o<p.length;o++)p[o].style.fontSize="1.6em",p[o].style.fontWeight="bold"}const r=document.getElementById("mk-"+(this.messages.length-1));if(console.log(r),!r)return;let n=r.getElementsByTagName("h1"),u=r.getElementsByTagName("h2");for(o=0;o<n.length;o++)n[o].style.fontSize="2.5em",n[o].style.fontWeight="bold";for(o=0;o<u.length;o++)u[o].style.fontSize="2em",u[o].style.fontWeight="bold";this.scrollToBottom()}sendMessage(){var a=this;return(0,h.A)(function*(){if(a.aiAnalytic.length<=0){yield a.showLoading();const r=JSON.stringify(a.configurations);let n;n="memory_usage"===a.usage_type?yield a.chatMemory.sendMessage(r):yield a.chatCPU.sendMessage(r);const u=a.messages.length;return a.messages.push({message:n.response.text(),from:"AI",id:u.toString()}),a.aiAnalytic.push({message:n.response.text(),from:"AI",id:u.toString()}),yield a.hideLoading(),console.log("AI Analytic:",a.aiAnalytic),void a.scrollToBottom()}let o;o="memory_usage"===a.usage_type?yield a.chatMemory.sendMessage(a.message):yield a.chatCPU.sendMessage(a.message);const s=a.messages.length;a.messages.push({message:a.message,from:"User",id:s.toString()}),a.messages.push({message:o.response.text(),from:"AI",id:s.toString()}),a.message="",a.scrollToBottom()})()}scrollToBottom(){if(this.messagesContainer)try{this.messagesContainer.nativeElement.scrollTop=this.messagesContainer.nativeElement.scrollHeight+1e7}catch(a){console.error("Error al hacer scroll:",a)}}toggleAiModal(){""!==this.message&&(this.aiModal=!this.aiModal,this.wasChatOpen=this.aiModal,this.sendMessage().then(()=>{this.chatStyle()}))}}return(t=d).\u0275fac=function(a){return new(a||t)(e.rXU(y.x),e.rXU(i.Xi),e.rXU(_.nX))},t.\u0275cmp=e.VBU({type:t,selectors:[["app-flame-graph-compare"]],viewQuery:function(a,o){if(1&a&&e.GBs(D,5),2&a){let s;e.mGM(s=e.lsd())&&(o.messagesContainer=s.first)}},decls:45,vars:12,consts:[["messagesContainer2",""],[3,"title"],[3,"fullscreen"],["slot","fixed",3,"ionRefresh"],[1,"lg:m-10","md:m-10"],["size","12","size-md","12","size-lg","12",1,"flex","flex-row","justify-center"],[1,"min-w-full","p-5"],[1,"text-5xl","font-bold"],["id","analytics",1,"text-white"],[1,"flex","flex-row","justify-center","items-center"],["size","9",1,"rounded-3xl","bg-gray-600","p-2"],["placeholder","Ask DevProbe AI .... ",1,"text-white",3,"ngModelChange","ngModel"],["size","3",1,"min-h-full"],[1,"min-w-full","min-h-full",3,"click"],["vertical","bottom","horizontal","end","slot","fixed",1,"m-2","z-10",3,"click"],[1,"bg-purple-300","p-4"],["name","chatbubble-outline",1,"w-full","h-full"],["id","ai-modal",1,"fixed","bottom-0","right-0","h-full","w-full","bg-black","bg-opacity-60","z-10","r"],[1,"h-full","md:h-3/4","lg:h-3/4","w-full","bg-gray-900","p-4","absolute","right-0","bottom-0","z-50","flex","flex-col","rounded-tl-2xl","rounded-tr-2xl"],[1,"w-full","bg-gray-500","flex","flex-row","justify-center","items-center","p-2","mb-2","rounded-3xl"],[1,"flex","flex-row","p-2","items-center","bg-gray-800","w-full","rounded-3xl","h-full"],[1,"text-white"],[1,"m-2"],[1,"flex","flex-row","justify-center","items-center","bg-gray-800","hover:bg-gray-600","w-1/6","h-full","rounded-3xl",3,"click"],["name","close-outline"],[1,"flex-grow","overflow-y-auto","bg-gray-400","p-2","rounded-3xl"],["class","flex flex-col",4,"ngFor","ngForOf"],[1,"flex","flex-row","mt-2","p-2"],["placeholder","Ask...",1,"flex-grow","bg-gray-700","rounded-2xl",3,"ngModelChange","ngModel"],[1,"m-1"],[1,"w-1/3","bg-gray-500","rounded-3xl","flex","flex-row","justify-center","items-center","hover:bg-gray-300",3,"click"],["size","12","size-md","4","size-lg","4","class","",4,"ngFor","ngForOf"],["size","12","size-md","4","size-lg","4",1,""],[1,"min-h-full"],[3,"config"],["size","12","size-md","6","size-lg","6","class","",4,"ngFor","ngForOf"],["size","12","size-md","6","size-lg","6",1,""],[1,"flex","flex-col"],["class","rounded-3xl bg-gray-800 w-2/3 m-1 ml-auto p-2",4,"ngIf"],["class","rounded-3xl bg-gray-500 w-2/3 m-1 p-2 pr-2",4,"ngIf"],[1,"rounded-3xl","bg-gray-800","w-2/3","m-1","ml-auto","p-2"],[1,"text-white","p-4","m-2"],[1,"rounded-3xl","bg-gray-500","w-2/3","m-1","p-2","pr-2"],[1,"text-white","p-4","m-2",3,"id"]],template:function(a,o){if(1&a){const s=e.RV6();e.nrm(0,"app-header-return",1),e.j41(1,"ion-content",2)(2,"ion-refresher",3),e.bIt("ionRefresh",function(n){return e.eBV(s),e.Njj(o.doRefresh(n))}),e.nrm(3,"ion-refresher-content"),e.k0s(),e.nrm(4,"app-title",1),e.DNE(5,k,2,1,"ion-row",4)(6,I,2,1,"ion-row",4),e.j41(7,"ion-row",4)(8,"ion-col",5)(9,"ion-card",6)(10,"ion-card-header")(11,"ion-card-title")(12,"h1",7),e.EFF(13,"DevProbe AI Analytic"),e.k0s()()(),e.j41(14,"ion-card-content"),e.Z7z(15,O,2,1,"markdown",8,e.fX1),e.k0s(),e.j41(17,"ion-card-content")(18,"ion-row",9)(19,"ion-col",10)(20,"ion-input",11),e.mxI("ngModelChange",function(n){return e.eBV(s),e.DH7(o.message,n)||(o.message=n),e.Njj(n)}),e.k0s()(),e.j41(21,"ion-col",12)(22,"ion-button",13),e.bIt("click",function(){return e.eBV(s),e.Njj(o.toggleAiModal())}),e.EFF(23,"Send"),e.k0s()()()()()()(),e.j41(24,"ion-fab",14),e.bIt("click",function(){return e.eBV(s),e.Njj(o.aiModal=!0)}),e.j41(25,"ion-avatar",15),e.nrm(26,"ion-icon",16),e.k0s()()(),e.j41(27,"div",17)(28,"div",18)(29,"div",19)(30,"div",20)(31,"h1",21),e.EFF(32,"DevProbe AI"),e.k0s()(),e.nrm(33,"div",22),e.j41(34,"div",23),e.bIt("click",function(){return e.eBV(s),e.Njj(o.aiModal=!1)}),e.nrm(35,"ion-icon",24),e.k0s()(),e.j41(36,"div",25,0),e.DNE(38,z,3,2,"div",26),e.k0s(),e.j41(39,"div",27)(40,"ion-textarea",28),e.mxI("ngModelChange",function(n){return e.eBV(s),e.DH7(o.message,n)||(o.message=n),e.Njj(n)}),e.k0s(),e.nrm(41,"div",29),e.j41(42,"div",30),e.bIt("click",function(){return e.eBV(s),e.Njj(o.sendMessage())}),e.j41(43,"span",21),e.EFF(44,"Send"),e.k0s()()()()()}2&a&&(e.Y8G("title","Compare Flame Graphs"),e.R7$(),e.Y8G("fullscreen",!0),e.R7$(3),e.Y8G("title","Compare Flame Graphs"),e.R7$(),e.vxM(5,o.lenDates>=3?5:-1),e.R7$(),e.vxM(6,o.lenDates<3?6:-1),e.R7$(9),e.Dyx(o.aiAnalytic),e.R7$(5),e.R50("ngModel",o.message),e.R7$(4),e.AVh("hidden",!o.wasChatOpen),e.R7$(3),e.AVh("hidden",!o.aiModal),e.R7$(11),e.Y8G("ngForOf",o.messages),e.R7$(2),e.R50("ngModel",o.message))},dependencies:[g.Sq,g.bT,v.BC,v.vS,i.mC,i.Jm,i.b_,i.I9,i.ME,i.tN,i.hU,i.W9,i.Q8,i.iq,i.$w,i.To,i.Ki,i.ln,i.nc,i.Gw,M.W,w.p,j.E,E.NN]}),d})()}];let $=(()=>{var t;class d{}return(t=d).\u0275fac=function(a){return new(a||t)},t.\u0275mod=e.$C({type:t}),t.\u0275inj=e.G2t({imports:[_.iI.forChild(N),_.iI]}),d})();var V=m(5553);let L=(()=>{var t;class d{}return(t=d).\u0275fac=function(a){return new(a||t)},t.\u0275mod=e.$C({type:t}),t.\u0275inj=e.G2t({imports:[g.MD,v.YN,i.bv,$,V.h,j.n,E.NN]}),d})()}}]);