"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[5371],{5553:(O,b,n)=>{n.d(b,{h:()=>f});var m=n(177),a=n(7863),r=n(4438);let f=(()=>{var d;class e{}return(d=e).\u0275fac=function(P){return new(P||d)},d.\u0275mod=r.$C({type:d}),d.\u0275inj=r.G2t({imports:[m.MD,a.bv]}),e})()},8453:(O,b,n)=>{n.d(b,{W:()=>r});var m=n(4438),a=n(7863);let r=(()=>{var f;class d{constructor(){this.title="Title"}ngOnInit(){}}return(f=d).\u0275fac=function(g){return new(g||f)},f.\u0275cmp=m.VBU({type:f,selectors:[["app-title"]],inputs:{title:"title"},decls:4,vars:1,consts:[[1,"lg:m-10"],["size","12","size-md","6","size-lg","6"],[1,"text-4xl","lg:text-6xl","font-bold"]],template:function(g,P){1&g&&(m.j41(0,"ion-row",0)(1,"ion-col",1)(2,"h1",2),m.EFF(3),m.k0s()()()),2&g&&(m.R7$(3),m.JRh(P.title))},dependencies:[a.hU,a.ln]}),d})()},5371:(O,b,n)=>{n.r(b),n.d(b,{SettingsPageModule:()=>E});var m=n(177),a=n(4341),r=n(7863),f=n(7650),d=n(467),e=n(4438),g=n(4796),P=n(201),i=n(7473),s=n(385),o=n(8453);const _=[{path:"",component:(()=>{var u;class v{constructor(t,l,M,h,D,A){this.authService=t,this.router=l,this.alertCtrl=M,this.githubService=h,this.loadingCtrl=D,this.notificationService=A,this.gitKey="",this.repoName="",this.branchName="",this.owner="",this.user={},this.orgname="",this.version="1.10.200"}ngOnInit(){}ionViewWillEnter(){var t=this;return(0,d.A)(function*(){t.user=localStorage.getItem("user")?JSON.parse(localStorage.getItem("user")||"{}"):null,t.user?(t.orgname=t.user.orgName||"",yield t.getSyncRepo()):yield t.showAlert("No user found","Error")})()}logout(){var t=this;return(0,d.A)(function*(){yield t.authService.logoutUser(),yield t.router.navigate(["/login"])})()}getSyncRepo(){var t=this;return(0,d.A)(function*(){yield t.showLoading();const l=yield t.githubService.getSyncRepo(t.orgname);l&&(t.gitKey=l.key,t.repoName=l.repo,t.branchName=l.branch,t.owner=l.owner),yield t.hideLoading()})()}syncRepo(){var t=this;return(0,d.A)(function*(){yield t.showLoading(),t.gitKey&&t.repoName&&t.branchName&&t.owner&&""!==t.gitKey&&""!==t.repoName&&""!==t.branchName&&""!==t.owner?(yield t.githubService.syncRepo(t.orgname,t.gitKey,t.repoName,t.branchName,t.owner),yield t.hideLoading()):yield t.showAlert("Please fill in all fields","Error")})()}showAlert(t,l){var M=this;return(0,d.A)(function*(){yield(yield M.alertCtrl.create({header:l,message:t,buttons:["OK"]})).present()})()}showLoading(){var t=this;return(0,d.A)(function*(){yield(yield t.loadingCtrl.create({})).present()})()}hideLoading(){var t=this;return(0,d.A)(function*(){yield t.loadingCtrl.dismiss()})()}notify(){Notification.requestPermission().then(function(t){console.log("granted"===t?"Permission granted for notifications":"Permission denied for notifications")})}subscribe(){var t=this;return(0,d.A)(function*(){webpushr("fetch_id",function(){var l=(0,d.A)(function*(M){console.log("webpushr subscriber id: "+M),M?yield t.notificationService.saveNotificationID(t.user,M).then(function(){var h=(0,d.A)(function*(D){D&&(yield t.showAlert("Subscription saved successfully","Success"))});return function(D){return h.apply(this,arguments)}}()):yield t.showAlert("No subscription id found, please check browser permissions","Error")});return function(M){return l.apply(this,arguments)}}())})()}}return(u=v).\u0275fac=function(t){return new(t||u)(e.rXU(g.u),e.rXU(f.Ix),e.rXU(r.hG),e.rXU(P.p),e.rXU(r.Xi),e.rXU(i.J))},u.\u0275cmp=e.VBU({type:u,selectors:[["app-settings"]],decls:72,vars:10,consts:[[3,"title"],[3,"fullscreen"],[1,"lg:m-10","md:m-10"],["size","12","size-md","12","size-lg","12",1,"flex","flex-row","justify-center"],["color","danger",1,"min-w-full",3,"click"],["size","12","size-md","12","size-lg","12",1,""],[1,"p-5"],[1,"text-2xl"],[1,"text-white"],["href","https://github.com/settings/tokens",1,"text-blue-500"],["placeholder","Enter your key here...",1,"text-white",3,"ngModelChange","ngModel"],["placeholder","Enter your repo name here...",1,"text-white",3,"ngModelChange","ngModel"],["placeholder","Enter your branch name here...",1,"text-white",3,"ngModelChange","ngModel"],["color","primary",1,"min-w-full",3,"click"],[1,"w-full",3,"click"],["size","12",1,"flex","flex-row","justify-end","items-center"],[1,"text-sm"]],template:function(t,l){1&t&&(e.nrm(0,"app-header",0),e.j41(1,"ion-content",1)(2,"ion-grid"),e.nrm(3,"app-title",0),e.j41(4,"ion-row",2)(5,"ion-col",3)(6,"ion-button",4),e.bIt("click",function(){return l.logout()}),e.EFF(7,"Logout"),e.k0s()()(),e.nrm(8,"app-title",0),e.j41(9,"ion-row",2)(10,"ion-col",5)(11,"ion-card",6)(12,"ion-card",6)(13,"ion-card-title",7),e.EFF(14,"1. Add a GitHub Key"),e.k0s(),e.j41(15,"ion-card-content")(16,"p",8),e.EFF(17," Add a GitHub key to sync with your GitHub repo. You will be able to create tests with DevProbeAI. "),e.j41(18,"a",9),e.EFF(19,"Get A GitHub Key Here !!!"),e.k0s()()(),e.j41(20,"ion-card")(21,"ion-card-content")(22,"ion-label"),e.EFF(23,"GitHub Key"),e.k0s(),e.j41(24,"ion-input",10),e.mxI("ngModelChange",function(h){return e.DH7(l.gitKey,h)||(l.gitKey=h),h}),e.k0s()()()(),e.j41(25,"ion-card",6)(26,"ion-card-title",7),e.EFF(27,"2. Repo Name"),e.k0s(),e.j41(28,"ion-card-content")(29,"p",8),e.EFF(30," Add the name of the repo you want to sync with DevProbeAI. "),e.k0s()(),e.j41(31,"ion-card")(32,"ion-card-content")(33,"ion-label"),e.EFF(34,"Repo Name"),e.k0s(),e.j41(35,"ion-input",11),e.mxI("ngModelChange",function(h){return e.DH7(l.repoName,h)||(l.repoName=h),h}),e.k0s()()()(),e.j41(36,"ion-card",6)(37,"ion-card-title",7),e.EFF(38,"3. Branch Name"),e.k0s(),e.j41(39,"ion-card-content")(40,"p",8),e.EFF(41," Add the name of the branch you want to sync with DevProbeAI. "),e.k0s()(),e.j41(42,"ion-card")(43,"ion-card-content")(44,"ion-label"),e.EFF(45,"Branch Name"),e.k0s(),e.j41(46,"ion-input",12),e.mxI("ngModelChange",function(h){return e.DH7(l.branchName,h)||(l.branchName=h),h}),e.k0s()()()(),e.j41(47,"ion-card",6)(48,"ion-card-title",7),e.EFF(49,"4. Owner Name"),e.k0s(),e.j41(50,"ion-card-content")(51,"p",8),e.EFF(52," Add the name of the owner of the repo you want to sync with DevProbeAI. "),e.k0s()(),e.j41(53,"ion-card")(54,"ion-card-content")(55,"ion-label"),e.EFF(56,"Owner Name"),e.k0s(),e.j41(57,"ion-input",12),e.mxI("ngModelChange",function(h){return e.DH7(l.owner,h)||(l.owner=h),h}),e.k0s()()()(),e.j41(58,"ion-button",13),e.bIt("click",function(){return l.syncRepo()}),e.EFF(59,"Sync Repo"),e.k0s()()()(),e.nrm(60,"app-title",0),e.j41(61,"ion-row",2)(62,"ion-col",5)(63,"p"),e.EFF(64,"Receive push notifications when new data is available. Like new tests, incidents, etc."),e.k0s()(),e.j41(65,"ion-col",3)(66,"ion-button",14),e.bIt("click",function(){return l.subscribe()}),e.EFF(67,"Subscribe"),e.k0s()()(),e.j41(68,"ion-row")(69,"ion-col",15)(70,"h1",16),e.EFF(71),e.k0s()()()()()),2&t&&(e.Y8G("title","Settings"),e.R7$(),e.Y8G("fullscreen",!0),e.R7$(2),e.Y8G("title","Account SingOut"),e.R7$(5),e.Y8G("title","Sync GitHub Repo"),e.R7$(16),e.R50("ngModel",l.gitKey),e.R7$(11),e.R50("ngModel",l.repoName),e.R7$(11),e.R50("ngModel",l.branchName),e.R7$(11),e.R50("ngModel",l.owner),e.R7$(3),e.Y8G("title","Receive Push Notifications"),e.R7$(11),e.SpI("Version: ",l.version,""))},dependencies:[a.BC,a.vS,r.Jm,r.b_,r.I9,r.tN,r.hU,r.W9,r.lO,r.$w,r.he,r.ln,r.Gw,s.l,o.W]}),v})()}];let p=(()=>{var u;class v{}return(u=v).\u0275fac=function(t){return new(t||u)},u.\u0275mod=e.$C({type:u}),u.\u0275inj=e.G2t({imports:[f.iI.forChild(_),f.iI]}),v})();var y=n(5553);let E=(()=>{var u;class v{}return(u=v).\u0275fac=function(t){return new(t||u)},u.\u0275mod=e.$C({type:u}),u.\u0275inj=e.G2t({imports:[m.MD,a.YN,r.bv,p,y.h]}),v})()},4796:(O,b,n)=>{n.d(b,{u:()=>d});var m=n(467),a=n(8737),r=n(4262),f=n(4438);let d=(()=>{var e;class g{constructor(i,s){this.auth=i,this.firestore=s}registerUser(i){var s=this;return(0,m.A)(function*(){try{const o=yield(0,a.eJ)(s.auth,i.email,i.password);return o.user?(yield(0,r.BN)((0,r.H9)(s.firestore,"users",o.user.uid),{email:i.email,name:i.name,orgName:i.orgName,uid:o.user.uid}),yield(0,r.BN)((0,r.H9)(s.firestore,"teams",`${i.orgName}`),{name:i.orgName,members:[o.user.uid]}),o):null}catch{return null}})()}loginUser(i){var s=this;return(0,m.A)(function*(){try{var o;const c=yield(0,a.x9)(s.auth,i.email,i.password);if(null!==(o=c.user)&&void 0!==o&&o.uid){const _=yield(0,r.x7)((0,r.H9)(s.firestore,"users",c.user.uid));if(_.exists())return localStorage.setItem("user",JSON.stringify(_.data())),c}}catch(c){console.error(c)}return null})()}logoutUser(){var i=this;return(0,m.A)(function*(){yield i.auth.signOut()})()}addMember(i){var s=this;return(0,m.A)(function*(){try{const o=yield(0,a.eJ)(s.auth,i.email,i.password);if(!o.user)return!1;const c={email:i.email,name:i.name,orgName:i.orgName,uid:o.user.uid};return yield(0,r.BN)((0,r.H9)(s.firestore,"users",o.user.uid),c),c}catch{return!1}})()}}return(e=g).\u0275fac=function(i){return new(i||e)(f.KVO(a.Nj),f.KVO(r._7))},e.\u0275prov=f.jDH({token:e,factory:e.\u0275fac,providedIn:"root"}),g})()},7473:(O,b,n)=>{n.d(b,{J:()=>e});var m=n(467),a=n(4262),r=n(4438),f=n(1626),d=n(5092);let e=(()=>{var g;class P{constructor(s,o,c){this.firestore=s,this.http=o,this.teamService=c}saveNotificationID(s,o){var c=this;return(0,m.A)(function*(){const _=(0,a.H9)(c.firestore,"users",s.uid),p=yield(0,a.x7)(_);if(p.exists()){const y=p.data();return y.notificationID=o,yield(0,a.BN)(_,y),!0}return console.log("No such document!"),!1})()}getNotificationUser(s){var o=this;return(0,m.A)(function*(){const c=(0,a.H9)(o.firestore,"users",s.uid),_=yield(0,a.x7)(c);if(_.exists()){const p=_.data();return p.notificationID?p.notificationID:""}return console.log("No such document!"),null})()}notifyIncidentToUser(s,o){var c=this;return(0,m.A)(function*(){try{const _=yield c.teamService.getTeamByOrganization(o),p=s.map(u=>u.member),y=_.filter(u=>p.includes(u.name));console.log("team",y);const E="https://devprobeapi.onrender.com/sendNotification";for(let u of y){let v=yield c.getNotificationUser(u);if(console.log("sid",v),""!==v){const t={sid:v,title:"New Incident",type:"new_incident",message:`Hey ${u.name}, you have been assigned a new incident your incident role is ${s.find(l=>l.member===u.name).role}`,target:"https://devprobe-89481.web.app/incident-manager-chooser"};yield c.http.post(E,t).toPromise(),console.log("Notification sent successfully")}else console.log("no sid")}}catch(_){console.log(_)}})()}}return(g=P).\u0275fac=function(s){return new(s||g)(r.KVO(a._7),r.KVO(f.Qq),r.KVO(d.O))},g.\u0275prov=r.jDH({token:g,factory:g.\u0275fac,providedIn:"root"}),P})()},5092:(O,b,n)=>{n.d(b,{O:()=>d});var m=n(467),a=n(4262),r=n(4438),f=n(4796);let d=(()=>{var e;class g{constructor(i,s){this.firestore=i,this.authService=s}getTeamByOrganization(i){var s=this;return(0,m.A)(function*(){let o=(0,a.H9)(s.firestore,"teams",i);const p=(yield(0,a.x7)(o)).data();let y=[];for(let E=0;E<p.members.length;E++){o=(0,a.H9)(s.firestore,"users",p.members[E]);const v=(yield(0,a.x7)(o)).data();y.push(v)}return y})()}removeMember(i,s){var o=this;return(0,m.A)(function*(){try{let c=(0,a.H9)(o.firestore,"teams",i);const y=(yield(0,a.x7)(c)).data();let E=y.members.filter(v=>v!==s);return yield(0,a.BN)(c,{name:y.name,members:E}),c=(0,a.H9)(o.firestore,"users",s),yield(0,a.BN)(c,{}),yield o.authService,!0}catch{return!1}})()}addMember(i){var s=this;return(0,m.A)(function*(){try{const o=yield s.authService.addMember(i);if(!o)return!1;const c=(0,a.H9)(s.firestore,"teams",i.orgName),p=(yield(0,a.x7)(c)).data();console.log(p);const y=p;let E=y.members;return E.push(o.uid),console.log(E),yield(0,a.mZ)(c,{name:y.name,members:E}),o.uid}catch{return!1}})()}}return(e=g).\u0275fac=function(i){return new(i||e)(r.KVO(a._7),r.KVO(f.u))},e.\u0275prov=r.jDH({token:e,factory:e.\u0275fac,providedIn:"root"}),g})()}}]);