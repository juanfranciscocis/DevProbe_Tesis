"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[6749],{5553:(I,h,i)=>{i.d(h,{h:()=>d});var r=i(177),p=i(7863),a=i(4438);let d=(()=>{var l;class e{}return(l=e).\u0275fac=function(u){return new(u||l)},l.\u0275mod=a.$C({type:l}),l.\u0275inj=a.G2t({imports:[r.MD,p.bv]}),e})()},3241:(I,h,i)=>{i.d(h,{p:()=>d});var r=i(4438),p=i(177),a=i(7863);let d=(()=>{var l;class e{constructor(u){this.location=u,this.title="Header Title"}ngOnInit(){}goBack(){this.location.back()}}return(l=e).\u0275fac=function(u){return new(u||l)(r.rXU(p.aZ))},l.\u0275cmp=r.VBU({type:l,selectors:[["app-header-return"]],inputs:{title:"title"},decls:6,vars:2,consts:[[3,"translucent"],["slot","start","menu","menu-id"],["name","arrow-back","slot","start",1,"p-4","bigger-icon",3,"click"]],template:function(u,f){1&u&&(r.j41(0,"ion-header",0)(1,"ion-toolbar"),r.nrm(2,"ion-menu-button",1),r.j41(3,"ion-icon",2),r.bIt("click",function(){return f.goBack()}),r.k0s(),r.j41(4,"ion-title"),r.EFF(5),r.k0s()()()),2&u&&(r.Y8G("translucent",!0),r.R7$(5),r.JRh(f.title))},dependencies:[a.eU,a.iq,a.MC,a.BC,a.ai],styles:[".bigger-icon[_ngcontent-%COMP%]{font-size:1.5em}"]}),e})()},8453:(I,h,i)=>{i.d(h,{W:()=>a});var r=i(4438),p=i(7863);let a=(()=>{var d;class l{constructor(){this.title="Title"}ngOnInit(){}}return(d=l).\u0275fac=function(m){return new(m||d)},d.\u0275cmp=r.VBU({type:d,selectors:[["app-title"]],inputs:{title:"title"},decls:4,vars:1,consts:[[1,"lg:m-10"],["size","12","size-md","6","size-lg","6"],[1,"text-4xl","lg:text-6xl","font-bold"]],template:function(m,u){1&m&&(r.j41(0,"ion-row",0)(1,"ion-col",1)(2,"h1",2),r.EFF(3),r.k0s()()()),2&m&&(r.R7$(3),r.JRh(u.title))},dependencies:[p.hU,p.ln]}),l})()},6749:(I,h,i)=>{i.r(h),i.d(h,{IncidentPostmortemPageModule:()=>L});var r=i(177),p=i(4341),a=i(7863),d=i(7650),l=i(467),e=i(4438),m=i(9032),u=i(4624),f=i(8453),_=i(3241);const C=[{path:"",component:(()=>{var c;class v{constructor(n,t,o,s){this.router=n,this.activatedRoute=t,this.loadingCtrl=o,this.incidentService=s,this.orgName="",this.productObjective="",this.productStep="",this.incident={},this.wentWrong="",this.canBeLearned="",this.howToPrevent="",this.vertexAI=(0,e.WQX)(m.L9)}ngOnInit(){}ionViewWillEnter(){var n=this;return(0,l.A)(function*(){n.getParams(),yield n.getIncident()})()}getParams(){this.activatedRoute.params.subscribe(t=>{this.productObjective=t.productObjective,this.productStep=t.step,this.incident.title=t.incidentTitle});const n=JSON.parse(localStorage.getItem("user"));this.orgName=n.orgName,console.log(this.orgName),console.log(this.productObjective),console.log(this.productStep),console.log(this.incident.title)}getIncident(){var n=this;return(0,l.A)(function*(){yield n.showLoading(),n.incident=yield n.incidentService.getIncident(n.orgName,n.productObjective,n.productStep,n.incident.title);try{var t,o,s;n.wentWrong=null===(t=n.incident.postmortem)||void 0===t?void 0:t.wentWrong,n.canBeLearned=null===(o=n.incident.postmortem)||void 0===o?void 0:o.canBeLearned,n.howToPrevent=null===(s=n.incident.postmortem)||void 0===s?void 0:s.howToPrevent}catch(w){console.log(w)}yield n.hideLoading()})()}savePostmortem(){var n=this;return(0,l.A)(function*(){yield n.showLoading(),n.incident.postmortem={wentWrong:n.wentWrong,canBeLearned:n.canBeLearned,howToPrevent:n.howToPrevent},n.incident.state="postmortem",console.dir(n.incident),yield n.incidentService.updateIncident(n.orgName,n.productObjective,n.productStep,n.incident).then(function(){var t=(0,l.A)(function*(o){o&&(yield n.hideLoading(),yield n.router.navigate(["/incident-manager",{productObjective:n.productObjective,step:n.productStep}])),yield n.hideLoading()});return function(o){return t.apply(this,arguments)}}())})()}sendToAI(n){var t=this;return(0,l.A)(function*(){yield t.showLoading();try{console.log(n);let s,o="";if("wentWrong"===n){o="Ayudame a completar el Postmortem del siguiente incidente: "+t.incident.title+". Lo sucedido se basa en la sigueinte descripci\xf3n: "+t.incident.description+". Esto fue ";for(let g=0;g<t.incident.report.length;g++)o+=" "+t.incident.report[g].comment;o+=" \xbfQu\xe9 sali\xf3 mal?. Responde solo a esta pregunta en maximo 100 palabras"}if("canBeLearned"===n){if(""===t.wentWrong)return void(yield t.hideLoading());o="Ayudame a completar el Postmortem del siguiente incidente: "+t.incident.title+". Lo sucedido se basa en la sigueinte descripci\xf3n: "+t.incident.description+". Esto fue ";for(let g=0;g<t.incident.report.length;g++)o+=" "+t.incident.report[g].comment;o+="Lo que sali\xf3 mal fue: "+t.wentWrong,o+=" \xbfQu\xe9 se puede aprender sobre el incidente?. Responde solo a esta pregunta en maximo 100 palabras"}if("howToPrevent"===n){if(""===t.canBeLearned||""===t.wentWrong)return void(yield t.hideLoading());o="Ayudame a completar el Postmortem del siguiente incidente: "+t.incident.title+". Lo sucedido se basa en la sigueinte descripci\xf3n: "+t.incident.description+". Esto fue ";for(let g=0;g<t.incident.report.length;g++)o+=" "+t.incident.report[g].comment;o+="Lo que sali\xf3 mal fue: "+t.wentWrong,o+="Lo que se puede aprender sobre el incidente fue: "+t.canBeLearned,o+=" \xbfC\xf3mo se puede prevenir que vuelva a suceder?. Responde solo a esta pregunta en maximo 100 palabras"}s=yield(0,m.oc)(t.vertexAI,{model:"gemini-1.5-flash"}).generateContent(o),console.log(s),"wentWrong"===n&&(t.wentWrong=s.response.text()),"canBeLearned"===n&&(t.canBeLearned=s.response.text()),"howToPrevent"===n&&(t.howToPrevent=s.response.text())}catch(o){console.log(o)}yield t.hideLoading()})()}showLoading(){var n=this;return(0,l.A)(function*(){yield(yield n.loadingCtrl.create({})).present()})()}hideLoading(){var n=this;return(0,l.A)(function*(){yield n.loadingCtrl.dismiss()})()}}return(c=v).\u0275fac=function(n){return new(n||c)(e.rXU(d.Ix),e.rXU(d.nX),e.rXU(a.Xi),e.rXU(u.I))},c.\u0275cmp=e.VBU({type:c,selectors:[["app-incident-postmortem"]],decls:41,vars:10,consts:[[3,"title"],[3,"fullscreen"],[1,"lg:m-10","md:m-10"],["size","12","size-md","4","size-lg","4",1,""],["size","12","size-md","12","size-lg","12",1,""],[1,"flex","flex-row","items-center","justify-between","w-full"],[1,"text-white","text-3xl","pb-5"],[1,"h-12","w-12","bg-purple-600","p-2",3,"click"],["name","color-wand",1,"w-full","h-full","text-white"],["fill","outline","autoGrow","true",3,"ngModelChange","ngModel","value"],["expand","block","color","danger",3,"click"]],template:function(n,t){1&n&&(e.nrm(0,"app-header-return",0),e.j41(1,"ion-content",1)(2,"ion-grid"),e.nrm(3,"app-title",0),e.j41(4,"ion-row",2)(5,"ion-col",3)(6,"p"),e.EFF(7),e.k0s()()(),e.j41(8,"ion-row",2)(9,"ion-col",4)(10,"ion-card")(11,"ion-card-content")(12,"ion-row",2)(13,"ion-col",4)(14,"div",5)(15,"h1",6),e.EFF(16,"What went wrong?"),e.k0s(),e.j41(17,"ion-avatar",7),e.bIt("click",function(){return t.sendToAI("wentWrong")}),e.nrm(18,"ion-icon",8),e.k0s()(),e.j41(19,"ion-textarea",9),e.mxI("ngModelChange",function(s){return e.DH7(t.wentWrong,s)||(t.wentWrong=s),s}),e.k0s()()(),e.j41(20,"ion-row",2)(21,"ion-col",4)(22,"div",5)(23,"h1",6),e.EFF(24,"What can be learned?"),e.k0s(),e.j41(25,"ion-avatar",7),e.bIt("click",function(){return t.sendToAI("canBeLearned")}),e.nrm(26,"ion-icon",8),e.k0s()(),e.j41(27,"ion-textarea",9),e.mxI("ngModelChange",function(s){return e.DH7(t.canBeLearned,s)||(t.canBeLearned=s),s}),e.k0s()()(),e.j41(28,"ion-row",2)(29,"ion-col",4)(30,"div",5)(31,"h1",6),e.EFF(32,"How to prevent similar incidents in the future?"),e.k0s(),e.j41(33,"ion-avatar",7),e.bIt("click",function(){return t.sendToAI("howToPrevent")}),e.nrm(34,"ion-icon",8),e.k0s()(),e.j41(35,"ion-textarea",9),e.mxI("ngModelChange",function(s){return e.DH7(t.howToPrevent,s)||(t.howToPrevent=s),s}),e.k0s()()()()()(),e.j41(36,"ion-col",4)(37,"ion-card")(38,"ion-card-content")(39,"ion-button",10),e.bIt("click",function(){return t.savePostmortem()}),e.EFF(40,"Save and Close"),e.k0s()()()()()()()),2&n&&(e.Y8G("title","Incident Postmortem"),e.R7$(),e.Y8G("fullscreen",!0),e.R7$(2),e.Y8G("title","Incident Postmortem"),e.R7$(4),e.SpI("Postmortem for ",t.incident.title,""),e.R7$(12),e.R50("ngModel",t.wentWrong),e.Y8G("value",null==t.incident.postmortem?null:t.incident.postmortem.wentWrong),e.R7$(8),e.R50("ngModel",t.canBeLearned),e.Y8G("value",null==t.incident.postmortem?null:t.incident.postmortem.canBeLearned),e.R7$(8),e.R50("ngModel",t.howToPrevent),e.Y8G("value",null==t.incident.postmortem?null:t.incident.postmortem.howToPrevent))},dependencies:[p.BC,p.vS,a.mC,a.Jm,a.b_,a.I9,a.hU,a.W9,a.lO,a.iq,a.ln,a.nc,a.Gw,f.W,_.p]}),v})()}];let T=(()=>{var c;class v{}return(c=v).\u0275fac=function(n){return new(n||c)},c.\u0275mod=e.$C({type:c}),c.\u0275inj=e.G2t({imports:[d.iI.forChild(C),d.iI]}),v})();var M=i(5553);let L=(()=>{var c;class v{}return(c=v).\u0275fac=function(n){return new(n||c)},c.\u0275mod=e.$C({type:c}),c.\u0275inj=e.G2t({imports:[r.MD,p.YN,a.bv,T,M.h]}),v})()}}]);