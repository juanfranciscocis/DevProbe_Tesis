"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[1101],{5553:(_,f,n)=>{n.d(f,{h:()=>m});var r=n(177),P=n(7863),l=n(4438);let m=(()=>{var s;class e{}return(s=e).\u0275fac=function(d){return new(d||s)},s.\u0275mod=l.$C({type:s}),s.\u0275inj=l.G2t({imports:[r.MD,P.bv]}),e})()},3241:(_,f,n)=>{n.d(f,{p:()=>m});var r=n(4438),P=n(177),l=n(7863);let m=(()=>{var s;class e{constructor(d){this.location=d,this.title="Header Title"}ngOnInit(){}goBack(){this.location.back()}}return(s=e).\u0275fac=function(d){return new(d||s)(r.rXU(P.aZ))},s.\u0275cmp=r.VBU({type:s,selectors:[["app-header-return"]],inputs:{title:"title"},decls:6,vars:2,consts:[[3,"translucent"],["slot","start","menu","menu-id"],["name","arrow-back","slot","start",1,"p-4","bigger-icon",3,"click"]],template:function(d,G){1&d&&(r.j41(0,"ion-header",0)(1,"ion-toolbar"),r.nrm(2,"ion-menu-button",1),r.j41(3,"ion-icon",2),r.bIt("click",function(){return G.goBack()}),r.k0s(),r.j41(4,"ion-title"),r.EFF(5),r.k0s()()()),2&d&&(r.Y8G("translucent",!0),r.R7$(5),r.JRh(G.title))},dependencies:[l.eU,l.iq,l.MC,l.BC,l.ai],styles:[".bigger-icon[_ngcontent-%COMP%]{font-size:1.5em}"]}),e})()},1101:(_,f,n)=>{n.r(f),n.d(f,{FlameGraphPageModule:()=>A});var r=n(177),P=n(4341),l=n(7863),m=n(4848),s=n(467),e=n(4438),v=n(6560),d=n(7616),G=n(8453),D=n(3241);let E=(()=>{var a;class p{constructor(t,o,g,c){this.flameGraphService=t,this.loadingCtrl=o,this.router=g,this.route=c,this.product={},this.date="",this.config={data:b}}ionViewWillEnter(){this.getProductAndDateFromParams(),this.getFlameGraph()}getProductAndDateFromParams(){this.route.queryParams.subscribe(t=>{this.product=JSON.parse(t.product),this.date=t.date}),console.log(this.product.productObjective),console.log(this.date)}getFlameGraph(){var t=this;return(0,s.A)(function*(){try{yield t.showLoading();const o=localStorage.getItem("user");if(!o)return;const c=JSON.parse(o).orgName;console.log(c);const i=yield t.flameGraphService.getFlameGraphByDate(c,t.product.productObjective,t.date);console.log(i);let h=[],u=[];for(let F in i){const C=null==i?void 0:i[F];u=Object.keys(C),console.log("keys",u);const B=100/u.length;for(let R in u){const O=[];for(let M=0;M<C[u[R]].length;M++)O[M]=t.transformToRawData(C[u[R]][M]);console.log("server1",O);const j={label:u[R],value:B,children:[...O]};h.push(j)}console.log("server",h)}h=[{label:"root",value:100,children:h}],t.config={data:h},console.log("final object",h),yield t.hideLoading()}catch(o){console.log(o),yield t.hideLoading()}})()}showLoading(){var t=this;return(0,s.A)(function*(){yield(yield t.loadingCtrl.create({})).present()})()}hideLoading(){var t=this;return(0,s.A)(function*(){yield t.loadingCtrl.dismiss()})()}ngOnInit(){}average(t){const o=t.map(Number);return o.reduce((c,i)=>c+i,0)/o.length}transformToRawData(t){const o=t.cpu_usage?this.average(t.cpu_usage):0,g=[];for(const c in t){if("id"===c||"cpu_usage"===c)continue;const i=t[c];if("object"!=typeof i||Array.isArray(i))"object"!=typeof i&&g.push({label:c,value:0,children:[]});else if("sub_services"===c)for(const h in i){const u=i[h],C={label:h,value:u.cpu_usage?this.average(u.cpu_usage):0,children:this.transformToRawData(u).children};g.push(C)}else{const u={label:c,value:i.cpu_usage?this.average(i.cpu_usage):0,children:this.transformToRawData(i).children};g.push(u)}}return{label:t.id,value:o,children:g}}doRefresh(t){var o=this;return(0,s.A)(function*(){yield o.getFlameGraph(),t.target.complete()})()}}return(a=p).\u0275fac=function(t){return new(t||a)(e.rXU(v.x),e.rXU(l.Xi),e.rXU(m.Ix),e.rXU(m.nX))},a.\u0275cmp=e.VBU({type:a,selectors:[["app-flame-graph"]],decls:15,vars:5,consts:[[3,"title"],[3,"fullscreen"],["slot","fixed",3,"ionRefresh"],[1,"lg:m-10","md:m-10"],["size","12","size-md","4","size-lg","4",1,""],[1,"lg:m-10"],["size","12"],[1,"p-5"],[1,"bg-transparent"],[1,"wrapper-responsive"],[3,"config"]],template:function(t,o){1&t&&(e.nrm(0,"app-header-return",0),e.j41(1,"ion-content",1)(2,"ion-refresher",2),e.bIt("ionRefresh",function(c){return o.doRefresh(c)}),e.nrm(3,"ion-refresher-content"),e.k0s(),e.nrm(4,"app-title",0),e.j41(5,"ion-row",3)(6,"ion-col",4)(7,"p"),e.EFF(8),e.k0s()()(),e.j41(9,"ion-row",5)(10,"ion-col",6)(11,"ion-card",7)(12,"ion-card",8)(13,"div",9),e.nrm(14,"ngx-flamegraph",10),e.k0s()()()()()()),2&t&&(e.Y8G("title","Flame Graph"),e.R7$(),e.Y8G("fullscreen",!0),e.R7$(3),e.Y8G("title","Flame Graph"),e.R7$(4),e.SpI("Showing data for : ",o.date,""),e.R7$(6),e.Y8G("config",o.config))},dependencies:[l.b_,l.hU,l.W9,l.To,l.Ki,l.ln,d.E,G.W,D.p],styles:[".wrapper-fixed-width[_ngcontent-%COMP%]{width:900px;margin:auto}.wrapper-responsive[_ngcontent-%COMP%]{width:100%;margin:auto}h2[_ngcontent-%COMP%], h3[_ngcontent-%COMP%]{text-align:center;-webkit-user-select:none;user-select:none}"]}),p})();const b=[{label:"root",value:100,children:[]}],U=[{path:"",component:E}];let T=(()=>{var a;class p{}return(a=p).\u0275fac=function(t){return new(t||a)},a.\u0275mod=e.$C({type:a}),a.\u0275inj=e.G2t({imports:[m.iI.forChild(U),m.iI]}),p})();var I=n(5553);let A=(()=>{var a;class p{}return(a=p).\u0275fac=function(t){return new(t||a)},a.\u0275mod=e.$C({type:a}),a.\u0275inj=e.G2t({imports:[r.MD,P.YN,l.bv,T,d.n,I.h]}),p})()}}]);