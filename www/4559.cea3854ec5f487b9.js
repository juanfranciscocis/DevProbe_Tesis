"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[4559],{5553:(L,j,c)=>{c.d(j,{h:()=>C});var m=c(177),O=c(7863),l=c(4438);let C=(()=>{var p;class t{}return(p=t).\u0275fac=function(y){return new(y||p)},p.\u0275mod=l.$C({type:p}),p.\u0275inj=l.G2t({imports:[m.MD,O.bv]}),t})()},3241:(L,j,c)=>{c.d(j,{p:()=>C});var m=c(4438),O=c(177),l=c(7863);let C=(()=>{var p;class t{constructor(y){this.location=y,this.title="Header Title"}ngOnInit(){}goBack(){this.location.back()}}return(p=t).\u0275fac=function(y){return new(y||p)(m.rXU(O.aZ))},p.\u0275cmp=m.VBU({type:p,selectors:[["app-header-return"]],inputs:{title:"title"},decls:6,vars:2,consts:[[3,"translucent"],["slot","start","menu","menu-id"],["name","arrow-back","slot","start",1,"p-4","bigger-icon",3,"click"]],template:function(y,P){1&y&&(m.j41(0,"ion-header",0)(1,"ion-toolbar"),m.nrm(2,"ion-menu-button",1),m.j41(3,"ion-icon",2),m.bIt("click",function(){return P.goBack()}),m.k0s(),m.j41(4,"ion-title"),m.EFF(5),m.k0s()()()),2&y&&(m.Y8G("translucent",!0),m.R7$(5),m.JRh(P.title))},dependencies:[l.eU,l.iq,l.MC,l.BC,l.ai],styles:[".bigger-icon[_ngcontent-%COMP%]{font-size:1.5em}"]}),t})()},4559:(L,j,c)=>{c.r(j),c.d(j,{LoadTestPageModule:()=>F});var m=c(177),O=c(4341),l=c(7863),C=c(7650),p=c(467),t=c(4438),b=c(4970),y=c(8453),P=c(3241),_=c(2820);function E(u,T){if(1&u){const R=t.RV6();t.j41(0,"ion-item",17),t.bIt("click",function(){const o=t.eBV(R).$implicit,i=t.XpG();return t.Njj(i.viewHistory(o))}),t.j41(1,"ion-label"),t.EFF(2),t.k0s(),t.nrm(3,"ion-icon",18),t.k0s()}if(2&u){const R=T.$implicit;t.R7$(2),t.JRh(R)}}const M=[{path:"",component:(()=>{var u;class T{constructor(e,o,i,r,n){this.router=e,this.activatedRoute=o,this.loadTestService=i,this.loadingCtrl=r,this.alertCtrl=n,this.productStep="",this.productObjective="",this.orgName="",this.target="",this.description="",this.loadTestResults={},this.totalNumberOfRequests=0,this.statusCodesOptions={tooltip:{trigger:"axis"},xAxis:{type:"category",boundaryGap:!1,data:[]},yAxis:{type:"value"},series:[]},this.responseTimeOptions={tooltip:{trigger:"axis"},xAxis:{type:"category",boundaryGap:!1,data:[]},yAxis:{type:"value"},series:[]},this.listOfDates=[]}ngOnInit(){}ionViewWillEnter(){var e=this;return(0,p.A)(function*(){yield e.showLoading(),e.getParams(),yield e.getHistoryResults().then(()=>{e.plotCodes(),e.totalRequests(),e.responseTime()}),yield e.hideLoading()})()}getParams(){this.activatedRoute.params.subscribe(o=>{this.productObjective=o.productObjective,this.productStep=o.step});const e=JSON.parse(localStorage.getItem("user"));this.orgName=e.orgName,console.log(this.orgName),console.log(this.productObjective),console.log(this.productStep)}sendRequest(){var e=this;return(0,p.A)(function*(){if(yield e.showLoading(),e.target.startsWith("http://")||e.target.startsWith("https://")||e.target.endsWith("/"))return yield e.hideLoading(),void(yield e.showAlert("No http or https is needed, check for slashes at the end of the domain","Please enter a valid host"));yield e.loadTestService.sendLoadTest(e.orgName,e.productObjective,e.productStep,e.target).then(function(){var o=(0,p.A)(function*(i){yield e.hideLoading(),console.log("data",i),i&&(yield e.showAlert("Test sent, please wait a few seconds to GET RESULTS","Success"))});return function(i){return o.apply(this,arguments)}}()),yield e.hideLoading()})()}getHistoryResults(){var e=this;return(0,p.A)(function*(){e.loadTestResults=yield e.loadTestService.getLoadTestHistory(e.orgName,e.productObjective,e.productStep)})()}totalRequests(){let e=Object.keys(this.loadTestResults),o={},i=0;for(let r of e){let n=this.loadTestResults[r].aggregate.counters,f=this.loadTestResults[r].date,d=Object.keys(n).filter(g=>g.startsWith("http.requests"));for(let g of d)o[f]||(o[f]={}),o[f][g]=(o[f][g]||0)+n[g]}for(let r of Object.keys(o))i+=o[r]["http.requests"];this.totalNumberOfRequests=i}byCodes(){let e=Object.keys(this.loadTestResults),o={};for(let i of e){let r=this.loadTestResults[i].aggregate.counters,n=this.loadTestResults[i].date.split("-").slice(0,3).join("-"),f=Object.keys(r).filter(d=>d.startsWith("http.codes."));o[n]||(o[n]={});for(let d of f)o[n][d]=(o[n][d]||0)+r[d]}return o=this.ordenarDiccionarioPorFechas(o),o}normalizarFecha(e){const[o,i,r]=e.split("-").map(d=>parseInt(d,10));return`${o}-${i<10?`0${i}`:i.toString()}-${r<10?`0${r}`:r.toString()}`}ordenarDiccionarioPorFechas(e){const i=Object.keys(e).sort((n,f)=>{const d=new Date(this.normalizarFecha(n)),g=new Date(this.normalizarFecha(f));return d.getTime()-g.getTime()}),r={};return i.forEach(n=>{r[n]=e[n]}),r}plotCodes(){var e=this;return(0,p.A)(function*(){let o=e.byCodes();console.log(o);let i=Object.keys(o);e.listOfDates=i;let r=new Set;for(let g of i){let s=Object.keys(o[g]);for(let v of s)r.add(v)}let n={};for(let g in o){let a=o[g];for(let s of r)n[s]||(n[s]=[]),n[s].push(a[s]||0)}let f=["#36b311","#306fc6","#ed3b3b","#f4ba20"];for(let g in n){let s,a=g.split(".").pop();null!=a&&a.startsWith("2")&&(s=f[0]),null!=a&&a.startsWith("3")&&(s=f[1]),null!=a&&a.startsWith("4")&&(s=f[2]),null!=a&&a.startsWith("5")&&(s=f[3]),s||(s="#000000"),e.statusCodesOptions.series.push({name:g,type:"line",data:n[g],lineStyle:{color:s},itemStyle:{color:s}})}e.statusCodesOptions.xAxis={type:"category",boundaryGap:!1,data:i},e.statusCodesOptions={...e.statusCodesOptions};let d=document.getElementById("httpCodesChart");console.log(d),d.style.width="100%",d.style.height="25em"})()}responseTime(){let e=Object.keys(this.loadTestResults),o={};for(let a of e){let s=this.loadTestResults[a].aggregate.histograms,v=this.loadTestResults[a].date,h=Object.keys(s).filter(k=>k.startsWith("http.response_time"));for(let k of h)o[v]=s[k]}let i=Object.entries(o).reduce((a,[s,v])=>{const h=s.split("-").slice(0,3).join("-");return a[h]=a[h]||[],a[h].push(v),a},{}),r=Object.keys(i).sort((a,s)=>new Date(a).getTime()-new Date(s).getTime()),n={count:0,max:0,min:0,mean:0,median:0,p50:0,p90:0,p95:0,p99:0,p999:0},f={};r.forEach(a=>{let s={count:0,max:0,min:0,mean:0,median:0,p50:0,p90:0,p95:0,p99:0,p999:0},v=0;i[a].forEach(h=>{s.count+=h.count,s.max+=h.max,s.min+=h.min,s.mean+=h.mean,s.median+=h.median,s.p50+=h.p50,s.p90+=h.p90,s.p95+=h.p95,s.p99+=h.p99,s.p999+=h.p999,v++});for(let h in s)"count"!==h&&v>0&&(s[h]=s[h]/v);f[a]=s,n.count+=s.count,n.max+=s.max,n.min+=s.min,n.mean+=s.mean,n.median+=s.median,n.p50+=s.p50,n.p90+=s.p90,n.p95+=s.p95,n.p99+=s.p99,n.p999+=s.p999});let d=r.length;d>0&&(n.mean/=d,n.median/=d,n.p50/=d,n.p90/=d,n.p95/=d,n.p99/=d,n.p999/=d,n.max/=d,n.min/=d);for(let a in n)"count"===a||"p90"===a||"p50"===a||"p999"===a||this.responseTimeOptions.series.push({name:a,type:"bar",data:[n[a]],label:{show:!0,formatter:s=>`${s.value.toFixed(2)} ms`}});this.responseTimeOptions.xAxis={type:"category",boundaryGap:!1,data:["Category"]},this.responseTimeOptions={...this.responseTimeOptions};let g=document.getElementById("httpResponseTimeChart");console.log(g),g.style.width="100%",g.style.height="25em"}showLoading(){var e=this;return(0,p.A)(function*(){yield(yield e.loadingCtrl.create({})).present()})()}hideLoading(){var e=this;return(0,p.A)(function*(){yield e.loadingCtrl.dismiss()})()}showAlert(e,o){var i=this;return(0,p.A)(function*(){const r=yield i.alertCtrl.create({header:o,message:e,buttons:["OK"]});return yield r.present(),yield r.onDidDismiss(),!0})()}viewHistory(e){this.router.navigate(["/load-test-history",{productObjective:this.productObjective,productStep:this.productStep,day:e}])}}return(u=T).\u0275fac=function(e){return new(e||u)(t.rXU(C.Ix),t.rXU(C.nX),t.rXU(b.s),t.rXU(l.Xi),t.rXU(l.hG))},u.\u0275cmp=t.VBU({type:u,selectors:[["app-load-test"]],decls:43,vars:13,consts:[[3,"title"],[3,"fullscreen"],[1,"lg:m-10","md:m-10"],["size","12"],["label","Target","placeholder","Enter a target","type","text","labelPlacement","stacked",1,"",3,"ngModelChange","ngModel"],["size","12","size-md","12","size-lg","12",1,"flex","flex-row","justify-end"],["color","primary","size","small",1,"",3,"click"],["name","add"],[1,"w-full","p-6","flex","flex-col","justify-center","items-center"],[1,"text-3xl"],[1,"text-2xl","text-white"],[1,"h-[25em]","w-full"],["id","httpCodesChart","echarts","",1,"demo-chart","h-full","w-full",3,"options"],["id","httpResponseTimeChart","echarts","",1,"demo-chart","h-full","w-full",3,"options"],["size","12",1,"w-full"],[1,"w-full"],["class","w-full",3,"click",4,"ngFor","ngForOf"],[1,"w-full",3,"click"],["name","arrow-forward","color","primary"]],template:function(e,o){1&e&&(t.nrm(0,"app-header-return",0),t.j41(1,"ion-content",1)(2,"ion-grid"),t.nrm(3,"app-title",0),t.j41(4,"ion-row",2)(5,"ion-col",3)(6,"ion-card")(7,"ion-card-content")(8,"ion-input",4),t.mxI("ngModelChange",function(r){return t.DH7(o.target,r)||(o.target=r),r}),t.k0s()()()()(),t.j41(9,"ion-row",2)(10,"ion-col",5)(11,"ion-button",6),t.bIt("click",function(){return o.sendRequest()}),t.EFF(12,"Load Target "),t.nrm(13,"ion-icon",7),t.k0s()()(),t.nrm(14,"app-title",0),t.j41(15,"ion-row",2)(16,"ion-card",8)(17,"ion-card-header")(18,"ion-card-title",9),t.EFF(19,"Total Number of Requests"),t.k0s()(),t.j41(20,"ion-card-content")(21,"h1",10),t.EFF(22),t.nI1(23,"number"),t.k0s()()()(),t.j41(24,"ion-row",2)(25,"ion-card",8)(26,"ion-card-header")(27,"ion-card-title",9),t.EFF(28,"HTTP Status Codes"),t.k0s()(),t.j41(29,"ion-card-content",11),t.nrm(30,"div",12),t.k0s()()(),t.j41(31,"ion-row",2)(32,"ion-card",8)(33,"ion-card-header")(34,"ion-card-title",9),t.EFF(35,"HTTP Response Time"),t.k0s()(),t.j41(36,"ion-card-content",11),t.nrm(37,"div",13),t.k0s()()(),t.nrm(38,"app-title",0),t.j41(39,"ion-row",2)(40,"ion-col",14)(41,"ion-list",15),t.DNE(42,E,4,1,"ion-item",16),t.k0s()()()()()),2&e&&(t.Y8G("title","Load Test  For "+o.productStep),t.R7$(),t.Y8G("fullscreen",!0),t.R7$(2),t.Y8G("title","New Load Test"),t.R7$(5),t.R50("ngModel",o.target),t.R7$(6),t.Y8G("title","Analytics For "+o.productStep),t.R7$(8),t.JRh(t.i5U(23,10,o.totalNumberOfRequests,"1.0-0")),t.R7$(8),t.Y8G("options",o.statusCodesOptions),t.R7$(7),t.Y8G("options",o.responseTimeOptions),t.R7$(),t.Y8G("title","Results for date: "),t.R7$(4),t.Y8G("ngForOf",o.listOfDates))},dependencies:[m.Sq,O.BC,O.vS,l.Jm,l.b_,l.I9,l.ME,l.tN,l.hU,l.W9,l.lO,l.iq,l.$w,l.uz,l.he,l.nf,l.ln,l.Gw,y.W,P.p,_.$P,m.QX]}),T})()}];let w=(()=>{var u;class T{}return(u=T).\u0275fac=function(e){return new(e||u)},u.\u0275mod=t.$C({type:u}),u.\u0275inj=t.G2t({imports:[C.iI.forChild(M),C.iI]}),T})();var D=c(5553);let F=(()=>{var u;class T{}return(u=T).\u0275fac=function(e){return new(e||u)},u.\u0275mod=t.$C({type:u}),u.\u0275inj=t.G2t({imports:[m.MD,O.YN,l.bv,w,D.h]}),T})()}}]);