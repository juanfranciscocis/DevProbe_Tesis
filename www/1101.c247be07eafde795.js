"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[1101],{1101:(U,v,s)=>{s.r(v),s.d(v,{FlameGraphPageModule:()=>R});var y=s(177),G=s(4341),h=s(7863),p=s(305),m=s(467),a=s(4438),P=s(6560),F=s(7616);let b=(()=>{var t;class i{constructor(e,o,c,n){this.flameGraphService=e,this.loadingCtrl=o,this.router=c,this.route=n,this.product={},this.date="",this.config={data:C}}ionViewWillEnter(){this.getProductAndDateFromParams(),this.getFlameGraph()}getProductAndDateFromParams(){this.route.queryParams.subscribe(e=>{this.product=JSON.parse(e.product),this.date=e.date}),console.log(this.product.productObjective),console.log(this.date)}getFlameGraph(){var e=this;return(0,m.A)(function*(){try{yield e.showLoading();const o=localStorage.getItem("user");if(!o)return;const n=JSON.parse(o).orgName;console.log(n);const r=yield e.flameGraphService.getFlameGraphByDate(n,e.product.productObjective,e.date);console.log(r);let l=[],u=[];for(let f in r){const d=null==r?void 0:r[f];u=Object.keys(d),console.log(u);for(let D in d){const O=e.transformToRawData(d[D][0]);l.push(O)}}l=[{label:"root",value:100,children:l}],e.config={data:l},console.log(l),yield e.hideLoading()}catch(o){console.log(o)}})()}showLoading(){var e=this;return(0,m.A)(function*(){yield(yield e.loadingCtrl.create({})).present()})()}hideLoading(){var e=this;return(0,m.A)(function*(){yield e.loadingCtrl.dismiss()})()}ngOnInit(){}average(e){const o=e.map(Number);return o.reduce((n,r)=>n+r,0)/o.length}transformToRawData(e){const o=e.cpu_usage?this.average(e.cpu_usage):0,c=[];for(const n in e){if("id"===n||"cpu_usage"===n)continue;const r=e[n];if("object"!=typeof r||Array.isArray(r))"object"!=typeof r&&c.push({label:n,value:0,children:[]});else if("sub_services"===n)for(const l in r){const u=r[l],d={label:l,value:u.cpu_usage?this.average(u.cpu_usage):0,children:this.transformToRawData(u).children};c.push(d)}else{const u={label:n,value:r.cpu_usage?this.average(r.cpu_usage):0,children:this.transformToRawData(r).children};c.push(u)}}return{label:e.id,value:o,children:c}}}return(t=i).\u0275fac=function(e){return new(e||t)(a.rXU(P.x),a.rXU(h.Xi),a.rXU(p.Ix),a.rXU(p.nX))},t.\u0275cmp=a.VBU({type:t,selectors:[["app-flame-graph"]],decls:13,vars:3,consts:[[3,"translucent"],[3,"fullscreen"],["collapse","condense"],["size","large"],[1,"wrapper-responsive"],[3,"config"]],template:function(e,o){1&e&&(a.j41(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-title"),a.EFF(3,"flame-graph"),a.k0s()()(),a.j41(4,"ion-content",1)(5,"ion-header",2)(6,"ion-toolbar")(7,"ion-title",3),a.EFF(8,"flame-graph"),a.k0s()()(),a.j41(9,"h3"),a.EFF(10," Responsive "),a.k0s(),a.j41(11,"div",4),a.nrm(12,"ngx-flamegraph",5),a.k0s()()),2&e&&(a.Y8G("translucent",!0),a.R7$(4),a.Y8G("fullscreen",!0),a.R7$(8),a.Y8G("config",o.config))},dependencies:[h.W9,h.eU,h.BC,h.ai,F.E],styles:[".wrapper-fixed-width[_ngcontent-%COMP%]{width:900px;margin:auto}.wrapper-responsive[_ngcontent-%COMP%]{width:100%;margin:auto}h2[_ngcontent-%COMP%], h3[_ngcontent-%COMP%]{text-align:center;-webkit-user-select:none;user-select:none}"]}),i})();const C=[{label:"root",value:100,children:[]}],M=[{path:"",component:b}];let w=(()=>{var t;class i{}return(t=i).\u0275fac=function(e){return new(e||t)},t.\u0275mod=a.$C({type:t}),t.\u0275inj=a.G2t({imports:[p.iI.forChild(M),p.iI]}),i})(),R=(()=>{var t;class i{}return(t=i).\u0275fac=function(e){return new(e||t)},t.\u0275mod=a.$C({type:t}),t.\u0275inj=a.G2t({imports:[y.MD,G.YN,h.bv,w,F.n]}),i})()}}]);