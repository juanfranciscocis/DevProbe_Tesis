"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[4304],{5553:(L,v,a)=>{a.d(v,{h:()=>O});var d=a(177),j=a(7863),c=a(4438);let O=(()=>{var f;class t{}return(f=t).\u0275fac=function(T){return new(T||f)},f.\u0275mod=c.$C({type:f}),f.\u0275inj=c.G2t({imports:[d.MD,j.bv]}),t})()},3241:(L,v,a)=>{a.d(v,{p:()=>O});var d=a(4438),j=a(177),c=a(7863);let O=(()=>{var f;class t{constructor(T){this.location=T,this.title="Header Title"}ngOnInit(){}goBack(){this.location.back()}}return(f=t).\u0275fac=function(T){return new(T||f)(d.rXU(j.aZ))},f.\u0275cmp=d.VBU({type:f,selectors:[["app-header-return"]],inputs:{title:"title"},decls:6,vars:2,consts:[[3,"translucent"],["slot","start","menu","menu-id"],["name","arrow-back","slot","start",1,"p-4","bigger-icon",3,"click"]],template:function(T,b){1&T&&(d.j41(0,"ion-header",0)(1,"ion-toolbar"),d.nrm(2,"ion-menu-button",1),d.j41(3,"ion-icon",2),d.bIt("click",function(){return b.goBack()}),d.k0s(),d.j41(4,"ion-title"),d.EFF(5),d.k0s()()()),2&T&&(d.Y8G("translucent",!0),d.R7$(5),d.JRh(b.title))},dependencies:[c.eU,c.iq,c.MC,c.BC,c.ai],styles:[".bigger-icon[_ngcontent-%COMP%]{font-size:1.5em}"]}),t})()},4304:(L,v,a)=>{a.r(v),a.d(v,{LoadTestHistoryPageModule:()=>A});var d=a(177),j=a(4341),c=a(7863),O=a(7650),f=a(467),t=a(4438),R=a(4970),T=a(8453),b=a(3241),F=a(2820);const x=[{path:"",component:(()=>{var i;class C{constructor(o,e,s){this.activatedRoute=o,this.router=e,this.loadTestService=s,this.productObjective="",this.productStep="",this.orgName="",this.date="",this.loadTestResults={},this.totalNumberOfRequests=0,this.statusCodesOptions={tooltip:{trigger:"axis"},xAxis:{type:"category",boundaryGap:!1,data:[]},yAxis:{type:"value"},series:[]},this.responseTimeOptions={tooltip:{trigger:"axis"},xAxis:{type:"category",boundaryGap:!1,data:[]},yAxis:{type:"value"},series:[]}}ngOnInit(){var o=this;this.getParams(),this.getLoadTestHistoryByDate().then(function(){var e=(0,f.A)(function*(s){o.totalRequests(),yield o.plotCodes(),yield o.responseTime()});return function(s){return e.apply(this,arguments)}}())}getParams(){this.activatedRoute.params.subscribe(e=>{this.productObjective=e.productObjective,this.productStep=e.productStep,this.date=e.day});const o=JSON.parse(localStorage.getItem("user"));this.orgName=o.orgName,console.log(this.orgName),console.log(this.productObjective),console.log(this.productStep),console.log(this.date)}getLoadTestHistoryByDate(){var o=this;return(0,f.A)(function*(){o.loadTestResults=yield o.loadTestService.getLoadTestHistoryByDate(o.orgName,o.productObjective,o.productStep,o.date)})()}totalRequests(){let o=Object.keys(this.loadTestResults),e={},s=0;for(let r of o){let n=this.loadTestResults[r].aggregate.counters,u=this.loadTestResults[r].date,y=Object.keys(n).filter(p=>p.startsWith("http.requests"));for(let p of y)e[u]||(e[u]={}),e[u][p]=(e[u][p]||0)+n[p]}for(let r of Object.keys(e))s+=e[r]["http.requests"];this.totalNumberOfRequests=s}byCodes(){let o=Object.keys(this.loadTestResults),e={};for(let s of o){let r=this.loadTestResults[s].aggregate.counters,n=this.loadTestResults[s].date,u=Object.keys(r).filter(y=>y.startsWith("http.codes."));for(let y of u)e[n]||(e[n]={}),e[n][y]=r[y]}return console.log(e),e=this.ordenarDiccionarioPorFechas(e),e}normalizarFecha(o){const[e,s,r]=o.split("-").map(y=>parseInt(y,10));return`${e}-${s<10?`0${s}`:s.toString()}-${r<10?`0${r}`:r.toString()}`}ordenarDiccionarioPorFechas(o){const s=Object.keys(o).sort((n,u)=>{const y=new Date(this.normalizarFecha(n)),p=new Date(this.normalizarFecha(u));return y.getTime()-p.getTime()}),r={};return s.forEach(n=>{r[n]=o[n]}),r}plotCodes(){var o=this;return(0,f.A)(function*(){let e=o.byCodes();console.log(e);let s=Object.keys(e),r=new Set;for(let p of s){let h=Object.keys(e[p]);for(let M of h)r.add(M)}let n={};for(let p in e){let l=e[p];for(let h of r)n[h]||(n[h]=[]),n[h].push(l[h]||0)}let u=["#36b311","#306fc6","#ed3b3b","#f4ba20"];for(let p in n){let h,l=p.split(".").pop();null!=l&&l.startsWith("2")&&(h=u[0]),null!=l&&l.startsWith("3")&&(h=u[1]),null!=l&&l.startsWith("4")&&(h=u[2]),null!=l&&l.startsWith("5")&&(h=u[3]),h||(h="#000000"),o.statusCodesOptions.series.push({name:p,type:"line",data:n[p],lineStyle:{color:h},itemStyle:{color:h}})}o.statusCodesOptions.xAxis={type:"category",boundaryGap:!1,data:s},o.statusCodesOptions={...o.statusCodesOptions};let y=document.getElementById("httpCodesChartHistory");console.log(y),y.style.width="100%",y.style.height="25em"})()}responseTime(){let o=Object.keys(this.loadTestResults),e={};for(let g of o){let m=this.loadTestResults[g].aggregate.histograms,k=this.loadTestResults[g].date,D=Object.keys(m).filter(H=>H.startsWith("http.response_time"));for(let H of D)e[k]=m[H]}let s=Object.keys(e);s=function r(g){return g.sort((m,k)=>{let D=m.split("-").slice(0,3).join("/"),H=k.split("-").slice(0,3).join("/"),S=m.split("-").slice(3,6).join(":"),$=H+" "+k.split("-").slice(3,6).join(":");return new Date(D+" "+S).getTime()-new Date($).getTime()})}(s),console.log("date",s),console.log("responseTimes",e);let n=[],u=[],y=[],p=[],l=[],h=[];for(let g in s){console.log("date",s[g]);for(let m in e[s[g]])"min"===m&&n.push(e[s[g]][m]),"max"===m&&u.push(e[s[g]][m]),"p95"===m&&y.push(e[s[g]][m]),"p99"===m&&p.push(e[s[g]][m]),"mean"===m&&l.push(e[s[g]][m]),"median"===m&&h.push(e[s[g]][m])}console.log("min",n);let M={min:n,max:u,p95:y,p99:p,mean:l,median:h};this.responseTimeOptions.series=[];for(let g in M)this.responseTimeOptions.series.push({name:g,type:"bar",data:M[g]});this.responseTimeOptions.xAxis={type:"category",boundaryGap:!1,data:s},this.responseTimeOptions={...this.responseTimeOptions};let E=document.getElementById("httpResponseTimeChartHistory");console.log(E),E.style.width="100%",E.style.height="25em"}}return(i=C).\u0275fac=function(o){return new(o||i)(t.rXU(O.nX),t.rXU(O.Ix),t.rXU(R.s))},i.\u0275cmp=t.VBU({type:i,selectors:[["app-load-test-history"]],decls:28,vars:9,consts:[[3,"title"],[3,"fullscreen"],[1,"lg:m-10","md:m-10"],["size","12",1,"w-full"],[1,"w-full","p-6","flex","flex-col","justify-center","items-center"],[1,"text-3xl"],[1,"text-2xl","text-white"],[1,"h-[25em]","w-full"],["id","httpCodesChartHistory","echarts","",1,"demo-chart","h-full","w-full",3,"options"],["id","httpResponseTimeChartHistory","echarts","",1,"demo-chart","h-full","w-full",3,"options"]],template:function(o,e){1&o&&(t.nrm(0,"app-header-return",0),t.j41(1,"ion-content",1)(2,"ion-grid"),t.nrm(3,"app-title",0),t.j41(4,"ion-row",2)(5,"ion-col",3)(6,"ion-card",4)(7,"ion-card-header")(8,"ion-card-title",5),t.EFF(9,"Total Number of Requests"),t.k0s()(),t.j41(10,"ion-card-content")(11,"h1",6),t.EFF(12),t.nI1(13,"number"),t.k0s()()()()(),t.j41(14,"ion-row",2)(15,"ion-card",4)(16,"ion-card-header")(17,"ion-card-title",5),t.EFF(18,"HTTP Status Codes"),t.k0s()(),t.j41(19,"ion-card-content",7),t.nrm(20,"div",8),t.k0s()()(),t.j41(21,"ion-row",2)(22,"ion-card",4)(23,"ion-card-header")(24,"ion-card-title",5),t.EFF(25,"HTTP Response Time"),t.k0s()(),t.j41(26,"ion-card-content",7),t.nrm(27,"div",9),t.k0s()()()()()),2&o&&(t.Y8G("title","History For: "+e.date),t.R7$(),t.Y8G("fullscreen",!0),t.R7$(2),t.Y8G("title","Load Test History"),t.R7$(9),t.JRh(t.i5U(13,6,e.totalNumberOfRequests,"1.0-0")),t.R7$(8),t.Y8G("options",e.statusCodesOptions),t.R7$(7),t.Y8G("options",e.responseTimeOptions))},dependencies:[c.b_,c.I9,c.ME,c.tN,c.hU,c.W9,c.lO,c.ln,T.W,b.p,F.$P,d.QX]}),C})()}];let I=(()=>{var i;class C{}return(i=C).\u0275fac=function(o){return new(o||i)},i.\u0275mod=t.$C({type:i}),i.\u0275inj=t.G2t({imports:[O.iI.forChild(x),O.iI]}),C})();var B=a(5553);let A=(()=>{var i;class C{}return(i=C).\u0275fac=function(o){return new(o||i)},i.\u0275mod=t.$C({type:i}),i.\u0275inj=t.G2t({imports:[d.MD,j.YN,c.bv,I,B.h]}),C})()}}]);