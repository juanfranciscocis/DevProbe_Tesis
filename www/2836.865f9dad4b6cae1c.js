"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[2836],{5553:(H,L,h)=>{h.d(L,{h:()=>v});var T=h(177),M=h(7863),g=h(4438);let v=(()=>{var j;class o{}return(j=o).\u0275fac=function(R){return new(R||j)},j.\u0275mod=g.$C({type:j}),j.\u0275inj=g.G2t({imports:[T.MD,M.bv]}),o})()},3241:(H,L,h)=>{h.d(L,{p:()=>v});var T=h(4438),M=h(177),g=h(7863);let v=(()=>{var j;class o{constructor(R){this.location=R,this.title="Header Title"}ngOnInit(){}goBack(){this.location.back()}}return(j=o).\u0275fac=function(R){return new(R||j)(T.rXU(M.aZ))},j.\u0275cmp=T.VBU({type:j,selectors:[["app-header-return"]],inputs:{title:"title"},decls:6,vars:2,consts:[[3,"translucent"],["slot","start","menu","menu-id"],["name","arrow-back","slot","start",1,"p-4","bigger-icon",3,"click"]],template:function(R,O){1&R&&(T.j41(0,"ion-header",0)(1,"ion-toolbar"),T.nrm(2,"ion-menu-button",1),T.j41(3,"ion-icon",2),T.bIt("click",function(){return O.goBack()}),T.k0s(),T.j41(4,"ion-title"),T.EFF(5),T.k0s()()()),2&R&&(T.Y8G("translucent",!0),T.R7$(5),T.JRh(O.title))},dependencies:[g.eU,g.iq,g.MC,g.BC,g.ai],styles:[".bigger-icon[_ngcontent-%COMP%]{font-size:1.5em}"]}),o})()},2836:(H,L,h)=>{h.r(L),h.d(L,{LoadTestPageModule:()=>q});var T=h(177),M=h(4341),g=h(7863),v=h(7650),j=h(467),o=h(4438),P=h(4262);class R{static toArtilleryData(n){return function F(e,n){return E(e,n,k)}(JSON.parse(n),b("ArtilleryData"))}static artilleryDataToJson(n){return JSON.stringify(function $(e,n){return E(e,n,I)}(n,b("ArtilleryData")),null,2)}}function O(e,n,f,t=""){const r=_(e);throw Error(`Invalid value${f?` for key "${f}"`:""}${t?` on ${t}`:""}. Expected ${r} but got ${JSON.stringify(n)}`)}function _(e){return Array.isArray(e)?2===e.length&&void 0===e[0]?`an optional ${_(e[1])}`:`one of [${e.map(n=>_(n)).join(", ")}]`:"object"==typeof e&&void 0!==e.literal?e.literal:typeof e}function k(e){if(void 0===e.jsonToJS){const n={};e.props.forEach(f=>n[f.json]={key:f.js,typ:f.typ}),e.jsonToJS=n}return e.jsonToJS}function I(e){if(void 0===e.jsToJSON){const n={};e.props.forEach(f=>n[f.js]={key:f.json,typ:f.typ}),e.jsToJSON=n}return e.jsToJSON}function E(e,n,f,t="",r=""){if("any"===n)return e;if(null===n)return null===e?e:O(n,e,t,r);if(!1===n)return O(n,e,t,r);let a;for(;"object"==typeof n&&void 0!==n.ref;)a=n.ref,n=G[n.ref];return Array.isArray(n)?function i(s,p){return-1!==s.indexOf(p)?p:O(s.map(d=>w(d)),p,t,r)}(n,e):"object"==typeof n?n.hasOwnProperty("unionMembers")?function l(s,p){const d=s.length;for(let C=0;C<d;C++){const A=s[C];try{return E(p,A,f)}catch{}}return O(s,p,t,r)}(n.unionMembers,e):n.hasOwnProperty("arrayItems")?function m(s,p){return Array.isArray(p)?p.map(d=>E(d,s,f)):O(w("array"),p,t,r)}(n.arrayItems,e):n.hasOwnProperty("props")?function y(s,p,d){if(null===d||"object"!=typeof d||Array.isArray(d))return O(w(a||"object"),d,t,r);const C={};return Object.getOwnPropertyNames(s).forEach(A=>{const x=s[A],N=Object.prototype.hasOwnProperty.call(d,A)?d[A]:void 0;C[x.key]=void 0!==N?E(N,x.typ,f,A,a):void 0}),Object.getOwnPropertyNames(d).forEach(A=>{Object.prototype.hasOwnProperty.call(s,A)||(C[A]=E(d[A],p,f,A,a))}),C}(f(n),n.additional,e):O(n,e,t,r):n===Date&&"number"!=typeof e?function c(s){if(null===s)return null;const p=new Date(s);return isNaN(p.valueOf())?O(w("Date"),s,t,r):p}(e):function u(s,p){return typeof s==typeof p?p:O(s,p,t,r)}(n,e)}function w(e){return{literal:e}}function S(e,n){return{props:e,additional:n}}function D(e){return{props:[],additional:e}}function b(e){return{ref:e}}const G={ArtilleryData:S([{json:"aggregate",js:"aggregate",typ:b("Aggregate")},{json:"intermediate",js:"intermediate",typ:function U(e){return{arrayItems:e}}(b("Intermediate"))},{json:"date",js:"date",typ:""}],!1),Aggregate:S([{json:"counters",js:"counters",typ:D(0)},{json:"rates",js:"rates",typ:b("Rates")},{json:"firstCounterAt",js:"firstCounterAt",typ:0},{json:"firstHistogramAt",js:"firstHistogramAt",typ:0},{json:"lastCounterAt",js:"lastCounterAt",typ:0},{json:"lastHistogramAt",js:"lastHistogramAt",typ:0},{json:"firstMetricAt",js:"firstMetricAt",typ:0},{json:"lastMetricAt",js:"lastMetricAt",typ:0},{json:"period",js:"period",typ:0},{json:"summaries",js:"summaries",typ:b("Histograms")},{json:"histograms",js:"histograms",typ:b("Histograms")}],!1),Histograms:S([{json:"http.response_time",js:"http.response_time",typ:D(3.14)},{json:"plugins.metrics-by-endpoint.response_time./",js:"plugins.metrics-by-endpoint.response_time./",typ:D(3.14)},{json:"vusers.session_length",js:"vusers.session_length",typ:function W(...e){return{unionMembers:e}}(void 0,D(3.14))}],!1),Rates:S([{json:"http.request_rate",js:"http.request_rate",typ:0}],!1),Intermediate:S([{json:"counters",js:"counters",typ:D(0)},{json:"rates",js:"rates",typ:b("Rates")},{json:"http.request_rate",js:"http.request_rate",typ:null},{json:"firstCounterAt",js:"firstCounterAt",typ:0},{json:"firstHistogramAt",js:"firstHistogramAt",typ:0},{json:"lastCounterAt",js:"lastCounterAt",typ:0},{json:"lastHistogramAt",js:"lastHistogramAt",typ:0},{json:"firstMetricAt",js:"firstMetricAt",typ:0},{json:"lastMetricAt",js:"lastMetricAt",typ:0},{json:"period",js:"period",typ:""},{json:"summaries",js:"summaries",typ:b("Histograms")},{json:"histograms",js:"histograms",typ:b("Histograms")}],!1)};var B=h(1626);let J=(()=>{var e;class n{constructor(t,r){this.firestore=t,this.http=r,this.url="https://devprobeapi.onrender.com/create_load_test"}getLoadTestHistory(t,r,u){var l=this;return(0,j.A)(function*(){const i=(0,P.H9)(l.firestore,"teams",t,"products",r,"load_test",u),m=yield(0,P.x7)(i);if(m.exists()){let c=m.data();console.log(c);let y=Object.keys(c);console.log(y);for(let a of y)c[a]=R.toArtilleryData(c[a]);return c}return{}})()}sendLoadTest(t,r,u,l){var i=this;return(0,j.A)(function*(){try{const m={team:t,product:r,service:u,target:`https://${l}`};return yield i.http.post(i.url,m).toPromise()}catch{return{}}})()}}return(e=n).\u0275fac=function(t){return new(t||e)(o.KVO(P._7),o.KVO(B.Qq))},e.\u0275prov=o.jDH({token:e,factory:e.\u0275fac,providedIn:"root"}),n})();var z=h(8453),K=h(3241),X=h(2820);const Y=[{path:"",component:(()=>{var e;class n{constructor(t,r,u,l,i){this.router=t,this.activatedRoute=r,this.loadTestService=u,this.loadingCtrl=l,this.alertCtrl=i,this.productStep="",this.productObjective="",this.orgName="",this.target="",this.description="",this.loadTestResults={},this.totalNumberOfRequests=0,this.statusCodesOptions={tooltip:{trigger:"axis"},xAxis:{type:"category",boundaryGap:!1,data:[]},yAxis:{type:"value"},series:[]},this.responseTimeOptions={tooltip:{trigger:"axis"},xAxis:{type:"category",boundaryGap:!1,data:[]},yAxis:{type:"value"},series:[]}}ngOnInit(){}ionViewWillEnter(){var t=this;return(0,j.A)(function*(){yield t.showLoading(),t.getParams(),yield t.getHistoryResults().then(()=>{t.plotCodes(),t.totalRequests(),t.responseTime()}),yield t.hideLoading()})()}getParams(){this.activatedRoute.params.subscribe(r=>{this.productObjective=r.productObjective,this.productStep=r.step});const t=JSON.parse(localStorage.getItem("user"));this.orgName=t.orgName,console.log(this.orgName),console.log(this.productObjective),console.log(this.productStep)}sendRequest(){var t=this;return(0,j.A)(function*(){if(yield t.showLoading(),t.target.startsWith("http://")||t.target.startsWith("https://")||t.target.endsWith("/"))return yield t.hideLoading(),void(yield t.showAlert("No http or https is needed, check for slashes at the end of the domain","Please enter a valid host"));yield t.loadTestService.sendLoadTest(t.orgName,t.productObjective,t.productStep,t.target).then(function(){var r=(0,j.A)(function*(u){yield t.hideLoading(),console.log("data",u),u&&(yield t.showAlert("Test sent, please wait a few seconds to GET RESULTS","Success"))});return function(u){return r.apply(this,arguments)}}()),yield t.hideLoading()})()}getHistoryResults(){var t=this;return(0,j.A)(function*(){t.loadTestResults=yield t.loadTestService.getLoadTestHistory(t.orgName,t.productObjective,t.productStep)})()}totalRequests(){let t=Object.keys(this.loadTestResults),r={},u=0;for(let l of t){let i=this.loadTestResults[l].aggregate.counters,m=this.loadTestResults[l].date,c=Object.keys(i).filter(y=>y.startsWith("http.requests"));for(let y of c)r[m]||(r[m]={}),r[m][y]=(r[m][y]||0)+i[y]}for(let l of Object.keys(r))u+=r[l]["http.requests"];this.totalNumberOfRequests=u}byCodes(){let t=Object.keys(this.loadTestResults),r={};for(let u of t){let l=this.loadTestResults[u].aggregate.counters,i=this.loadTestResults[u].date.split("-").slice(0,3).join("-"),m=Object.keys(l).filter(c=>c.startsWith("http.codes."));r[i]||(r[i]={});for(let c of m)r[i][c]=(r[i][c]||0)+l[c]}return r=this.ordenarDiccionarioPorFechas(r),r}normalizarFecha(t){const[r,u,l]=t.split("-").map(c=>parseInt(c,10));return`${r}-${u<10?`0${u}`:u.toString()}-${l<10?`0${l}`:l.toString()}`}ordenarDiccionarioPorFechas(t){const u=Object.keys(t).sort((i,m)=>{const c=new Date(this.normalizarFecha(i)),y=new Date(this.normalizarFecha(m));return c.getTime()-y.getTime()}),l={};return u.forEach(i=>{l[i]=t[i]}),l}plotCodes(){var t=this;return(0,j.A)(function*(){let r=t.byCodes();console.log(r);let u=Object.keys(r),l=new Set;for(let y of u){let s=Object.keys(r[y]);for(let p of s)l.add(p)}let i={};for(let y in r){let a=r[y];for(let s of l)i[s]||(i[s]=[]),i[s].push(a[s]||0)}let m=["#36b311","#306fc6","#ed3b3b","#f4ba20"];for(let y in i){let s,a=y.split(".").pop();null!=a&&a.startsWith("2")&&(s=m[0]),null!=a&&a.startsWith("3")&&(s=m[1]),null!=a&&a.startsWith("4")&&(s=m[2]),null!=a&&a.startsWith("5")&&(s=m[3]),s||(s="#000000"),t.statusCodesOptions.series.push({name:y,type:"line",data:i[y],lineStyle:{color:s},itemStyle:{color:s}})}t.statusCodesOptions.xAxis={type:"category",boundaryGap:!1,data:u},t.statusCodesOptions={...t.statusCodesOptions};let c=document.getElementById("httpCodesChart");console.log(c),c.style.width="100%",c.style.height="25em"})()}responseTime(){let t=Object.keys(this.loadTestResults),r={};for(let a of t){let s=this.loadTestResults[a].aggregate.histograms,p=this.loadTestResults[a].date,d=Object.keys(s).filter(C=>C.startsWith("http.response_time"));for(let C of d)r[p]=s[C]}let u=Object.entries(r).reduce((a,[s,p])=>{const d=s.split("-").slice(0,3).join("-");return a[d]=a[d]||[],a[d].push(p),a},{}),l=Object.keys(u).sort((a,s)=>new Date(a).getTime()-new Date(s).getTime()),i={count:0,max:0,min:0,mean:0,median:0,p50:0,p90:0,p95:0,p99:0,p999:0},m={};l.forEach(a=>{let s={count:0,max:0,min:0,mean:0,median:0,p50:0,p90:0,p95:0,p99:0,p999:0},p=0;u[a].forEach(d=>{s.count+=d.count,s.max+=d.max,s.min+=d.min,s.mean+=d.mean,s.median+=d.median,s.p50+=d.p50,s.p90+=d.p90,s.p95+=d.p95,s.p99+=d.p99,s.p999+=d.p999,p++});for(let d in s)"count"!==d&&p>0&&(s[d]=s[d]/p);m[a]=s,i.count+=s.count,i.max+=s.max,i.min+=s.min,i.mean+=s.mean,i.median+=s.median,i.p50+=s.p50,i.p90+=s.p90,i.p95+=s.p95,i.p99+=s.p99,i.p999+=s.p999});let c=l.length;c>0&&(i.mean/=c,i.median/=c,i.p50/=c,i.p90/=c,i.p95/=c,i.p99/=c,i.p999/=c,i.max/=c,i.min/=c);for(let a in i)"count"===a||"p90"===a||"p50"===a||"p999"===a||this.responseTimeOptions.series.push({name:a,type:"bar",data:[i[a]],label:{show:!0,formatter:s=>`${s.value.toFixed(2)} ms`}});this.responseTimeOptions.xAxis={type:"category",boundaryGap:!1,data:["Category"]},this.responseTimeOptions={...this.responseTimeOptions};let y=document.getElementById("httpResponseTimeChart");console.log(y),y.style.width="100%",y.style.height="25em"}showLoading(){var t=this;return(0,j.A)(function*(){yield(yield t.loadingCtrl.create({})).present()})()}hideLoading(){var t=this;return(0,j.A)(function*(){yield t.loadingCtrl.dismiss()})()}showAlert(t,r){var u=this;return(0,j.A)(function*(){const l=yield u.alertCtrl.create({header:r,message:t,buttons:["OK"]});return yield l.present(),yield l.onDidDismiss(),!0})()}}return(e=n).\u0275fac=function(t){return new(t||e)(o.rXU(v.Ix),o.rXU(v.nX),o.rXU(J),o.rXU(g.Xi),o.rXU(g.hG))},e.\u0275cmp=o.VBU({type:e,selectors:[["app-load-test"]],decls:36,vars:11,consts:[[3,"title"],[3,"fullscreen"],[1,"lg:m-10","md:m-10"],["size","12","size-md","8","size-lg","8",1,""],["label","Target","placeholder","Enter a target","type","text","labelPlacement","stacked",1,"",3,"ngModelChange","ngModel"],["size","12","size-md","12","size-lg","12",1,"flex","flex-row","justify-end"],["color","primary","size","small",1,"",3,"click"],["name","add"],[1,"w-full","p-6","flex","flex-col","justify-center","items-center"],[1,"text-3xl"],[1,"text-2xl","text-white"],[1,"h-[25em]","w-full"],["id","httpCodesChart","echarts","",1,"demo-chart","h-full","w-full",3,"options"],["id","httpResponseTimeChart","echarts","",1,"demo-chart","h-full","w-full",3,"options"]],template:function(t,r){1&t&&(o.nrm(0,"app-header-return",0),o.j41(1,"ion-content",1)(2,"ion-grid"),o.nrm(3,"app-title",0),o.j41(4,"ion-row",2)(5,"ion-col",3)(6,"ion-input",4),o.mxI("ngModelChange",function(l){return o.DH7(r.target,l)||(r.target=l),l}),o.k0s()()(),o.j41(7,"ion-row",2)(8,"ion-col",5)(9,"ion-button",6),o.bIt("click",function(){return r.sendRequest()}),o.EFF(10,"Load Target "),o.nrm(11,"ion-icon",7),o.k0s()()(),o.nrm(12,"app-title",0),o.j41(13,"ion-row",2)(14,"ion-card",8)(15,"ion-card-header")(16,"ion-card-title",9),o.EFF(17,"Total Number of Requests"),o.k0s()(),o.j41(18,"ion-card-content")(19,"h1",10),o.EFF(20),o.nI1(21,"number"),o.k0s()()()(),o.j41(22,"ion-row",2)(23,"ion-card",8)(24,"ion-card-header")(25,"ion-card-title",9),o.EFF(26,"HTTP Status Codes"),o.k0s()(),o.j41(27,"ion-card-content",11),o.nrm(28,"div",12),o.k0s()()(),o.j41(29,"ion-row",2)(30,"ion-card",8)(31,"ion-card-header")(32,"ion-card-title",9),o.EFF(33,"HTTP Response Time"),o.k0s()(),o.j41(34,"ion-card-content",11),o.nrm(35,"div",13),o.k0s()()()()()),2&t&&(o.Y8G("title","Load Test  For "+r.productStep),o.R7$(),o.Y8G("fullscreen",!0),o.R7$(2),o.Y8G("title","New Load Test"),o.R7$(3),o.R50("ngModel",r.target),o.R7$(6),o.Y8G("title","Analytics For "+r.productStep),o.R7$(8),o.JRh(o.i5U(21,8,r.totalNumberOfRequests,"1.0-0")),o.R7$(8),o.Y8G("options",r.statusCodesOptions),o.R7$(7),o.Y8G("options",r.responseTimeOptions))},dependencies:[M.BC,M.vS,g.Jm,g.b_,g.I9,g.ME,g.tN,g.hU,g.W9,g.lO,g.iq,g.$w,g.ln,g.Gw,z.W,K.p,X.$P,T.QX]}),n})()}];let V=(()=>{var e;class n{}return(e=n).\u0275fac=function(t){return new(t||e)},e.\u0275mod=o.$C({type:e}),e.\u0275inj=o.G2t({imports:[v.iI.forChild(Y),v.iI]}),n})();var Q=h(5553);let q=(()=>{var e;class n{}return(e=n).\u0275fac=function(t){return new(t||e)},e.\u0275mod=o.$C({type:e}),e.\u0275inj=o.G2t({imports:[T.MD,M.YN,g.bv,V,Q.h]}),n})()}}]);