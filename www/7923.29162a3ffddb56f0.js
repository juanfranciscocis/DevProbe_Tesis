"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[7923],{5553:(M,_,i)=>{i.d(_,{h:()=>p});var g=i(177),f=i(7863),d=i(4438);let p=(()=>{var c;class e{}return(c=e).\u0275fac=function(h){return new(h||c)},c.\u0275mod=d.$C({type:c}),c.\u0275inj=d.G2t({imports:[g.MD,f.bv]}),e})()},3241:(M,_,i)=>{i.d(_,{p:()=>p});var g=i(4438),f=i(177),d=i(7863);let p=(()=>{var c;class e{constructor(h){this.location=h,this.title="Header Title"}ngOnInit(){}goBack(){this.location.back()}}return(c=e).\u0275fac=function(h){return new(h||c)(g.rXU(f.aZ))},c.\u0275cmp=g.VBU({type:c,selectors:[["app-header-return"]],inputs:{title:"title"},decls:6,vars:2,consts:[[3,"translucent"],["slot","start","menu","menu-id"],["name","arrow-back","slot","start",1,"p-4","bigger-icon",3,"click"]],template:function(h,x){1&h&&(g.j41(0,"ion-header",0)(1,"ion-toolbar"),g.nrm(2,"ion-menu-button",1),g.j41(3,"ion-icon",2),g.bIt("click",function(){return x.goBack()}),g.k0s(),g.j41(4,"ion-title"),g.EFF(5),g.k0s()()()),2&h&&(g.Y8G("translucent",!0),g.R7$(5),g.JRh(x.title))},dependencies:[d.eU,d.iq,d.MC,d.BC,d.ai],styles:[".bigger-icon[_ngcontent-%COMP%]{font-size:1.5em}"]}),e})()},7923:(M,_,i)=>{i.r(_),i.d(_,{GraphPageModule:()=>O});var g=i(177),f=i(4341),d=i(7863),p=i(4848),c=i(467),e=i(4438),y=i(9032),h=i(9640),x=i(2820),C=i(3241),b=i(2814);const j=["messagesContainer"];function G(s,m){if(1&s){const l=e.RV6();e.j41(0,"ion-col",27)(1,"div",28)(2,"ion-avatar",29)(3,"ion-icon",30),e.bIt("click",function(){const n=e.eBV(l).$implicit,o=e.XpG();return e.Njj(o.toggleAiModal(n,!0))}),e.k0s()(),e.nrm(4,"div",25),e.j41(5,"ion-avatar",31)(6,"ion-icon",32),e.bIt("click",function(){const n=e.eBV(l).$implicit,o=e.XpG();return e.Njj(o.toggleAiModal(n))}),e.k0s()()(),e.j41(7,"ion-card",33)(8,"h1",34),e.EFF(9),e.k0s(),e.nrm(10,"br")(11,"div",35),e.k0s()()}if(2&s){const l=m.$implicit,t=e.XpG();e.R7$(2),e.Mz_("id","hover-trigger-",l,"-danger"),e.R7$(3),e.Mz_("id","hover-trigger-",l,""),e.R7$(4),e.JRh(l),e.R7$(2),e.Y8G("options",t.countryOptions[l])}}function P(s,m){if(1&s&&(e.j41(0,"div",39)(1,"markdown",40),e.EFF(2),e.k0s()()),2&s){const l=e.XpG().$implicit;e.R7$(2),e.JRh(l.message)}}function w(s,m){if(1&s&&(e.j41(0,"div",41)(1,"markdown",42),e.EFF(2),e.k0s()()),2&s){const l=e.XpG().$implicit;e.R7$(),e.Mz_("id","mk-",l.id,""),e.R7$(),e.JRh(l.message)}}function R(s,m){if(1&s&&(e.j41(0,"div",36),e.DNE(1,P,3,1,"div",37)(2,w,3,3,"div",38),e.k0s()),2&s){const l=m.$implicit;e.R7$(),e.Y8G("ngIf","User"===l.from),e.R7$(),e.Y8G("ngIf","AI"===l.from)}}const k=[{path:"",component:(()=>{var s;class m{constructor(t,n,o){this.ripeService=t,this.route=n,this.loadingCtrl=o,this.orgName="",this.productObjective="",this.user={},this.data=[],this.countries=[],this.countryOptions={},this.aiModal=!1,this.message="",this.vertexAI=(0,e.WQX)(y.L9),this.model=(0,y.oc)(this.vertexAI,{model:"gemini-1.5-flash"}),this.chat=this.model.startChat({history:[{role:"user",parts:[{text:"Hola, desde ahora en adelante quiero que seas un modelo experto en Software Quality Assurance y analista de datos, tu nombre es DevProbeAI, nunca lo puedes olvidar"}]},{role:"model",parts:[{text:"Soy un modelo experto en Software Quality Assurance, de igual forma tengo un masterado en anla\xedtica de datos \xbfEn qu\xe9 puedo ayudarte?"}]},{role:"user",parts:[{text:"Gracias, te voy a entregar un json con datos en unos minutos, necesito que lo analices y me des un resumen de los datos, este json contiene datos de varios pings por un pais especifico, imagina que ,tu analisis tiene que ser detallado, si encuentras inconsistencias en los datos, por favor mencionalas, en caso de que creas que puede haber un error de latencias por favor mencionalo, si encuentras algo interesante, por favor mencionalo, en resumen, necesito un analisis detallado de los datos"}]},{role:"model",parts:[{text:"Claro, env\xedame el json y yo me encargo de analizarlo"}]}]}),this.messages=[]}ionViewWillEnter(){var t=this;return(0,c.A)(function*(){t.route.queryParams.subscribe(o=>{t.productObjective=o.product});const n=localStorage.getItem("user");n&&(t.user=JSON.parse(n),t.orgName=t.user.orgName,t.data=[],yield t.getResultsHistoryforLatency(),yield t.groupByDate(),yield t.groupByCountry(),yield t.populateCountries(),t.generateCountryOptions())})()}getResultsHistoryforLatency(){var t=this;return(0,c.A)(function*(){(yield t.ripeService.getHistoryResults(t.orgName,t.productObjective)).forEach(o=>{const[r,a,u,v,L,D]=o.id.split("-");t.data.push({id:a,data:o.data.data,date:`${v}/${u}/${L}`,time:D})})})()}groupByDate(){var t=this;return(0,c.A)(function*(){let n={};for(let a=0;a<t.data.length;a++){let u=t.data[a].date;n[u]||(n[u]=[]),n[u].push(...t.data[a].data)}const o=Object.keys(n).sort((a,u)=>new Date(a).getTime()-new Date(u).getTime());let r={};for(let a of o)r[a]=n[a];t.data=r,console.log(t.data)})()}groupByCountry(){var t=this;return(0,c.A)(function*(){let n={};for(let o in t.data){let r=t.data[o];n[o]||(n[o]={});for(let a=0;a<r.length;a++){let u=r[a].countryFrom;n[o][u]||(n[o][u]=[]),n[o][u].push(r[a])}}t.data=n,console.log(t.data)})()}populateCountries(){var t=this;return(0,c.A)(function*(){const n=new Set;for(let o in t.data)for(let r in t.data[o])n.add(r);t.countries=Array.from(n),console.log(t.countries)})()}generateRandomColor(){let n="#";for(let o=0;o<6;o++)n+="0123456789ABCDEF"[Math.floor(16*Math.random())];return n}generateCountryOptions(){for(let t of this.countries){const n=[],o=[];for(let r in this.data){let a=0,u=0;if(this.data[r][t]){for(let v=0;v<this.data[r][t].length;v++)a+=this.data[r][t][v].latency,u++;u>0&&(n.push(r),o.push(a/u))}}o.length>0&&(this.countryOptions[t]={legend:{data:[t],align:"left",backgroundColor:"rgba(255, 255, 255, 0.9)"},tooltip:{},xAxis:{data:n,silent:!1,splitLine:{show:!1}},yAxis:{},series:[{name:t,type:"bar",data:o,itemStyle:{color:this.generateRandomColor()},animationDelay:r=>10*r}],animationEasing:"elasticOut",animationDelayUpdate:r=>5*r})}}refresh(){window.location.reload()}ngOnInit(){}toggleAiModal(t,n){var o=this;return(0,c.A)(function*(){if(o.aiModal=!o.aiModal,t){console.log("Country: "+t);const r=o.countryOptions[t].series[0].data,a=o.countryOptions[t].xAxis.data;console.log(r),console.log(a);const u={country:t,data:{date:a,data:r}};yield o.sendMessage(u).then(()=>{o.chatStyle()})}})()}ngAfterViewChecked(){this.scrollToBottom()}scrollToBottom(){if(this.messagesContainer)try{this.messagesContainer.nativeElement.scrollTop=this.messagesContainer.nativeElement.scrollHeight}catch(t){console.error("Error al hacer scroll:",t)}}sendMessage(t){var n=this;return(0,c.A)(function*(){if(t){yield n.showLoading(),console.log("Country data:",t);const a=JSON.stringify(t),u=yield n.chat.sendMessage(a),v=n.messages.length;return n.messages.push({message:u.response.text(),from:"AI",id:v.toString()}),console.log("Message:",n.message),n.message="",void(yield n.hideLoading())}if(""===n.message)return void console.log("Message is empty");let o=n.messages.length;n.messages.push({message:n.message,from:"User",id:o.toString()});const r=yield n.chat.sendMessage(n.message);o=n.messages.length,n.messages.push({message:r.response.text(),from:"AI",id:o.toString()}),n.message=""})()}chatStyle(){const n=document.getElementById("mk-"+(this.messages.length-1));if(console.log(n),!n)return;let o=n.getElementsByTagName("h1"),r=n.getElementsByTagName("h2");for(var a=0;a<o.length;a++)o[a].style.fontSize="2.5em",o[a].style.fontWeight="bold";for(a=0;a<r.length;a++)r[a].style.fontSize="2em",r[a].style.fontWeight="bold"}showLoading(){var t=this;return(0,c.A)(function*(){yield(yield t.loadingCtrl.create({})).present()})()}hideLoading(){var t=this;return(0,c.A)(function*(){yield t.loadingCtrl.dismiss()})()}}return(s=m).\u0275fac=function(t){return new(t||s)(e.rXU(h.Q),e.rXU(p.nX),e.rXU(d.Xi))},s.\u0275cmp=e.VBU({type:s,selectors:[["app-graph"]],viewQuery:function(t,n){if(1&t&&e.GBs(j,5),2&t){let o;e.mGM(o=e.lsd())&&(n.messagesContainer=o.first)}},decls:32,vars:7,consts:[["messagesContainer",""],[3,"title"],[3,"fullscreen"],[1,"lg:m-10"],["size","6","size-md","6","size-lg","6"],[1,"text-4xl","lg:text-6xl","font-bold"],["size","6","size-md","6","size-lg","6",1,"text-right"],["name","refresh",1,"text-4xl","lg:text-6xl","font-bold","onreloadhover",3,"click"],[1,"lg:m-10","md:m-10"],["size","12","size-md","6","size-lg","6","class","flex flex-row justify-center relative",4,"ngFor","ngForOf"],["vertical","bottom","horizontal","end","slot","fixed",1,"m-2","z-10",3,"click"],[1,"bg-purple-300","p-4"],["name","chatbubble-outline",1,"w-full","h-full"],["id","ai-modal",1,"fixed","bottom-0","right-0","h-full","w-full","bg-black","bg-opacity-60","z-10","r"],[1,"h-full","md:h-3/4","lg:h-3/4","w-full","bg-gray-900","p-4","absolute","right-0","bottom-0","z-50","flex","flex-col","rounded-tl-2xl","rounded-tr-2xl"],[1,"w-full","bg-gray-500","flex","flex-row","justify-center","items-center","p-2","mb-2","rounded-3xl"],[1,"flex","flex-row","p-2","items-center","bg-gray-800","w-full","rounded-3xl","h-full"],[1,"text-white"],[1,"m-2"],[1,"flex","flex-row","justify-center","items-center","bg-gray-800","hover:bg-gray-600","w-1/6","h-full","rounded-3xl",3,"click"],["name","close-outline"],[1,"flex-grow","overflow-y-auto","bg-gray-400","p-2","rounded-3xl"],["class","flex flex-col",4,"ngFor","ngForOf"],[1,"flex","flex-row","mt-2","p-2"],["placeholder","Ask...",1,"flex-grow","bg-gray-700","rounded-2xl",3,"ngModelChange","ngModel"],[1,"m-1"],[1,"w-1/3","bg-gray-500","rounded-3xl","flex","flex-row","justify-center","items-center","hover:bg-gray-300",3,"click"],["size","12","size-md","6","size-lg","6",1,"flex","flex-row","justify-center","relative"],[1,"absolute","z-10","w-full","flex","flex-row","justify-end"],[1,"h-12","w-12","bg-red-600","p-2",3,"id"],["name","warning-outline",1,"w-full","h-full",3,"click"],[1,"h-12","w-12","bg-purple-400","p-2",3,"id"],["name","color-wand-outline",1,"w-full","h-full",3,"click"],[1,"w-full","h-96","p-6","flex","flex-col","justify-center","items-center"],[1,"text-6xl","font-bold","text-white"],["echarts","",1,"demo-chart","h-full","w-full",3,"options"],[1,"flex","flex-col"],["class","rounded-3xl bg-gray-800 w-2/3 m-1 ml-auto p-2",4,"ngIf"],["class","rounded-3xl bg-gray-500 w-2/3 m-1 p-2 pr-2",4,"ngIf"],[1,"rounded-3xl","bg-gray-800","w-2/3","m-1","ml-auto","p-2"],[1,"text-white","p-4","m-2"],[1,"rounded-3xl","bg-gray-500","w-2/3","m-1","p-2","pr-2"],[1,"text-white","p-4","m-2",3,"id"]],template:function(t,n){if(1&t){const o=e.RV6();e.nrm(0,"app-header-return",1),e.j41(1,"ion-content",2)(2,"ion-grid")(3,"ion-row",3)(4,"ion-col",4)(5,"h1",5),e.EFF(6,"Latency Graph"),e.k0s()(),e.j41(7,"ion-col",6)(8,"ion-icon",7),e.bIt("click",function(){return e.eBV(o),e.Njj(n.refresh())}),e.k0s()()(),e.j41(9,"ion-row",8),e.DNE(10,G,12,6,"ion-col",9),e.k0s()(),e.j41(11,"ion-fab",10),e.bIt("click",function(){return e.eBV(o),e.Njj(n.toggleAiModal())}),e.j41(12,"ion-avatar",11),e.nrm(13,"ion-icon",12),e.k0s()()(),e.j41(14,"div",13)(15,"div",14)(16,"div",15)(17,"div",16)(18,"h1",17),e.EFF(19,"DevProbe AI"),e.k0s()(),e.nrm(20,"div",18),e.j41(21,"div",19),e.bIt("click",function(){return e.eBV(o),e.Njj(n.toggleAiModal())}),e.nrm(22,"ion-icon",20),e.k0s()(),e.j41(23,"div",21,0),e.DNE(25,R,3,2,"div",22),e.k0s(),e.j41(26,"div",23)(27,"ion-textarea",24),e.mxI("ngModelChange",function(a){return e.eBV(o),e.DH7(n.message,a)||(n.message=a),e.Njj(a)}),e.k0s(),e.nrm(28,"div",25),e.j41(29,"div",26),e.bIt("click",function(){return e.eBV(o),e.Njj(n.sendMessage())}),e.j41(30,"span",17),e.EFF(31,"Send"),e.k0s()()()()()}2&t&&(e.Y8G("title","Latency Graph"),e.R7$(),e.Y8G("fullscreen",!0),e.R7$(9),e.Y8G("ngForOf",n.countries),e.R7$(4),e.AVh("hidden",!n.aiModal),e.R7$(11),e.Y8G("ngForOf",n.messages),e.R7$(2),e.R50("ngModel",n.message))},dependencies:[g.Sq,g.bT,f.BC,f.vS,d.mC,d.b_,d.hU,d.W9,d.Q8,d.lO,d.iq,d.ln,d.nc,d.Gw,x.$P,C.p,b.NN],styles:["@keyframes _ngcontent-%COMP%_rotate90deg{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.onreloadhover[_ngcontent-%COMP%]:hover{animation:_ngcontent-%COMP%_rotate90deg .9s linear infinite}"]}),m})()}];let A=(()=>{var s;class m{}return(s=m).\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.$C({type:s}),s.\u0275inj=e.G2t({imports:[p.iI.forChild(k),p.iI]}),m})();var E=i(5553);let O=(()=>{var s;class m{}return(s=m).\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.$C({type:s}),s.\u0275inj=e.G2t({imports:[g.MD,f.YN,d.bv,A,E.h,b.NN]}),m})()}}]);