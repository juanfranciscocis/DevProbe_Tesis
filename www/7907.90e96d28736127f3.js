"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[7907],{5553:(R,f,r)=>{r.d(f,{h:()=>m});var i=r(177),C=r(7863),s=r(4438);let m=(()=>{var l;class e{}return(l=e).\u0275fac=function(d){return new(d||l)},l.\u0275mod=s.$C({type:l}),l.\u0275inj=s.G2t({imports:[i.MD,C.bv]}),e})()},3241:(R,f,r)=>{r.d(f,{p:()=>m});var i=r(4438),C=r(177),s=r(7863);let m=(()=>{var l;class e{constructor(d){this.location=d,this.title="Header Title"}ngOnInit(){}goBack(){this.location.back()}}return(l=e).\u0275fac=function(d){return new(d||l)(i.rXU(C.aZ))},l.\u0275cmp=i.VBU({type:l,selectors:[["app-header-return"]],inputs:{title:"title"},decls:6,vars:2,consts:[[3,"translucent"],["slot","start","menu","menu-id"],["name","arrow-back","slot","start",1,"p-4","bigger-icon",3,"click"]],template:function(d,O){1&d&&(i.j41(0,"ion-header",0)(1,"ion-toolbar"),i.nrm(2,"ion-menu-button",1),i.j41(3,"ion-icon",2),i.bIt("click",function(){return O.goBack()}),i.k0s(),i.j41(4,"ion-title"),i.EFF(5),i.k0s()()()),2&d&&(i.Y8G("translucent",!0),i.R7$(5),i.JRh(O.title))},dependencies:[s.eU,s.iq,s.MC,s.BC,s.ai],styles:[".bigger-icon[_ngcontent-%COMP%]{font-size:1.5em}"]}),e})()},7907:(R,f,r)=>{r.r(f),r.d(f,{GraphTracePageModule:()=>x});var i=r(177),C=r(4341),s=r(7863),m=r(305),l=r(467),e=r(4438),y=r(2588),d=r(3241),O=r(4688);function G(a,h){if(1&a&&(e.j41(0,"ion-col",9)(1,"ion-card",10)(2,"ion-card-title",11)(3,"h1",12),e.EFF(4),e.k0s()(),e.nrm(5,"br")(6,"div",13),e.k0s()()),2&a){const g=h.$implicit,t=e.XpG();e.R7$(4),e.JRh(g),e.R7$(2),e.Y8G("options",t.countryOptions[g])}}const _=[{path:"",component:(()=>{var a;class h{constructor(t,o){this.ripeService=t,this.route=o,this.orgName="",this.productObjective="",this.user={},this.data=[],this.countries=[],this.countryOptions={}}ionViewWillEnter(){var t=this;return(0,l.A)(function*(){t.route.queryParams.subscribe(n=>{t.productObjective=n.product});const o=localStorage.getItem("user");o&&(t.user=JSON.parse(o),t.orgName=t.user.orgName,t.data=[],t.getResultsHistoryforRtt().then(()=>{t.groupByDate().then(()=>{t.groupByCountry().then(()=>{t.populateCountries(),t.generateCountryOptions()})})}))})()}getResultsHistoryforRtt(){var t=this;return(0,l.A)(function*(){yield t.ripeService.getHistoryResults(t.orgName,t.productObjective).then(o=>{for(let n=0;n<o.length;n++){let c=o[n].id.split("-");t.data.push({id:c[1],date:c[3]+"/"+c[2]+"/"+c[4],time:c[5],data:o[n].data.data})}console.log(t.data)})})()}groupByDate(){var t=this;return(0,l.A)(function*(){let o={};for(let n=0;n<t.data.length;n++){let c=t.data[n].date;o[c]||(o[c]=[]),o[c].push(...t.data[n].data)}t.data=o,console.log(t.data)})()}groupByCountry(){var t=this;return(0,l.A)(function*(){let o={};for(let n in t.data){let c=t.data[n];o[n]||(o[n]={});for(let u=0;u<c.length;u++){let p=c[u].src_country;"No country found"!==p&&(o[n][p]||(o[n][p]=[]),o[n][p].push(c[u]))}}t.data=o,console.log(t.data)})()}populateCountries(){var t=this;return(0,l.A)(function*(){const o=new Set;for(let n in t.data)for(let c in t.data[n])o.add(c);t.countries=Array.from(o),console.log(t.countries)})()}getRandomColor(){let o="#";for(let n=0;n<6;n++)o+="0123456789ABCDEF"[Math.floor(16*Math.random())];return o}generateCountryOptions(){for(let t of this.countries){const o=[],n=[];for(let u in this.data){let p=0,P=0;if(this.data[u][t]){for(let M=0;M<this.data[u][t].length;M++){let T=this.data[u][t][M];for(let v=0;v<T.result.length;v++)"number"==typeof T.result[v].result[0].rtt&&(p+=T.result[v].result[0].rtt,P++)}P>0&&(o.push(u),n.push(p/P))}}const c=this.getRandomColor();this.countryOptions[t]={legend:{data:[t],align:"left",backgroundColor:"rgba(255, 255, 255, 0.9)"},tooltip:{},xAxis:{data:o,silent:!1,splitLine:{show:!1}},yAxis:{},series:[{name:t,type:"bar",data:n,itemStyle:{color:c},animationDelay:u=>10*u}],animationEasing:"elasticOut",animationDelayUpdate:u=>5*u}}}refresh(){window.location.reload()}ngOnInit(){}}return(a=h).\u0275fac=function(t){return new(t||a)(e.rXU(y.N),e.rXU(m.nX))},a.\u0275cmp=e.VBU({type:a,selectors:[["app-graph-trace"]],decls:11,vars:3,consts:[[3,"title"],[3,"fullscreen"],[1,"lg:m-10"],["size","6","size-md","6","size-lg","6"],[1,"text-4xl","lg:text-6xl","font-bold"],["size","6","size-md","6","size-lg","6",1,"text-right"],["name","refresh",1,"text-4xl","lg:text-6xl","font-bold","onreloadhover",3,"click"],[1,"lg:m-10","md:m-10"],["size","12","size-md","6","size-lg","6","class","flex flex-row justify-center",4,"ngFor","ngForOf"],["size","12","size-md","6","size-lg","6",1,"flex","flex-row","justify-center"],[1,"w-full","h-96","p-6","flex","flex-col","justify-center","items-center"],[1,""],[1,"text-6xl","font-bold","text-white"],["echarts","",1,"demo-chart","h-full","w-full","min-w-full",3,"options"]],template:function(t,o){1&t&&(e.nrm(0,"app-header-return",0),e.j41(1,"ion-content",1)(2,"ion-grid")(3,"ion-row",2)(4,"ion-col",3)(5,"h1",4),e.EFF(6,"Traceroute Graph"),e.k0s()(),e.j41(7,"ion-col",5)(8,"ion-icon",6),e.bIt("click",function(){return o.refresh()}),e.k0s()()(),e.j41(9,"ion-row",7),e.DNE(10,G,7,2,"ion-col",8),e.k0s()()()),2&t&&(e.Y8G("title","Traceroute Graph"),e.R7$(),e.Y8G("fullscreen",!0),e.R7$(9),e.Y8G("ngForOf",o.countries))},dependencies:[i.Sq,s.b_,s.tN,s.hU,s.W9,s.lO,s.iq,s.ln,d.p,O.$P],styles:["@keyframes _ngcontent-%COMP%_rotate90deg{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.onreloadhover[_ngcontent-%COMP%]:hover{animation:_ngcontent-%COMP%_rotate90deg .9s linear infinite}"]}),h})()}];let E=(()=>{var a;class h{}return(a=h).\u0275fac=function(t){return new(t||a)},a.\u0275mod=e.$C({type:a}),a.\u0275inj=e.G2t({imports:[m.iI.forChild(_),m.iI]}),h})();var D=r(5553);let x=(()=>{var a;class h{}return(a=h).\u0275fac=function(t){return new(t||a)},a.\u0275mod=e.$C({type:a}),a.\u0275inj=e.G2t({imports:[i.MD,C.YN,s.bv,E,D.h]}),h})()}}]);