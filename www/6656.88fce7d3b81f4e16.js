"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[6656],{6656:(E,m,r)=>{r.r(m),r.d(m,{LatencyResultsPageModule:()=>S});var p=r(177),f=r(4341),o=r(7863),h=r(305),d=r(467),e=r(4438),R=r(9640),v=r(1681),L=r(8453),F=r(3241);function j(i,c){if(1&i&&(e.j41(0,"ion-item")(1,"ion-label"),e.EFF(2),e.k0s(),e.j41(3,"ion-label"),e.EFF(4),e.k0s(),e.j41(5,"ion-label"),e.EFF(6),e.k0s()()),2&i){const a=c.$implicit;e.R7$(2),e.Lme("",a.cityFrom,",",a.countryFrom,""),e.R7$(2),e.SpI("",a.latency," ms"),e.R7$(2),e.Lme(" ",a.cityTo,",",a.countryTo,"")}}const P=[{path:"",component:(()=>{var i;class c{constructor(t,s,n,l,u,g){this.route=t,this.ripeService=s,this.router=n,this.loadingCtrl=l,this.locationService=u,this.alertCtrl=g,this.description="",this.orgName="",this.productObjective="",this.user={},this.ripeResults=[],this.testID=""}ngOnInit(){this.route.queryParams.subscribe(n=>{console.log(n),this.description=n.description,this.productObjective=n.productObjective});const t=localStorage.getItem("user");if(!t)return;const s=JSON.parse(t);this.orgName=s.orgName,this.ripeService.getAllResults(this.orgName,this.productObjective,this.description).then(n=>{for(let l=0;l<n.data.length;l++)this.ripeResults.push(n.data[l]);this.testID=n.data[0].id,console.log(this.ripeResults),console.log(this.testID)})}goToMap(){this.router.navigate(["/show-map"],{queryParams:{description:this.description,productObjective:this.productObjective,orgName:this.orgName}})}getMoreResults(){var t=this;return(0,d.A)(function*(){yield t.showLoading(),t.ripeResults=[];try{let s=yield t.ripeService.getMeasurementResults(t.testID);if(!s)return yield t.hideLoading(),void(yield t.showAlert("Please send a test first","Error"));s.subscribe(function(){var n=(0,d.A)(function*(l){if(0===l.length)return yield t.hideLoading(),void(yield t.showAlert("No data found yet","Please wait a few minutes and try again"));for(let u=0;u<l.length;u++)t.ripeResults.push({latency:l[u].avg,dst_addr:l[u].dst_addr,from:l[u].from,toLatitude:0,toLongitude:0,fromLatitude:0,fromLongitude:0,cityTo:"",countryTo:"",cityFrom:"",countryFrom:"",id:t.ripeService.measurementID});yield t.ripeService.saveMeasurementResults(t.orgName,t.productObjective,t.description,t.ripeResults).then((0,d.A)(function*(){yield t.locationService.getLocation(t.ripeResults).then(u=>{t.ripeResults=u,t.locationService.saveLocationResults(t.orgName,t.productObjective,t.description,u).then(function(){var g=(0,d.A)(function*(y){y&&(yield t.hideLoading(),yield t.showAlert("Data saved and Showing Results","Success"))});return function(y){return g.apply(this,arguments)}}())})}))});return function(l){return n.apply(this,arguments)}}())}catch{yield t.hideLoading(),yield t.showAlert("Error getting results","Error")}})()}showLoading(){var t=this;return(0,d.A)(function*(){yield(yield t.loadingCtrl.create({})).present()})()}hideLoading(){var t=this;return(0,d.A)(function*(){yield t.loadingCtrl.dismiss()})()}showAlert(t,s){var n=this;return(0,d.A)(function*(){yield(yield n.alertCtrl.create({header:s,message:t,buttons:["OK"]})).present()})()}}return(i=c).\u0275fac=function(t){return new(t||i)(e.rXU(h.nX),e.rXU(R.Q),e.rXU(h.Ix),e.rXU(o.Xi),e.rXU(v.N),e.rXU(o.hG))},i.\u0275cmp=e.VBU({type:i,selectors:[["app-latency-results"]],inputs:{description:"description"},decls:33,vars:6,consts:[[3,"title"],[3,"fullscreen"],[1,"text-xs","m-2","lg:m-10","lg:text-2xl","md:text-2xl","md:m-10"],[1,"lg:m-10","md:m-10"],["size","4","size-md","4","size-lg","4",1,"flex","flex-row","justify-center"],[1,"text-2xl"],["size","12","size-md","12","size-lg","12"],[4,"ngFor","ngForOf"],[3,"translucent"],["size","4"],["size","8",1,"flex","flex-row","justify-end"],["size","small","color","light",3,"click"],["name","refresh",1,"m-2"],["size","small","color","primary",3,"click"],["name","arrow-forward",1,"m-2"]],template:function(t,s){1&t&&(e.nrm(0,"app-header-return",0),e.j41(1,"ion-content",1)(2,"ion-grid"),e.nrm(3,"app-title",0),e.j41(4,"h2",2),e.EFF(5),e.k0s(),e.nrm(6,"br"),e.j41(7,"ion-row",3)(8,"ion-col",4)(9,"h1",5),e.EFF(10,"FROM"),e.k0s()(),e.j41(11,"ion-col",4)(12,"h1",5),e.EFF(13,"LATENCY"),e.k0s()(),e.j41(14,"ion-col",4)(15,"h1",5),e.EFF(16,"TO"),e.k0s()()(),e.j41(17,"ion-row",3)(18,"ion-col",6)(19,"ion-list"),e.DNE(20,j,7,5,"ion-item",7),e.k0s()()()()(),e.j41(21,"ion-footer",8)(22,"ion-toolbar")(23,"ion-grid")(24,"ion-row"),e.nrm(25,"ion-col",9),e.j41(26,"ion-col",10)(27,"ion-button",11),e.bIt("click",function(){return s.getMoreResults()}),e.EFF(28,"GET MORE RESULTS "),e.nrm(29,"ion-icon",12),e.k0s(),e.j41(30,"ion-button",13),e.bIt("click",function(){return s.goToMap()}),e.EFF(31,"GO TO MAP "),e.nrm(32,"ion-icon",14),e.k0s()()()()()()),2&t&&(e.Y8G("title","Latency Results for "+s.description),e.R7$(),e.Y8G("fullscreen",!0),e.R7$(2),e.Y8G("title","Test Results"),e.R7$(2),e.SpI("Results for ",s.description,""),e.R7$(15),e.Y8G("ngForOf",s.ripeResults),e.R7$(),e.Y8G("translucent",!0))},dependencies:[p.Sq,o.Jm,o.hU,o.W9,o.M0,o.lO,o.iq,o.uz,o.he,o.nf,o.ln,o.ai,L.W,F.p]}),c})()}];let M=(()=>{var i;class c{}return(i=c).\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.$C({type:i}),i.\u0275inj=e.G2t({imports:[h.iI.forChild(P),h.iI]}),c})();var O=r(5553);let S=(()=>{var i;class c{}return(i=c).\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.$C({type:i}),i.\u0275inj=e.G2t({imports:[p.MD,f.YN,o.bv,M,O.h]}),c})()}}]);