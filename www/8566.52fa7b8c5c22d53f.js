"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[8566],{8566:(A,m,a)=>{a.r(m),a.d(m,{ShowMapTracePageModule:()=>F});var T=a(177),y=a(4341),g=a(7863),f=a(7650),s=a(467),v=a(8244),S=a(5841),o=a(4438),P=a(2588),w=a(3241);const L=[{path:"",component:(()=>{var e;class i{constructor(t,r,n){this.ripeTraceService=t,this.loadingCtrl=r,this.route=n,this.ripeData=[],this.orgName="",this.productObjective="",this.description=""}ngOnDestroy(){this.map.remove()}ionViewDidEnter(){var t=this;return(0,s.A)(function*(){yield t.showLoading(),t.route.queryParams.subscribe(function(){var r=(0,s.A)(function*(n){t.description=n.description,t.productObjective=n.productObjective,t.orgName=n.orgName,console.log(t.orgName),console.log(t.productObjective),console.log(t.description),yield t.ripeTraceService.getAllResultsByDescription(t.orgName,t.productObjective,t.description).then(l=>{t.ripeData=l.data,console.log(t.ripeData)}).then(()=>{t.leafletMap()})});return function(n){return r.apply(this,arguments)}}())})()}leafletMap(){var t=this;return(0,s.A)(function*(){t.map=v.map("mapId").setView([0,0],2.5),v.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"edupala.com \xa9 Angular LeafLet",minZoom:2.5,maxZoom:8}).addTo(t.map),setTimeout(()=>{t.map.invalidateSize(),t.addPaths()},1e3)})()}addPaths(){var t=this;return(0,s.A)(function*(){let r=[];for(let n of t.ripeData){let l=[],j=n.result;for(let d of j)try{let u=d.result[0],p=u.from_latitude,h=u.from_longitude;if(0==p&&0==h||null==p||null==h)continue;l.push([p,h])}catch{continue}for(let d of t.ripeData){let u=d.dst_latitude,p=d.dst_longitude,h=d.src_latitude,M=d.src_longitude;0==u&&0==p||(l.push([u,p]),(0!=h||0!=M)&&l.unshift([h,M]))}r.push(l)}console.log(r);for(let n of r){let l="#"+(16777215*Math.random()|0).toString(16);(0,S.antPath)(n,{color:l,weight:5,opacity:.6}).addTo(t.map)}yield t.hideLoading()})()}showLoading(){var t=this;return(0,s.A)(function*(){yield(yield t.loadingCtrl.create({})).present()})()}hideLoading(){var t=this;return(0,s.A)(function*(){yield t.loadingCtrl.dismiss()})()}ngOnInit(){}}return(e=i).\u0275fac=function(t){return new(t||e)(o.rXU(P.N),o.rXU(g.Xi),o.rXU(f.nX))},e.\u0275cmp=o.VBU({type:e,selectors:[["app-show-map-trace"]],decls:3,vars:1,consts:[[3,"title"],[1,"relative"],["id","mapId",2,"width","100%","height","100%"]],template:function(t,r){1&t&&(o.nrm(0,"app-header-return",0),o.j41(1,"ion-content",1),o.nrm(2,"div",2),o.k0s()),2&t&&o.Y8G("title","Show Map")},dependencies:[g.W9,w.p]}),i})()}];let C=(()=>{var e;class i{}return(e=i).\u0275fac=function(t){return new(t||e)},e.\u0275mod=o.$C({type:e}),e.\u0275inj=o.G2t({imports:[f.iI.forChild(L),f.iI]}),i})();var D=a(5553);let F=(()=>{var e;class i{}return(e=i).\u0275fac=function(t){return new(t||e)},e.\u0275mod=o.$C({type:e}),e.\u0275inj=o.G2t({imports:[T.MD,y.YN,g.bv,C,D.h]}),i})()}}]);