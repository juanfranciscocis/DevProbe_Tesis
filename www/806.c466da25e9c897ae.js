"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[806],{806:(O,T,a)=>{a.r(T),a.d(T,{TraceTestPageModule:()=>b});var f=a(177),p=a(4341),c=a(7863),h=a(305),u=a(467),e=a(4438),A=a(1626),I=a(4262);let v=(()=>{var s;class l{constructor(t,r){this.http=t,this.firestore=r,this.measurementsUrl="https://cors-ea3m.onrender.com/https://atlas.ripe.net/api/v2/measurements/",this.measurementID="73614313"}sendTraceRequest(t,r,n,o){var d=this;return(0,u.A)(function*(){try{let m={definitions:[{target:t,description:r,type:n,af:4,is_oneoff:!0,protocol:"TCP"}],probes:[]};console.log(o);let N=o.split(",").length-1,G=(o=o.slice(0,-1)).split(","),y=[];for(let g=0;g<N;g++)y.push({requested:5,type:"country",value:G[g]});m.probes=y,console.log(m);let z={Authorization:"Key 92530695-134f-4cbc-b7c3-ec130f3719b0"};console.log(m);let R=yield d.http.post(d.measurementsUrl,m,{headers:z}).toPromise();return console.log(R),d.measurementID=R.measurements[0],!0}catch(m){return console.log(m),!1}})()}getTraceResults(t){var r=this;return(0,u.A)(function*(){t&&(r.measurementID=t);try{let n;return""===r.measurementID?(console.log("No measurement ID"),!1):r.http.get(r.measurementsUrl+r.measurementID+"/results/",{headers:n}).toPromise()}catch(n){return console.log(n),!1}})()}}return(s=l).\u0275fac=function(t){return new(t||s)(e.KVO(A.Qq),e.KVO(I._7))},s.\u0275prov=e.jDH({token:s,factory:s.\u0275fac,providedIn:"root"}),l})();var F=a(8453),S=a(3241);function C(s,l){if(1&s){const i=e.RV6();e.j41(0,"ion-chip",18),e.bIt("click",function(){const r=e.eBV(i).$implicit,n=e.XpG();return e.Njj(n.selectCountry(r))}),e.EFF(1),e.k0s()}if(2&s){const i=l.$implicit,t=e.XpG();e.Y8G("color",t.isCountrySelected(i)?"primary":""),e.R7$(),e.SpI(" ",i," ")}}function P(s,l){if(1&s&&(e.j41(0,"ion-item")(1,"ion-label"),e.EFF(2),e.k0s(),e.j41(3,"ion-label"),e.EFF(4),e.k0s(),e.j41(5,"ion-label"),e.EFF(6),e.k0s()()),2&s){const i=l.$implicit;e.R7$(2),e.Lme("FROM ",i.cityFrom,",",i.countryFrom,""),e.R7$(2),e.SpI("",i.latency," ms"),e.R7$(2),e.Lme(" TO ",i.cityTo,",",i.countryTo,"")}}function j(s,l){if(1&s&&(e.j41(0,"ion-item")(1,"ion-label"),e.EFF(2),e.k0s(),e.nrm(3,"ion-icon",19),e.k0s()),2&s){const i=l.$implicit;e.R7$(2),e.JRh(i)}}const D=[{path:"",component:(()=>{var s;class l{constructor(t,r,n,o){this.ripeTraceService=t,this.route=r,this.loadingCtrl=n,this.alertCtrl=o,this.user={},this.orgName="",this.productObjective="",this.productStep="",this.host="portfoliojuanfranciscocisneros.web.app",this.description="NEW IONIC",this.type="traceroute",this.countries={names:["BRAZIL","AUSTRALIA","USA","RUSSIA","UK","GERMANY","ITALY","SPAIN","FRANCE","JAPAN","ARGENTINA","SOUTH_AFRICA","SAUDI_ARABIA","GUATEMALA","THAILAND","INDIA"],probeIDs:["BR","AU","US","RU","GB","GE","IT","ES","FR","JP","AR","ZA","SA","GT","TH","IN"]},this.selectedCountries=[],this.ripeResults=[],this.ripeHistoryResultsID=[]}ngOnInit(){}ionViewWillEnter(){var t=this;return(0,u.A)(function*(){yield t.showLoading(),t.route.params.subscribe(n=>{t.productObjective=n.productObjective,t.productStep=n.step;const o=new Date,d=o.getDate()+"-"+(o.getMonth()+1)+"-"+o.getFullYear()+"-"+o.getHours()+":"+o.getMinutes()+":"+o.getSeconds();t.description=n.productObjective+"-"+n.step+"-"+d});const r=localStorage.getItem("user");r&&(t.user=JSON.parse(r),t.orgName=t.user.orgName,yield t.hideLoading())})()}sendTraceRequest(){var t=this;return(0,u.A)(function*(){yield t.showLoading(),yield t.ripeTraceService.sendTraceRequest(t.host,t.description,t.type,t.selectedCountries.join(",")+",").then(function(){var r=(0,u.A)(function*(n){n?(yield t.hideLoading(),yield t.showAlert("Trace request sent successfully","Success")):(yield t.hideLoading(),yield t.showAlert("Error sending trace request","Error"))});return function(n){return r.apply(this,arguments)}}())})()}getMeasurementResults(){var t=this;return(0,u.A)(function*(){let r=yield t.ripeTraceService.getTraceResults();r?console.log(r):yield t.showAlert("Error fetching trace results","Error")})()}selectCountry(t){const r=this.countries.names.indexOf(t),n=this.countries.probeIDs[r],o=this.selectedCountries.indexOf(n);o>-1?this.selectedCountries.splice(o,1):this.selectedCountries.push(n)}isCountrySelected(t){const r=this.countries.names.indexOf(t);return this.selectedCountries.includes(this.countries.probeIDs[r])}showLoading(){var t=this;return(0,u.A)(function*(){yield(yield t.loadingCtrl.create({})).present()})()}hideLoading(){var t=this;return(0,u.A)(function*(){yield t.loadingCtrl.dismiss()})()}showAlert(t,r){var n=this;return(0,u.A)(function*(){const o=yield n.alertCtrl.create({header:r,message:t,buttons:["OK"]});return yield o.present(),yield o.onDidDismiss(),!0})()}}return(s=l).\u0275fac=function(t){return new(t||s)(e.rXU(v),e.rXU(h.nX),e.rXU(c.Xi),e.rXU(c.hG))},s.\u0275cmp=e.VBU({type:s,selectors:[["app-trace-test"]],inputs:{host:"host",description:"description"},decls:39,vars:9,consts:[[3,"title"],[3,"fullscreen"],[1,"lg:m-10","md:m-10"],["size","12","size-md","4","size-lg","4",1,""],["label","Host Name","placeholder","Enter a host name","type","text","labelPlacement","stacked",1,"",3,"ngModelChange","ngModel"],["size","12","size-md","4","size-lg","4"],["readonly","true","label","Description","placeholder","Enter a description","type","text","labelPlacement","stacked",1,"",3,"ngModelChange","ngModel"],["size","12","size-md","12","size-lg","12"],[1,"text-xl"],[1,"m-2",3,"color"],["size","12","size-md","12","size-lg","12",1,"flex","flex-row","justify-end"],["color","primary","size","small",1,"",3,"click"],["name","add"],[4,"ngFor","ngForOf"],["size","12","size-md","12","size-lg","12",1,"flex","flex-row","justify-end","items-center"],[1,"m-2"],["color","warning","size","small",1,"",3,"click"],["name","refresh"],[1,"m-2",3,"click","color"],["name","arrow-forward","color","primary"]],template:function(t,r){1&t&&(e.nrm(0,"app-header-return",0),e.j41(1,"ion-content",1)(2,"ion-grid"),e.nrm(3,"app-title",0),e.j41(4,"ion-row",2)(5,"ion-col",3)(6,"ion-input",4),e.mxI("ngModelChange",function(o){return e.DH7(r.host,o)||(r.host=o),o}),e.k0s()(),e.j41(7,"ion-col",5)(8,"ion-input",6),e.mxI("ngModelChange",function(o){return e.DH7(r.description,o)||(r.description=o),o}),e.k0s()()(),e.j41(9,"ion-row",2)(10,"ion-col",7)(11,"h3",8),e.EFF(12,"Select Countries to test"),e.k0s()()(),e.j41(13,"ion-row",2)(14,"ion-col",7),e.Z7z(15,C,2,2,"ion-chip",9,e.fX1),e.k0s()(),e.j41(17,"ion-row",2)(18,"ion-col",10)(19,"ion-button",11),e.bIt("click",function(){return r.sendTraceRequest()}),e.EFF(20,"Add Test "),e.nrm(21,"ion-icon",12),e.k0s()()(),e.nrm(22,"app-title",0),e.j41(23,"ion-row",2)(24,"ion-col",7)(25,"ion-list"),e.DNE(26,P,7,5,"ion-item",13),e.k0s()()(),e.j41(27,"ion-row",2)(28,"ion-col",14)(29,"ion-label",15),e.EFF(30,"Not all results are shown? "),e.k0s(),e.j41(31,"ion-button",16),e.bIt("click",function(){return r.getMeasurementResults()}),e.EFF(32,"GET MORE RESULTS "),e.nrm(33,"ion-icon",17),e.k0s()()(),e.nrm(34,"app-title",0),e.j41(35,"ion-row",2)(36,"ion-col",7)(37,"ion-list"),e.DNE(38,j,4,1,"ion-item",13),e.k0s()()()()()),2&t&&(e.Y8G("title","Traceroute Test"),e.R7$(),e.Y8G("fullscreen",!0),e.R7$(2),e.Y8G("title","New Traceroute Test"),e.R7$(3),e.R50("ngModel",r.host),e.R7$(2),e.R50("ngModel",r.description),e.R7$(7),e.Dyx(r.countries.names),e.R7$(7),e.Y8G("title","Test Results"),e.R7$(4),e.Y8G("ngForOf",r.ripeResults),e.R7$(8),e.Y8G("title","Test Results History"),e.R7$(4),e.Y8G("ngForOf",r.ripeHistoryResultsID))},dependencies:[f.Sq,p.BC,p.vS,c.Jm,c.ZB,c.hU,c.W9,c.lO,c.iq,c.$w,c.uz,c.he,c.nf,c.ln,c.Gw,F.W,S.p]}),l})()}];let E=(()=>{var s;class l{}return(s=l).\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.$C({type:s}),s.\u0275inj=e.G2t({imports:[h.iI.forChild(D),h.iI]}),l})();var M=a(5553);let b=(()=>{var s;class l{}return(s=l).\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.$C({type:s}),s.\u0275inj=e.G2t({imports:[f.MD,p.YN,c.bv,E,M.h]}),l})()}}]);