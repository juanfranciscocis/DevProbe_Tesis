"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[3373],{5553:(E,p,i)=>{i.d(p,{h:()=>h});var a=i(177),n=i(7863),l=i(4438);let h=(()=>{var v;class c{}return(v=c).\u0275fac=function(y){return new(y||v)},v.\u0275mod=l.$C({type:v}),v.\u0275inj=l.G2t({imports:[a.MD,n.bv]}),c})()},8453:(E,p,i)=>{i.d(p,{W:()=>l});var a=i(4438),n=i(7863);let l=(()=>{var h;class v{constructor(){this.title="Title"}ngOnInit(){}}return(h=v).\u0275fac=function(_){return new(_||h)},h.\u0275cmp=a.VBU({type:h,selectors:[["app-title"]],inputs:{title:"title"},decls:4,vars:1,consts:[[1,"lg:m-10"],["size","12","size-md","6","size-lg","6"],[1,"text-4xl","lg:text-6xl","font-bold"]],template:function(_,y){1&_&&(a.j41(0,"ion-row",0)(1,"ion-col",1)(2,"h1",2),a.EFF(3),a.k0s()()()),2&_&&(a.R7$(3),a.JRh(y.title))},dependencies:[n.hU,n.ln]}),v})()},4796:(E,p,i)=>{i.d(p,{u:()=>v});var a=i(467),n=i(8737),l=i(4262),h=i(4438);let v=(()=>{var c;class _{constructor(e,o){this.auth=e,this.firestore=o}registerUser(e){var o=this;return(0,a.A)(function*(){try{const t=yield(0,n.eJ)(o.auth,e.email,e.password);return t.user?(yield(0,l.BN)((0,l.H9)(o.firestore,"users",t.user.uid),{email:e.email,name:e.name,orgName:e.orgName,uid:t.user.uid}),yield(0,l.BN)((0,l.H9)(o.firestore,"teams",`${e.orgName}`),{name:e.orgName,members:[t.user.uid]}),t):null}catch{return null}})()}loginUser(e){var o=this;return(0,a.A)(function*(){try{var t;const r=yield(0,n.x9)(o.auth,e.email,e.password);if(null!==(t=r.user)&&void 0!==t&&t.uid){const s=yield(0,l.x7)((0,l.H9)(o.firestore,"users",r.user.uid));if(s.exists())return localStorage.setItem("user",JSON.stringify(s.data())),r}}catch(r){console.error(r)}return null})()}logoutUser(){var e=this;return(0,a.A)(function*(){yield e.auth.signOut()})()}addMember(e){var o=this;return(0,a.A)(function*(){try{const t=yield(0,n.eJ)(o.auth,e.email,e.password);if(!t.user)return!1;const r={email:e.email,name:e.name,orgName:e.orgName,uid:t.user.uid};return yield(0,l.BN)((0,l.H9)(o.firestore,"users",t.user.uid),r),r}catch{return!1}})()}}return(c=_).\u0275fac=function(e){return new(e||c)(h.KVO(n.Nj),h.KVO(l._7))},c.\u0275prov=h.jDH({token:c,factory:c.\u0275fac,providedIn:"root"}),_})()},201:(E,p,i)=>{i.d(p,{p:()=>v});var a=i(467),n=i(4262),l=i(4438),h=i(1626);let v=(()=>{var c;class _{constructor(e,o){this.firestore=e,this.httpClient=o,this.url="https://devprobeapi.onrender.com/"}syncRepo(e,o,t,r,s){var u=this;return(0,a.A)(function*(){const d=(0,n.H9)(u.firestore,"teams",e),m=yield(0,n.x7)(d);if(m.exists()){const g=m.data();g.gitHub={key:o,repo:t,branch:r,owner:s},yield(0,n.BN)(d,g)}})()}getSyncRepo(e){var o=this;return(0,a.A)(function*(){const t=(0,n.H9)(o.firestore,"teams",e),r=yield(0,n.x7)(t);return r.exists()?r.data().gitHub:null})()}getFiles(e){var o=this;return(0,a.A)(function*(){const t=yield o.httpClient.post(o.url+"github_repo",{auth:e.key,repo:e.repo,branch:e.branch,owner:e.owner}).toPromise();if(console.log(t),t){let r=t.paths;return r=r.filter(s=>!s.includes(".git")),r=r.filter(s=>!s.includes("node_modules")),r=r.filter(s=>!s.includes(".idea")),r=r.filter(s=>s.includes(".")),r}return[]})()}getContentFromFilePath(e,o){var t=this;return(0,a.A)(function*(){const r=yield t.httpClient.post(t.url+"github_file",{auth:e.key,repo:e.repo,owner:e.owner,path:o}).toPromise();return console.log(r),r?r.content:""})()}}return(c=_).\u0275fac=function(e){return new(e||c)(l.KVO(n._7),l.KVO(h.Qq))},c.\u0275prov=l.jDH({token:c,factory:c.\u0275fac,providedIn:"root"}),_})()},7473:(E,p,i)=>{i.d(p,{J:()=>c});var a=i(467),n=i(4262),l=i(4438),h=i(1626),v=i(5092);let c=(()=>{var _;class y{constructor(o,t,r){this.firestore=o,this.http=t,this.teamService=r}saveNotificationID(o,t){var r=this;return(0,a.A)(function*(){const s=(0,n.H9)(r.firestore,"users",o.uid),u=yield(0,n.x7)(s);if(u.exists()){const d=u.data();return d.notificationID=t,yield(0,n.BN)(s,d),!0}return console.log("No such document!"),!1})()}getNotificationUser(o){var t=this;return(0,a.A)(function*(){const r=(0,n.H9)(t.firestore,"users",o.uid),s=yield(0,n.x7)(r);if(s.exists()){const u=s.data();return u.notificationID?u.notificationID:""}return console.log("No such document!"),null})()}notifyIncidentToUser(o,t){var r=this;return(0,a.A)(function*(){try{const s=yield r.teamService.getTeamByOrganization(t),u=o.map(g=>g.member),d=s.filter(g=>u.includes(g.name));console.log("team",d);const m="https://devprobeapi.onrender.com/sendNotification";for(let g of d){let f=yield r.getNotificationUser(g);if(console.log("sid",f),""!==f){const M={sid:f,title:"New Incident",type:"new_incident",message:`Hey ${g.name}, you have been assigned a new incident your incident role is ${o.find(D=>D.member===g.name).role}`,target:"https://devprobe-89481.web.app/incident-manager-chooser"};yield r.http.post(m,M).toPromise(),console.log("Notification sent successfully")}else console.log("no sid")}}catch(s){console.log(s)}})()}notifyIncidentUpdateToTeam(o,t,r){var s=this;return(0,a.A)(function*(){try{const u=yield s.teamService.getTeamByOrganization(t),d=o.map(f=>f.member),m=u.filter(f=>d.includes(f.name));console.log("team",m);const g="https://devprobeapi.onrender.com/sendNotification";for(let f of m){let O=yield s.getNotificationUser(f);if(console.log("sid",O),""!==O){const D={sid:O,title:"Incident Update",type:"update_incident",message:`Hey ${f.name}, there are updates to your incident`,target:r};yield s.http.post(g,D).toPromise(),console.log("Notification sent successfully")}else console.log("no sid")}}catch(u){console.log(u)}})()}notifyTestToUser(o,t,r){var s=this;return(0,a.A)(function*(){try{console.log("Notify test to user");const u=yield s.teamService.getTeamByOrganization(t),d=o.member,m=u.filter(f=>f.name===d);console.log("team",m);const g="https://devprobeapi.onrender.com/sendNotification";for(let f of m){let O=yield s.getNotificationUser(f);if(console.log("sid",O),""!==O){const D={sid:O,title:"New Unit Test",type:"test",message:`Hey ${f.name}, you have been assigned a new test`,target:r};yield s.http.post(g,D).toPromise(),console.log("Notification sent successfully")}else console.log("no sid")}}catch(u){console.log(u)}})()}}return(_=y).\u0275fac=function(o){return new(o||_)(l.KVO(n._7),l.KVO(h.Qq),l.KVO(v.O))},_.\u0275prov=l.jDH({token:_,factory:_.\u0275fac,providedIn:"root"}),y})()},5092:(E,p,i)=>{i.d(p,{O:()=>v});var a=i(467),n=i(4262),l=i(4438),h=i(4796);let v=(()=>{var c;class _{constructor(e,o){this.firestore=e,this.authService=o}getTeamByOrganization(e){var o=this;return(0,a.A)(function*(){let t=(0,n.H9)(o.firestore,"teams",e);const u=(yield(0,n.x7)(t)).data();let d=[];for(let m=0;m<u.members.length;m++){t=(0,n.H9)(o.firestore,"users",u.members[m]);const f=(yield(0,n.x7)(t)).data();d.push(f)}return d})()}removeMember(e,o){var t=this;return(0,a.A)(function*(){try{let r=(0,n.H9)(t.firestore,"teams",e);const d=(yield(0,n.x7)(r)).data();let m=d.members.filter(f=>f!==o);return yield(0,n.BN)(r,{name:d.name,members:m}),r=(0,n.H9)(t.firestore,"users",o),yield(0,n.BN)(r,{}),yield t.authService,!0}catch{return!1}})()}addMember(e){var o=this;return(0,a.A)(function*(){try{const t=yield o.authService.addMember(e);if(!t)return!1;const r=(0,n.H9)(o.firestore,"teams",e.orgName),u=(yield(0,n.x7)(r)).data();console.log(u);const d=u;let m=d.members;return m.push(t.uid),console.log(m),yield(0,n.mZ)(r,{name:d.name,members:m}),t.uid}catch{return!1}})()}}return(c=_).\u0275fac=function(e){return new(e||c)(l.KVO(n._7),l.KVO(h.u))},c.\u0275prov=l.jDH({token:c,factory:c.\u0275fac,providedIn:"root"}),_})()}}]);