"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[2051],{2051:(D,m,a)=>{a.r(m),a.d(m,{ShowMapTracePageModule:()=>j});var v=a(177),M=a(4341),d=a(7863),u=a(305),s=a(467),f=a(8244),T=a(5841),o=a(4438),y=a(2588),P=a(3241);const S=[{path:"",component:(()=>{var t;class n{constructor(e,i,r){this.ripeTraceService=e,this.loadingCtrl=i,this.route=r,this.ripeData=[],this.orgName="",this.productObjective="",this.description=""}ngOnDestroy(){this.map.remove()}ionViewDidEnter(){var e=this;return(0,s.A)(function*(){yield e.showLoading(),e.route.queryParams.subscribe(function(){var i=(0,s.A)(function*(r){e.description=r.description,e.productObjective=r.productObjective,e.orgName=r.orgName,console.log(e.orgName),console.log(e.productObjective),console.log(e.description),yield e.ripeTraceService.getAllResultsByDescription(e.orgName,e.productObjective,e.description).then(c=>{e.ripeData=c.data,console.log(e.ripeData)}).then(()=>{e.leafletMap()})});return function(r){return i.apply(this,arguments)}}())})()}leafletMap(){var e=this;return(0,s.A)(function*(){e.map=f.map("mapId").setView([0,0],2.5),f.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"edupala.com \xa9 Angular LeafLet",minZoom:2.5,maxZoom:8}).addTo(e.map),setTimeout(()=>{e.map.invalidateSize(),e.addPaths()},1e3)})()}addPaths(){var e=this;return(0,s.A)(function*(){let i=[];for(let r of e.ripeData){let c=[],A=r.result;for(let C of A)try{let p=C.result[0],h=p.from_latitude,g=p.from_longitude;if(0==h&&0==g||null==h||null==g)continue;c.push([h,g])}catch{continue}i.push(c)}for(let r of i)(0,T.antPath)(r,{color:"#FF0000",weight:5,opacity:.6}).addTo(e.map);yield e.hideLoading()})()}showLoading(){var e=this;return(0,s.A)(function*(){yield(yield e.loadingCtrl.create({})).present()})()}hideLoading(){var e=this;return(0,s.A)(function*(){yield e.loadingCtrl.dismiss()})()}ngOnInit(){}}return(t=n).\u0275fac=function(e){return new(e||t)(o.rXU(y.N),o.rXU(d.Xi),o.rXU(u.nX))},t.\u0275cmp=o.VBU({type:t,selectors:[["app-show-map-trace"]],decls:3,vars:1,consts:[[3,"title"],[1,"relative"],["id","mapId",2,"width","100%","height","100%"]],template:function(e,i){1&e&&(o.nrm(0,"app-header-return",0),o.j41(1,"ion-content",1),o.nrm(2,"div",2),o.k0s()),2&e&&o.Y8G("title","Show Map")},dependencies:[d.W9,P.p]}),n})()}];let w=(()=>{var t;class n{}return(t=n).\u0275fac=function(e){return new(e||t)},t.\u0275mod=o.$C({type:t}),t.\u0275inj=o.G2t({imports:[u.iI.forChild(S),u.iI]}),n})();var L=a(5553);let j=(()=>{var t;class n{}return(t=n).\u0275fac=function(e){return new(e||t)},t.\u0275mod=o.$C({type:t}),t.\u0275inj=o.G2t({imports:[v.MD,M.YN,d.bv,w,L.h]}),n})()}}]);