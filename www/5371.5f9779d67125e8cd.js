"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[5371],{5553:(O,b,n)=>{n.d(b,{h:()=>p});var m=n(177),l=n(7863),r=n(4438);let p=(()=>{var d;class e{}return(d=e).\u0275fac=function(P){return new(P||d)},d.\u0275mod=r.$C({type:d}),d.\u0275inj=r.G2t({imports:[m.MD,l.bv]}),e})()},8453:(O,b,n)=>{n.d(b,{W:()=>r});var m=n(4438),l=n(7863);let r=(()=>{var p;class d{constructor(){this.title="Title"}ngOnInit(){}}return(p=d).\u0275fac=function(g){return new(g||p)},p.\u0275cmp=m.VBU({type:p,selectors:[["app-title"]],inputs:{title:"title"},decls:4,vars:1,consts:[[1,"lg:m-10"],["size","12","size-md","6","size-lg","6"],[1,"text-4xl","lg:text-6xl","font-bold"]],template:function(g,P){1&g&&(m.j41(0,"ion-row",0)(1,"ion-col",1)(2,"h1",2),m.EFF(3),m.k0s()()()),2&g&&(m.R7$(3),m.JRh(P.title))},dependencies:[l.hU,l.ln]}),d})()},5371:(O,b,n)=>{n.r(b),n.d(b,{SettingsPageModule:()=>M});var m=n(177),l=n(4341),r=n(7863),p=n(7650),d=n(467),e=n(4438),g=n(4796),P=n(201),i=n(7473),s=n(385),o=n(8453);const h=[{path:"",component:(()=>{var a;class f{constructor(t,u,E,_,D,N){this.authService=t,this.router=u,this.alertCtrl=E,this.githubService=_,this.loadingCtrl=D,this.notificationService=N,this.gitKey="",this.repoName="",this.branchName="",this.owner="",this.user={},this.orgname="",this.version="1.11.232"}ngOnInit(){}ionViewWillEnter(){var t=this;return(0,d.A)(function*(){t.user=localStorage.getItem("user")?JSON.parse(localStorage.getItem("user")||"{}"):null,t.user?(t.orgname=t.user.orgName||"",yield t.getSyncRepo()):yield t.showAlert("No user found","Error")})()}logout(){var t=this;return(0,d.A)(function*(){yield t.authService.logoutUser(),yield t.router.navigate(["/login"])})()}getSyncRepo(){var t=this;return(0,d.A)(function*(){yield t.showLoading();const u=yield t.githubService.getSyncRepo(t.orgname);u&&(t.gitKey=u.key,t.repoName=u.repo,t.branchName=u.branch,t.owner=u.owner),yield t.hideLoading()})()}syncRepo(){var t=this;return(0,d.A)(function*(){yield t.showLoading(),t.gitKey&&t.repoName&&t.branchName&&t.owner&&""!==t.gitKey&&""!==t.repoName&&""!==t.branchName&&""!==t.owner?(yield t.githubService.syncRepo(t.orgname,t.gitKey,t.repoName,t.branchName,t.owner),yield t.hideLoading()):yield t.showAlert("Please fill in all fields","Error")})()}showAlert(t,u){var E=this;return(0,d.A)(function*(){yield(yield E.alertCtrl.create({header:u,message:t,buttons:["OK"]})).present()})()}showLoading(){var t=this;return(0,d.A)(function*(){yield(yield t.loadingCtrl.create({})).present()})()}hideLoading(){var t=this;return(0,d.A)(function*(){yield t.loadingCtrl.dismiss()})()}notify(){Notification.requestPermission().then(function(t){console.log("granted"===t?"Permission granted for notifications":"Permission denied for notifications")})}subscribe(){var t=this;return(0,d.A)(function*(){webpushr("fetch_id",function(){var u=(0,d.A)(function*(E){console.log("webpushr subscriber id: "+E),E?yield t.notificationService.saveNotificationID(t.user,E).then(function(){var _=(0,d.A)(function*(D){D&&(yield t.showAlert("Subscription saved successfully","Success"))});return function(D){return _.apply(this,arguments)}}()):yield t.showAlert("No subscription id found, please check browser permissions","Error")});return function(E){return u.apply(this,arguments)}}())})()}}return(a=f).\u0275fac=function(t){return new(t||a)(e.rXU(g.u),e.rXU(p.Ix),e.rXU(r.hG),e.rXU(P.p),e.rXU(r.Xi),e.rXU(i.J))},a.\u0275cmp=e.VBU({type:a,selectors:[["app-settings"]],decls:72,vars:10,consts:[[3,"title"],[3,"fullscreen"],[1,"lg:m-10","md:m-10"],["size","12","size-md","12","size-lg","12",1,"flex","flex-row","justify-center"],["color","danger",1,"min-w-full",3,"click"],["size","12","size-md","12","size-lg","12",1,""],[1,"p-5"],[1,"text-2xl"],[1,"text-white"],["href","https://github.com/settings/tokens",1,"text-blue-500"],["placeholder","Enter your key here...",1,"text-white",3,"ngModelChange","ngModel"],["placeholder","Enter your repo name here...",1,"text-white",3,"ngModelChange","ngModel"],["placeholder","Enter your branch name here...",1,"text-white",3,"ngModelChange","ngModel"],["color","primary",1,"min-w-full",3,"click"],[1,"w-full",3,"click"],["size","12",1,"flex","flex-row","justify-end","items-center"],[1,"text-sm"]],template:function(t,u){1&t&&(e.nrm(0,"app-header",0),e.j41(1,"ion-content",1)(2,"ion-grid"),e.nrm(3,"app-title",0),e.j41(4,"ion-row",2)(5,"ion-col",3)(6,"ion-button",4),e.bIt("click",function(){return u.logout()}),e.EFF(7,"Logout"),e.k0s()()(),e.nrm(8,"app-title",0),e.j41(9,"ion-row",2)(10,"ion-col",5)(11,"ion-card",6)(12,"ion-card",6)(13,"ion-card-title",7),e.EFF(14,"1. Add a GitHub Key"),e.k0s(),e.j41(15,"ion-card-content")(16,"p",8),e.EFF(17," Add a GitHub key to sync with your GitHub repo. You will be able to create tests with DevProbeAI. "),e.j41(18,"a",9),e.EFF(19,"Get A GitHub Key Here !!!"),e.k0s()()(),e.j41(20,"ion-card")(21,"ion-card-content")(22,"ion-label"),e.EFF(23,"GitHub Key"),e.k0s(),e.j41(24,"ion-input",10),e.mxI("ngModelChange",function(_){return e.DH7(u.gitKey,_)||(u.gitKey=_),_}),e.k0s()()()(),e.j41(25,"ion-card",6)(26,"ion-card-title",7),e.EFF(27,"2. Repo Name"),e.k0s(),e.j41(28,"ion-card-content")(29,"p",8),e.EFF(30," Add the name of the repo you want to sync with DevProbeAI. "),e.k0s()(),e.j41(31,"ion-card")(32,"ion-card-content")(33,"ion-label"),e.EFF(34,"Repo Name"),e.k0s(),e.j41(35,"ion-input",11),e.mxI("ngModelChange",function(_){return e.DH7(u.repoName,_)||(u.repoName=_),_}),e.k0s()()()(),e.j41(36,"ion-card",6)(37,"ion-card-title",7),e.EFF(38,"3. Branch Name"),e.k0s(),e.j41(39,"ion-card-content")(40,"p",8),e.EFF(41," Add the name of the branch you want to sync with DevProbeAI. "),e.k0s()(),e.j41(42,"ion-card")(43,"ion-card-content")(44,"ion-label"),e.EFF(45,"Branch Name"),e.k0s(),e.j41(46,"ion-input",12),e.mxI("ngModelChange",function(_){return e.DH7(u.branchName,_)||(u.branchName=_),_}),e.k0s()()()(),e.j41(47,"ion-card",6)(48,"ion-card-title",7),e.EFF(49,"4. Owner Name"),e.k0s(),e.j41(50,"ion-card-content")(51,"p",8),e.EFF(52," Add the name of the owner of the repo you want to sync with DevProbeAI. "),e.k0s()(),e.j41(53,"ion-card")(54,"ion-card-content")(55,"ion-label"),e.EFF(56,"Owner Name"),e.k0s(),e.j41(57,"ion-input",12),e.mxI("ngModelChange",function(_){return e.DH7(u.owner,_)||(u.owner=_),_}),e.k0s()()()(),e.j41(58,"ion-button",13),e.bIt("click",function(){return u.syncRepo()}),e.EFF(59,"Sync Repo"),e.k0s()()()(),e.nrm(60,"app-title",0),e.j41(61,"ion-row",2)(62,"ion-col",5)(63,"p"),e.EFF(64,"Receive push notifications when new data is available. Like new tests, incidents, etc."),e.k0s()(),e.j41(65,"ion-col",3)(66,"ion-button",14),e.bIt("click",function(){return u.subscribe()}),e.EFF(67,"Subscribe"),e.k0s()()(),e.j41(68,"ion-row")(69,"ion-col",15)(70,"h1",16),e.EFF(71),e.k0s()()()()()),2&t&&(e.Y8G("title","Settings"),e.R7$(),e.Y8G("fullscreen",!0),e.R7$(2),e.Y8G("title","Account SingOut"),e.R7$(5),e.Y8G("title","Sync GitHub Repo"),e.R7$(16),e.R50("ngModel",u.gitKey),e.R7$(11),e.R50("ngModel",u.repoName),e.R7$(11),e.R50("ngModel",u.branchName),e.R7$(11),e.R50("ngModel",u.owner),e.R7$(3),e.Y8G("title","Receive Push Notifications"),e.R7$(11),e.SpI("Version: ",u.version,""))},dependencies:[l.BC,l.vS,r.Jm,r.b_,r.I9,r.tN,r.hU,r.W9,r.lO,r.$w,r.he,r.ln,r.Gw,s.l,o.W]}),f})()}];let v=(()=>{var a;class f{}return(a=f).\u0275fac=function(t){return new(t||a)},a.\u0275mod=e.$C({type:a}),a.\u0275inj=e.G2t({imports:[p.iI.forChild(h),p.iI]}),f})();var y=n(5553);let M=(()=>{var a;class f{}return(a=f).\u0275fac=function(t){return new(t||a)},a.\u0275mod=e.$C({type:a}),a.\u0275inj=e.G2t({imports:[m.MD,l.YN,r.bv,v,y.h]}),f})()},4796:(O,b,n)=>{n.d(b,{u:()=>d});var m=n(467),l=n(8737),r=n(4262),p=n(4438);let d=(()=>{var e;class g{constructor(i,s){this.auth=i,this.firestore=s}registerUser(i){var s=this;return(0,m.A)(function*(){try{const o=yield(0,l.eJ)(s.auth,i.email,i.password);return o.user?(yield(0,r.BN)((0,r.H9)(s.firestore,"users",o.user.uid),{email:i.email,name:i.name,orgName:i.orgName,uid:o.user.uid}),yield(0,r.BN)((0,r.H9)(s.firestore,"teams",`${i.orgName}`),{name:i.orgName,members:[o.user.uid]}),o):null}catch{return null}})()}loginUser(i){var s=this;return(0,m.A)(function*(){try{var o;const c=yield(0,l.x9)(s.auth,i.email,i.password);if(null!==(o=c.user)&&void 0!==o&&o.uid){const h=yield(0,r.x7)((0,r.H9)(s.firestore,"users",c.user.uid));if(h.exists())return localStorage.setItem("user",JSON.stringify(h.data())),c}}catch(c){console.error(c)}return null})()}logoutUser(){var i=this;return(0,m.A)(function*(){yield i.auth.signOut()})()}addMember(i){var s=this;return(0,m.A)(function*(){try{const o=yield(0,l.eJ)(s.auth,i.email,i.password);if(!o.user)return!1;const c={email:i.email,name:i.name,orgName:i.orgName,uid:o.user.uid};return yield(0,r.BN)((0,r.H9)(s.firestore,"users",o.user.uid),c),c}catch{return!1}})()}}return(e=g).\u0275fac=function(i){return new(i||e)(p.KVO(l.Nj),p.KVO(r._7))},e.\u0275prov=p.jDH({token:e,factory:e.\u0275fac,providedIn:"root"}),g})()},7473:(O,b,n)=>{n.d(b,{J:()=>e});var m=n(467),l=n(4262),r=n(4438),p=n(1626),d=n(5092);let e=(()=>{var g;class P{constructor(s,o,c){this.firestore=s,this.http=o,this.teamService=c}saveNotificationID(s,o){var c=this;return(0,m.A)(function*(){const h=(0,l.H9)(c.firestore,"users",s.uid),v=yield(0,l.x7)(h);if(v.exists()){const y=v.data();return y.notificationID=o,yield(0,l.BN)(h,y),!0}return console.log("No such document!"),!1})()}getNotificationUser(s){var o=this;return(0,m.A)(function*(){const c=(0,l.H9)(o.firestore,"users",s.uid),h=yield(0,l.x7)(c);if(h.exists()){const v=h.data();return v.notificationID?v.notificationID:""}return console.log("No such document!"),null})()}notifyIncidentToUser(s,o){var c=this;return(0,m.A)(function*(){try{const h=yield c.teamService.getTeamByOrganization(o),v=s.map(a=>a.member),y=h.filter(a=>v.includes(a.name));console.log("team",y);const M="https://devprobeapi.onrender.com/sendNotification";for(let a of y){let f=yield c.getNotificationUser(a);if(console.log("sid",f),""!==f){const t={sid:f,title:"New Incident",type:"new_incident",message:`Hey ${a.name}, you have been assigned a new incident your incident role is ${s.find(u=>u.member===a.name).role}`,target:"https://devprobe-89481.web.app/incident-manager-chooser"};yield c.http.post(M,t).toPromise(),console.log("Notification sent successfully")}else console.log("no sid")}}catch(h){console.log(h)}})()}notifyIncidentUpdateToTeam(s,o){var c=this;return(0,m.A)(function*(){try{const h=yield c.teamService.getTeamByOrganization(o),v=s.map(a=>a.member),y=h.filter(a=>v.includes(a.name));console.log("team",y);const M="https://devprobeapi.onrender.com/sendNotification";for(let a of y){let f=yield c.getNotificationUser(a);if(console.log("sid",f),""!==f){const t={sid:f,title:"Incident Update",type:"update_incident",message:`Hey ${a.name}, there are updates to your incident`,target:"https://devprobe-89481.web.app/incident-manager-chooser"};yield c.http.post(M,t).toPromise(),console.log("Notification sent successfully")}else console.log("no sid")}}catch(h){console.log(h)}})()}}return(g=P).\u0275fac=function(s){return new(s||g)(r.KVO(l._7),r.KVO(p.Qq),r.KVO(d.O))},g.\u0275prov=r.jDH({token:g,factory:g.\u0275fac,providedIn:"root"}),P})()},5092:(O,b,n)=>{n.d(b,{O:()=>d});var m=n(467),l=n(4262),r=n(4438),p=n(4796);let d=(()=>{var e;class g{constructor(i,s){this.firestore=i,this.authService=s}getTeamByOrganization(i){var s=this;return(0,m.A)(function*(){let o=(0,l.H9)(s.firestore,"teams",i);const v=(yield(0,l.x7)(o)).data();let y=[];for(let M=0;M<v.members.length;M++){o=(0,l.H9)(s.firestore,"users",v.members[M]);const f=(yield(0,l.x7)(o)).data();y.push(f)}return y})()}removeMember(i,s){var o=this;return(0,m.A)(function*(){try{let c=(0,l.H9)(o.firestore,"teams",i);const y=(yield(0,l.x7)(c)).data();let M=y.members.filter(f=>f!==s);return yield(0,l.BN)(c,{name:y.name,members:M}),c=(0,l.H9)(o.firestore,"users",s),yield(0,l.BN)(c,{}),yield o.authService,!0}catch{return!1}})()}addMember(i){var s=this;return(0,m.A)(function*(){try{const o=yield s.authService.addMember(i);if(!o)return!1;const c=(0,l.H9)(s.firestore,"teams",i.orgName),v=(yield(0,l.x7)(c)).data();console.log(v);const y=v;let M=y.members;return M.push(o.uid),console.log(M),yield(0,l.mZ)(c,{name:y.name,members:M}),o.uid}catch{return!1}})()}}return(e=g).\u0275fac=function(i){return new(i||e)(r.KVO(l._7),r.KVO(p.u))},e.\u0275prov=r.jDH({token:e,factory:e.\u0275fac,providedIn:"root"}),g})()}}]);