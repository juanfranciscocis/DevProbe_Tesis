"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[3151],{5553:(P,C,i)=>{i.d(C,{h:()=>y});var d=i(177),v=i(7863),s=i(4438);let y=(()=>{var g;class e{}return(g=e).\u0275fac=function(f){return new(f||g)},g.\u0275mod=s.$C({type:g}),g.\u0275inj=s.G2t({imports:[d.MD,v.bv]}),e})()},3241:(P,C,i)=>{i.d(C,{p:()=>y});var d=i(4438),v=i(177),s=i(7863);let y=(()=>{var g;class e{constructor(f){this.location=f,this.title="Header Title"}ngOnInit(){}goBack(){this.location.back()}}return(g=e).\u0275fac=function(f){return new(f||g)(d.rXU(v.aZ))},g.\u0275cmp=d.VBU({type:g,selectors:[["app-header-return"]],inputs:{title:"title"},decls:6,vars:2,consts:[[3,"translucent"],["slot","start","menu","menu-id"],["name","arrow-back","slot","start",1,"p-4","bigger-icon",3,"click"]],template:function(f,F){1&f&&(d.j41(0,"ion-header",0)(1,"ion-toolbar"),d.nrm(2,"ion-menu-button",1),d.j41(3,"ion-icon",2),d.bIt("click",function(){return F.goBack()}),d.k0s(),d.j41(4,"ion-title"),d.EFF(5),d.k0s()()()),2&f&&(d.Y8G("translucent",!0),d.R7$(5),d.JRh(F.title))},dependencies:[s.eU,s.iq,s.MC,s.BC,s.ai],styles:[".bigger-icon[_ngcontent-%COMP%]{font-size:1.5em}"]}),e})()},3151:(P,C,i)=>{i.r(C),i.d(C,{FlameGraphComparePageModule:()=>L});var d=i(177),v=i(4341),s=i(7863),y=i(4848),g=i(467),e=i(4438),_=i(9032),f=i(6560),F=i(8453),j=i(3241),w=i(7616),E=i(2814);const k=["messagesContainer2"];function D(a,m){if(1&a&&(e.j41(0,"ion-col",32)(1,"ion-card",33)(2,"ion-card-header")(3,"ion-card-title")(4,"h1"),e.EFF(5),e.k0s()()(),e.nrm(6,"ngx-flamegraph",34),e.k0s()()),2&a){const r=m.$implicit,o=e.XpG(2);e.R7$(5),e.SpI("Data for: ",r,""),e.R7$(),e.Y8G("config",o.configurations[r])}}function T(a,m){if(1&a&&(e.j41(0,"ion-row",4),e.DNE(1,D,7,2,"ion-col",31),e.k0s()),2&a){const r=e.XpG();e.R7$(),e.Y8G("ngForOf",r.datesForComparison)}}function A(a,m){if(1&a&&(e.j41(0,"ion-col",36)(1,"ion-card",33),e.qex(2),e.j41(3,"ion-card")(4,"ion-card-header")(5,"ion-card-title"),e.EFF(6),e.k0s()(),e.nrm(7,"ngx-flamegraph",34),e.k0s(),e.bVm(),e.k0s()()),2&a){const r=m.$implicit,o=e.XpG(2);e.R7$(6),e.SpI("Data for: ",r,""),e.R7$(),e.Y8G("config",o.configurations[r])}}function I(a,m){if(1&a&&(e.j41(0,"ion-row",4),e.DNE(1,A,8,2,"ion-col",35),e.k0s()),2&a){const r=e.XpG();e.R7$(),e.Y8G("ngForOf",r.datesForComparison)}}function B(a,m){if(1&a&&(e.j41(0,"markdown",8),e.EFF(1),e.k0s()),2&a){const r=m.$implicit;e.R7$(),e.JRh(r.message)}}function O(a,m){if(1&a&&(e.j41(0,"div",40)(1,"markdown",41),e.EFF(2),e.k0s()()),2&a){const r=e.XpG().$implicit;e.R7$(2),e.JRh(r.message)}}function z(a,m){if(1&a&&(e.j41(0,"div",42)(1,"markdown",43),e.EFF(2),e.k0s()()),2&a){const r=e.XpG().$implicit;e.R7$(),e.Mz_("id","mk-",r.id,""),e.R7$(),e.JRh(r.message)}}function N(a,m){if(1&a&&(e.j41(0,"div",37),e.DNE(1,O,3,1,"div",38)(2,z,3,3,"div",39),e.k0s()),2&a){const r=m.$implicit;e.R7$(),e.Y8G("ngIf","User"===r.from),e.R7$(),e.Y8G("ngIf","AI"===r.from)}}const S=[{path:"",component:(()=>{var a;class m{constructor(o,t,c){this.flameGraphService=o,this.loadingCtrl=t,this.route=c,this.product={},this.datesForComparison=[],this.lenDates=0,this.configurations={},this.aiAnalytic=[],this.aiModal=!1,this.message="",this.vertexAI=(0,e.WQX)(_.L9),this.model=(0,_.oc)(this.vertexAI,{model:"gemini-1.5-flash"}),this.chat=this.model.startChat({history:[{role:"user",parts:[{text:"Hola, desde ahora en adelante quiero que seas un modelo experto en Software Quality Assurance y analista de datos, tu nombre es DevProbeAI, nunca lo puedes olvidar"}]},{role:"model",parts:[{text:"Soy un modelo experto en Software Quality Assurance, de igual forma tengo un masterado en anla\xedtica de datos \xbfEn qu\xe9 puedo ayudarte?"}]},{role:"user",parts:[{text:"Gracias, te voy a entregar un json con datos en unos minutos, necesito que lo analices y me des un resumen de los datos, este json contiene datos de usos de un servidor por d\xeda, imagina que ,tu analisis tiene que ser detallado, si encuentras inconsistencias en los datos, por favor mencionalas, en caso de que creas que puede haber un uso excesivo de algun servicio por favor mencionalo, si encuentras algo interesante, por favor mencionalo, en resumen, necesito un analisis detallado de los datos"}]},{role:"model",parts:[{text:"Claro, env\xedame el json y yo me encargo de analizarlo"}]}]}),this.messages=[],this.wasChatOpen=!1}ngOnInit(){}ionViewWillEnter(){this.getProductAndDatesFromParams(),this.getFlameGraph().then(()=>{this.sendMessage().then(()=>{this.chatStyle()})})}getFlameGraph(){var o=this;return(0,g.A)(function*(){try{yield o.showLoading();const t=localStorage.getItem("user");if(!t)return;const l=JSON.parse(t).orgName;console.log(l),o.configurations={};for(const n of o.datesForComparison){const u=yield o.flameGraphService.getFlameGraphByDate(l,o.product.productObjective,n);console.log(u);let h=[],p=[];for(let b in u){const x=null==u?void 0:u[b];p=Object.keys(x),console.log("keys",p);const W=100/p.length;for(let M in p){const R=[];for(let G=0;G<x[p[M]].length;G++)R[G]=o.transformToRawData(x[p[M]][G]);console.log("server1",R);const X={label:p[M],value:W,children:[...R]};h.push(X)}console.log("server",h)}h=[{label:"root",value:100,children:h}],o.configurations[n]={data:h}}console.log("Final configurations",o.configurations),yield o.hideLoading()}catch(t){console.log(t),yield o.hideLoading()}})()}getProductAndDatesFromParams(){this.route.queryParams.subscribe(o=>{this.product=JSON.parse(o.product),this.datesForComparison=JSON.parse(o.dates)}),this.lenDates=this.datesForComparison.length,console.log(this.product.productObjective),console.log(this.datesForComparison)}doRefresh(o){this.getFlameGraph().then(()=>{o.target.complete()})}showLoading(){var o=this;return(0,g.A)(function*(){yield(yield o.loadingCtrl.create({})).present()})()}hideLoading(){var o=this;return(0,g.A)(function*(){yield o.loadingCtrl.dismiss()})()}average(o){const t=o.map(Number);return t.reduce((l,n)=>l+n,0)/t.length}transformToRawData(o){const t=o.cpu_usage?this.average(o.cpu_usage):0,c=[];for(const l in o){if("id"===l||"cpu_usage"===l)continue;const n=o[l];if("object"!=typeof n||Array.isArray(n))"object"!=typeof n&&c.push({label:l,value:0,children:[]});else if("sub_services"===l)for(const u in n){const h=n[u],b={label:u,value:h.cpu_usage?this.average(h.cpu_usage):0,children:this.transformToRawData(h).children};c.push(b)}else{const h={label:l,value:n.cpu_usage?this.average(n.cpu_usage):0,children:this.transformToRawData(n).children};c.push(h)}}return{label:o.id,value:t,children:c}}chatStyle(){const o=document.getElementById("analytics");if(o){let h=o.getElementsByTagName("h1"),p=o.getElementsByTagName("h2");for(var t=0;t<h.length;t++)h[t].style.fontSize="2em",h[t].style.fontWeight="bold";for(t=0;t<p.length;t++)p[t].style.fontSize="1.6em",p[t].style.fontWeight="bold"}const l=document.getElementById("mk-"+(this.messages.length-1));if(console.log(l),!l)return;let n=l.getElementsByTagName("h1"),u=l.getElementsByTagName("h2");for(t=0;t<n.length;t++)n[t].style.fontSize="2.5em",n[t].style.fontWeight="bold";for(t=0;t<u.length;t++)u[t].style.fontSize="2em",u[t].style.fontWeight="bold";this.scrollToBottom()}sendMessage(){var o=this;return(0,g.A)(function*(){if(o.aiAnalytic.length<=0){yield o.showLoading();const l=JSON.stringify(o.configurations),n=yield o.chat.sendMessage(l),u=o.messages.length;return o.messages.push({message:n.response.text(),from:"AI",id:u.toString()}),o.aiAnalytic.push({message:n.response.text(),from:"AI",id:u.toString()}),yield o.hideLoading(),console.log("AI Analytic:",o.aiAnalytic),void o.scrollToBottom()}const t=yield o.chat.sendMessage(o.message),c=o.messages.length;o.messages.push({message:o.message,from:"User",id:c.toString()}),o.messages.push({message:t.response.text(),from:"AI",id:c.toString()}),o.message="",o.scrollToBottom()})()}scrollToBottom(){if(this.messagesContainer)try{this.messagesContainer.nativeElement.scrollTop=this.messagesContainer.nativeElement.scrollHeight+1e7}catch(o){console.error("Error al hacer scroll:",o)}}toggleAiModal(){""!==this.message&&(this.aiModal=!this.aiModal,this.wasChatOpen=this.aiModal,this.sendMessage().then(()=>{this.chatStyle()}))}}return(a=m).\u0275fac=function(o){return new(o||a)(e.rXU(f.x),e.rXU(s.Xi),e.rXU(y.nX))},a.\u0275cmp=e.VBU({type:a,selectors:[["app-flame-graph-compare"]],viewQuery:function(o,t){if(1&o&&e.GBs(k,5),2&o){let c;e.mGM(c=e.lsd())&&(t.messagesContainer=c.first)}},decls:45,vars:12,consts:[["messagesContainer2",""],[3,"title"],[3,"fullscreen"],["slot","fixed",3,"ionRefresh"],[1,"lg:m-10","md:m-10"],["size","12","size-md","12","size-lg","12",1,"flex","flex-row","justify-center"],[1,"min-w-full","p-5"],[1,"text-5xl","font-bold"],["id","analytics",1,"text-white"],[1,"flex","flex-row","justify-center","items-center"],["size","9",1,"rounded-3xl","bg-gray-600","p-2"],["placeholder","Ask DevProbe AI .... ",1,"text-white",3,"ngModelChange","ngModel"],["size","3",1,"min-h-full"],[1,"min-w-full","min-h-full",3,"click"],["vertical","bottom","horizontal","end","slot","fixed",1,"m-2","z-10",3,"click"],[1,"bg-purple-300","p-4"],["name","chatbubble-outline",1,"w-full","h-full"],["id","ai-modal",1,"fixed","bottom-0","right-0","h-full","w-full","bg-black","bg-opacity-60","z-10","r"],[1,"h-full","md:h-3/4","lg:h-3/4","w-full","bg-gray-900","p-4","absolute","right-0","bottom-0","z-50","flex","flex-col","rounded-tl-2xl","rounded-tr-2xl"],[1,"w-full","bg-gray-500","flex","flex-row","justify-center","items-center","p-2","mb-2","rounded-3xl"],[1,"flex","flex-row","p-2","items-center","bg-gray-800","w-full","rounded-3xl","h-full"],[1,"text-white"],[1,"m-2"],[1,"flex","flex-row","justify-center","items-center","bg-gray-800","hover:bg-gray-600","w-1/6","h-full","rounded-3xl",3,"click"],["name","close-outline"],[1,"flex-grow","overflow-y-auto","bg-gray-400","p-2","rounded-3xl"],["class","flex flex-col",4,"ngFor","ngForOf"],[1,"flex","flex-row","mt-2","p-2"],["placeholder","Ask...",1,"flex-grow","bg-gray-700","rounded-2xl",3,"ngModelChange","ngModel"],[1,"m-1"],[1,"w-1/3","bg-gray-500","rounded-3xl","flex","flex-row","justify-center","items-center","hover:bg-gray-300",3,"click"],["size","12","size-md","4","size-lg","4","class","",4,"ngFor","ngForOf"],["size","12","size-md","4","size-lg","4",1,""],[1,"min-h-full"],[3,"config"],["size","12","size-md","6","size-lg","6","class","",4,"ngFor","ngForOf"],["size","12","size-md","6","size-lg","6",1,""],[1,"flex","flex-col"],["class","rounded-3xl bg-gray-800 w-2/3 m-1 ml-auto p-2",4,"ngIf"],["class","rounded-3xl bg-gray-500 w-2/3 m-1 p-2 pr-2",4,"ngIf"],[1,"rounded-3xl","bg-gray-800","w-2/3","m-1","ml-auto","p-2"],[1,"text-white","p-4","m-2"],[1,"rounded-3xl","bg-gray-500","w-2/3","m-1","p-2","pr-2"],[1,"text-white","p-4","m-2",3,"id"]],template:function(o,t){if(1&o){const c=e.RV6();e.nrm(0,"app-header-return",1),e.j41(1,"ion-content",2)(2,"ion-refresher",3),e.bIt("ionRefresh",function(n){return e.eBV(c),e.Njj(t.doRefresh(n))}),e.nrm(3,"ion-refresher-content"),e.k0s(),e.nrm(4,"app-title",1),e.DNE(5,T,2,1,"ion-row",4)(6,I,2,1,"ion-row",4),e.j41(7,"ion-row",4)(8,"ion-col",5)(9,"ion-card",6)(10,"ion-card-header")(11,"ion-card-title")(12,"h1",7),e.EFF(13,"DevProbe AI Analytic"),e.k0s()()(),e.j41(14,"ion-card-content"),e.Z7z(15,B,2,1,"markdown",8,e.fX1),e.k0s(),e.j41(17,"ion-card-content")(18,"ion-row",9)(19,"ion-col",10)(20,"ion-input",11),e.mxI("ngModelChange",function(n){return e.eBV(c),e.DH7(t.message,n)||(t.message=n),e.Njj(n)}),e.k0s()(),e.j41(21,"ion-col",12)(22,"ion-button",13),e.bIt("click",function(){return e.eBV(c),e.Njj(t.toggleAiModal())}),e.EFF(23,"Send"),e.k0s()()()()()()(),e.j41(24,"ion-fab",14),e.bIt("click",function(){return e.eBV(c),e.Njj(t.aiModal=!0)}),e.j41(25,"ion-avatar",15),e.nrm(26,"ion-icon",16),e.k0s()()(),e.j41(27,"div",17)(28,"div",18)(29,"div",19)(30,"div",20)(31,"h1",21),e.EFF(32,"DevProbe AI"),e.k0s()(),e.nrm(33,"div",22),e.j41(34,"div",23),e.bIt("click",function(){return e.eBV(c),e.Njj(t.aiModal=!1)}),e.nrm(35,"ion-icon",24),e.k0s()(),e.j41(36,"div",25,0),e.DNE(38,N,3,2,"div",26),e.k0s(),e.j41(39,"div",27)(40,"ion-textarea",28),e.mxI("ngModelChange",function(n){return e.eBV(c),e.DH7(t.message,n)||(t.message=n),e.Njj(n)}),e.k0s(),e.nrm(41,"div",29),e.j41(42,"div",30),e.bIt("click",function(){return e.eBV(c),e.Njj(t.sendMessage())}),e.j41(43,"span",21),e.EFF(44,"Send"),e.k0s()()()()()}2&o&&(e.Y8G("title","Compare Flame Graphs"),e.R7$(),e.Y8G("fullscreen",!0),e.R7$(3),e.Y8G("title","Compare Flame Graphs"),e.R7$(),e.vxM(5,t.lenDates>=3?5:-1),e.R7$(),e.vxM(6,t.lenDates<3?6:-1),e.R7$(9),e.Dyx(t.aiAnalytic),e.R7$(5),e.R50("ngModel",t.message),e.R7$(4),e.AVh("hidden",!t.wasChatOpen),e.R7$(3),e.AVh("hidden",!t.aiModal),e.R7$(11),e.Y8G("ngForOf",t.messages),e.R7$(2),e.R50("ngModel",t.message))},dependencies:[d.Sq,d.bT,v.BC,v.vS,s.mC,s.Jm,s.b_,s.I9,s.ME,s.tN,s.hU,s.W9,s.Q8,s.iq,s.$w,s.To,s.Ki,s.ln,s.nc,s.Gw,F.W,j.p,w.E,E.NN]}),m})()}];let U=(()=>{var a;class m{}return(a=m).\u0275fac=function(o){return new(o||a)},a.\u0275mod=e.$C({type:a}),a.\u0275inj=e.G2t({imports:[y.iI.forChild(S),y.iI]}),m})();var V=i(5553);let L=(()=>{var a;class m{}return(a=m).\u0275fac=function(o){return new(o||a)},a.\u0275mod=e.$C({type:a}),a.\u0275inj=e.G2t({imports:[d.MD,v.YN,s.bv,U,V.h,w.n,E.NN]}),m})()}}]);