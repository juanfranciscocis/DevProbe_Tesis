"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[1239],{1239:(O,L,r)=>{r.r(L),r.d(L,{LatencyTestPageModule:()=>E});var v=r(177),f=r(4341),c=r(7863),T=r(305),y=r(467),e=r(4438),R=r(9640),F=r(5092),h=r(4262),P=r(1626);let M=(()=>{var o;class u{constructor(t,n){this.firestore=t,this.http=n,this.ipApiURL="https://cors-ea3m.onrender.com/http://ip-api.com/json/"}getLocation(t){var n=this;return(0,y.A)(function*(){console.log(t);const s=yield n.http.get(n.ipApiURL+t[0].dst_addr).toPromise();for(let i=0;i<t.length;i++)t[i].toLatitude=s.lat,t[i].toLongitude=s.lon,t[i].cityTo=s.city,t[i].countryTo=s.country;const p=t.map(i=>n.http.get(n.ipApiURL+i.from).toPromise());return(yield Promise.all(p)).forEach((i,d)=>{t[d].fromLatitude=i.lat,t[d].fromLongitude=i.lon,t[d].cityFrom=i.city,t[d].countryFrom=i.country}),console.log(t),t})()}saveLocationResults(t,n,g,s){var p=this;return(0,y.A)(function*(){try{console.log(s,"ripeData");const m=(0,h.rJ)(p.firestore,"teams",t,"products",n,"ripe"),i=(0,h.H9)(m,g),d=s.map(a=>({from:a.from,dst_addr:a.dst_addr,latency:a.latency,cityFrom:a.cityFrom,countryFrom:a.countryFrom,cityTo:a.cityTo,countryTo:a.countryTo,fromLatitude:a.fromLatitude,fromLongitude:a.fromLongitude,toLatitude:a.toLatitude,toLongitude:a.toLongitude}));return yield(0,h.BN)(i,{data:d}),console.log("Data saved",{data:d}),!0}catch(m){return console.log(m),!1}})()}}return(o=u).\u0275fac=function(t){return new(t||o)(e.KVO(h._7),e.KVO(P.Qq))},o.\u0275prov=e.jDH({token:o,factory:o.\u0275fac,providedIn:"root"}),u})();var C=r(385),j=r(8453);function S(o,u){if(1&o&&(e.j41(0,"ion-item")(1,"ion-label"),e.EFF(2),e.k0s(),e.j41(3,"ion-label"),e.EFF(4),e.k0s(),e.j41(5,"ion-label"),e.EFF(6),e.k0s()()),2&o){const l=u.$implicit;e.R7$(2),e.Lme("FROM ",l.cityFrom,",",l.countryFrom,""),e.R7$(2),e.SpI("",l.latency," ms"),e.R7$(2),e.Lme(" TO ",l.cityTo,",",l.countryTo,"")}}const I=[{path:"",component:(()=>{var o;class u{constructor(t,n,g,s){this.ripeService=t,this.teamsService=n,this.loadingCtrl=g,this.locationService=s,this.host="portfoliojuanfranciscocisneros.web.app",this.description="NEW IONIC",this.type="ping",this.ripeResults=[]}ngOnInit(){}sendRequest(){var t=this;return(0,y.A)(function*(){yield t.showLoading(),console.log(t.host,t.description,t.type),yield t.ripeService.sendMeasurementRequest(t.host,t.description,t.type),yield t.hideLoading()})()}getResults(){var t=this;return(0,y.A)(function*(){yield t.showLoading(),t.ripeResults=[];const n=localStorage.getItem("user");if(!n)return;const s=JSON.parse(n).orgName;(yield t.ripeService.getMeasurementResults()).subscribe(function(){var p=(0,y.A)(function*(m){for(let i=0;i<m.length;i++)t.ripeResults.push({latency:m[i].avg,dst_addr:m[i].dst_addr,from:m[i].from,toLatitude:0,toLongitude:0,fromLatitude:0,fromLongitude:0,cityTo:"",countryTo:"",cityFrom:"",countryFrom:""});yield t.ripeService.saveMeasurementResults(s,"Web",t.description,t.ripeResults).then((0,y.A)(function*(){yield t.locationService.getLocation(t.ripeResults).then(i=>{t.ripeResults=i,t.locationService.saveLocationResults(s,"Web",t.description,i).then(function(){var d=(0,y.A)(function*(a){a&&(console.log("Data saved"),console.log(t.ripeResults),yield t.hideLoading())});return function(a){return d.apply(this,arguments)}}())})}))});return function(m){return p.apply(this,arguments)}}())})()}handleChange(t){this.type=t.detail.value}showLoading(){var t=this;return(0,y.A)(function*(){yield(yield t.loadingCtrl.create({})).present()})()}hideLoading(){var t=this;return(0,y.A)(function*(){yield t.loadingCtrl.dismiss()})()}}return(o=u).\u0275fac=function(t){return new(t||o)(e.rXU(R.Q),e.rXU(F.O),e.rXU(c.Xi),e.rXU(M))},o.\u0275cmp=e.VBU({type:o,selectors:[["app-latency-test"]],inputs:{host:"host",description:"description"},decls:27,vars:6,consts:[[3,"title"],[3,"fullscreen"],[1,"lg:m-10","md:m-10"],["size","12","size-md","4","size-lg","4",1,""],["label","Host Name","placeholder","Enter a host name","type","text","labelPlacement","stacked",1,"",3,"ngModelChange","ngModel"],["size","12","size-md","4","size-lg","4"],["label","Description","placeholder","Enter a description","type","text","labelPlacement","stacked",1,"",3,"ngModelChange","ngModel"],[3,"ionChange"],["value","ping"],["value","traceroute"],["size","12","size-md","12","size-lg","12",1,"flex","flex-row","justify-end"],["color","primary",1,"",3,"click"],["size","12","size-md","12","size-lg","12"],[4,"ngFor","ngForOf"]],template:function(t,n){1&t&&(e.nrm(0,"app-header",0),e.j41(1,"ion-content",1)(2,"ion-grid"),e.nrm(3,"app-title",0),e.j41(4,"ion-row",2)(5,"ion-col",3)(6,"ion-input",4),e.mxI("ngModelChange",function(s){return e.DH7(n.host,s)||(n.host=s),s}),e.k0s()(),e.j41(7,"ion-col",5)(8,"ion-input",6),e.mxI("ngModelChange",function(s){return e.DH7(n.description,s)||(n.description=s),s}),e.k0s()(),e.j41(9,"ion-col",5)(10,"ion-list")(11,"ion-item")(12,"ion-select",7),e.bIt("ionChange",function(s){return n.handleChange(s)}),e.j41(13,"ion-select-option",8),e.EFF(14,"Ping"),e.k0s(),e.j41(15,"ion-select-option",9),e.EFF(16,"Traceroute"),e.k0s()()()()()(),e.j41(17,"ion-row",2)(18,"ion-col",10)(19,"ion-button",11),e.bIt("click",function(){return n.sendRequest()}),e.EFF(20,"Add Test"),e.k0s(),e.j41(21,"ion-button",11),e.bIt("click",function(){return n.getResults()}),e.EFF(22,"Get Results"),e.k0s()()(),e.j41(23,"ion-row",2)(24,"ion-col",12)(25,"ion-list"),e.DNE(26,S,7,5,"ion-item",13),e.k0s()()()()()),2&t&&(e.Y8G("title","Latency Test"),e.R7$(),e.Y8G("fullscreen",!0),e.R7$(2),e.Y8G("title","Latency Test"),e.R7$(3),e.R50("ngModel",n.host),e.R7$(2),e.R50("ngModel",n.description),e.R7$(18),e.Y8G("ngForOf",n.ripeResults))},dependencies:[v.Sq,f.BC,f.vS,c.Jm,c.hU,c.W9,c.lO,c.$w,c.uz,c.he,c.nf,c.ln,c.Nm,c.Ip,c.Je,c.Gw,C.l,j.W]}),u})()}];let z=(()=>{var o;class u{}return(o=u).\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.$C({type:o}),o.\u0275inj=e.G2t({imports:[T.iI.forChild(I),T.iI]}),u})();var A=r(5553);let E=(()=>{var o;class u{}return(o=u).\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.$C({type:o}),o.\u0275inj=e.G2t({imports:[v.MD,f.YN,c.bv,z,A.h]}),u})()}}]);