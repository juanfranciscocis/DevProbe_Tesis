"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[5371],{5553:(O,b,n)=>{n.d(b,{h:()=>f});var m=n(177),s=n(7863),r=n(4438);let f=(()=>{var u;class e{}return(u=e).\u0275fac=function(P){return new(P||u)},u.\u0275mod=r.$C({type:u}),u.\u0275inj=r.G2t({imports:[m.MD,s.bv]}),e})()},8453:(O,b,n)=>{n.d(b,{W:()=>r});var m=n(4438),s=n(7863);let r=(()=>{var f;class u{constructor(){this.title="Title"}ngOnInit(){}}return(f=u).\u0275fac=function(g){return new(g||f)},f.\u0275cmp=m.VBU({type:f,selectors:[["app-title"]],inputs:{title:"title"},decls:4,vars:1,consts:[[1,"lg:m-10"],["size","12","size-md","6","size-lg","6"],[1,"text-4xl","lg:text-6xl","font-bold"]],template:function(g,P){1&g&&(m.j41(0,"ion-row",0)(1,"ion-col",1)(2,"h1",2),m.EFF(3),m.k0s()()()),2&g&&(m.R7$(3),m.JRh(P.title))},dependencies:[s.hU,s.ln]}),u})()},5371:(O,b,n)=>{n.r(b),n.d(b,{SettingsPageModule:()=>y});var m=n(177),s=n(4341),r=n(7863),f=n(7650),u=n(467),e=n(4438),g=n(4796),P=n(201),i=n(7473),a=n(385),o=n(8453);const p=[{path:"",component:(()=>{var d;class E{constructor(t,c,M,h,D,A){this.authService=t,this.router=c,this.alertCtrl=M,this.githubService=h,this.loadingCtrl=D,this.notificationService=A,this.gitKey="",this.repoName="",this.branchName="",this.owner="",this.user={},this.orgname="",this.version="1.10.200"}ngOnInit(){}ionViewWillEnter(){var t=this;return(0,u.A)(function*(){t.user=localStorage.getItem("user")?JSON.parse(localStorage.getItem("user")||"{}"):null,t.user?(t.orgname=t.user.orgName||"",yield t.getSyncRepo()):yield t.showAlert("No user found","Error")})()}logout(){var t=this;return(0,u.A)(function*(){yield t.authService.logoutUser(),yield t.router.navigate(["/login"])})()}getSyncRepo(){var t=this;return(0,u.A)(function*(){yield t.showLoading();const c=yield t.githubService.getSyncRepo(t.orgname);c&&(t.gitKey=c.key,t.repoName=c.repo,t.branchName=c.branch,t.owner=c.owner),yield t.hideLoading()})()}syncRepo(){var t=this;return(0,u.A)(function*(){yield t.showLoading(),t.gitKey&&t.repoName&&t.branchName&&t.owner&&""!==t.gitKey&&""!==t.repoName&&""!==t.branchName&&""!==t.owner?(yield t.githubService.syncRepo(t.orgname,t.gitKey,t.repoName,t.branchName,t.owner),yield t.hideLoading()):yield t.showAlert("Please fill in all fields","Error")})()}showAlert(t,c){var M=this;return(0,u.A)(function*(){yield(yield M.alertCtrl.create({header:c,message:t,buttons:["OK"]})).present()})()}showLoading(){var t=this;return(0,u.A)(function*(){yield(yield t.loadingCtrl.create({})).present()})()}hideLoading(){var t=this;return(0,u.A)(function*(){yield t.loadingCtrl.dismiss()})()}notify(){Notification.requestPermission().then(function(t){console.log("granted"===t?"Permission granted for notifications":"Permission denied for notifications")})}subscribe(){var t=this;return(0,u.A)(function*(){webpushr("fetch_id",function(){var c=(0,u.A)(function*(M){console.log("webpushr subscriber id: "+M),M?yield t.notificationService.saveNotificationID(t.user,M).then(function(){var h=(0,u.A)(function*(D){D&&(yield t.showAlert("Subscription saved successfully","Success"))});return function(D){return h.apply(this,arguments)}}()):yield t.showAlert("No subscription id found, please check browser permissions","Error")});return function(M){return c.apply(this,arguments)}}())})()}}return(d=E).\u0275fac=function(t){return new(t||d)(e.rXU(g.u),e.rXU(f.Ix),e.rXU(r.hG),e.rXU(P.p),e.rXU(r.Xi),e.rXU(i.J))},d.\u0275cmp=e.VBU({type:d,selectors:[["app-settings"]],decls:72,vars:10,consts:[[3,"title"],[3,"fullscreen"],[1,"lg:m-10","md:m-10"],["size","12","size-md","12","size-lg","12",1,"flex","flex-row","justify-center"],["color","danger",1,"min-w-full",3,"click"],["size","12","size-md","12","size-lg","12",1,""],[1,"p-5"],[1,"text-2xl"],[1,"text-white"],["href","https://github.com/settings/tokens",1,"text-blue-500"],["placeholder","Enter your key here...",1,"text-white",3,"ngModelChange","ngModel"],["placeholder","Enter your repo name here...",1,"text-white",3,"ngModelChange","ngModel"],["placeholder","Enter your branch name here...",1,"text-white",3,"ngModelChange","ngModel"],["color","primary",1,"min-w-full",3,"click"],[1,"w-full",3,"click"],["size","12",1,"flex","flex-row","justify-end","items-center"],[1,"text-sm"]],template:function(t,c){1&t&&(e.nrm(0,"app-header",0),e.j41(1,"ion-content",1)(2,"ion-grid"),e.nrm(3,"app-title",0),e.j41(4,"ion-row",2)(5,"ion-col",3)(6,"ion-button",4),e.bIt("click",function(){return c.logout()}),e.EFF(7,"Logout"),e.k0s()()(),e.nrm(8,"app-title",0),e.j41(9,"ion-row",2)(10,"ion-col",5)(11,"ion-card",6)(12,"ion-card",6)(13,"ion-card-title",7),e.EFF(14,"1. Add a GitHub Key"),e.k0s(),e.j41(15,"ion-card-content")(16,"p",8),e.EFF(17," Add a GitHub key to sync with your GitHub repo. You will be able to create tests with DevProbeAI. "),e.j41(18,"a",9),e.EFF(19,"Get A GitHub Key Here !!!"),e.k0s()()(),e.j41(20,"ion-card")(21,"ion-card-content")(22,"ion-label"),e.EFF(23,"GitHub Key"),e.k0s(),e.j41(24,"ion-input",10),e.mxI("ngModelChange",function(h){return e.DH7(c.gitKey,h)||(c.gitKey=h),h}),e.k0s()()()(),e.j41(25,"ion-card",6)(26,"ion-card-title",7),e.EFF(27,"2. Repo Name"),e.k0s(),e.j41(28,"ion-card-content")(29,"p",8),e.EFF(30," Add the name of the repo you want to sync with DevProbeAI. "),e.k0s()(),e.j41(31,"ion-card")(32,"ion-card-content")(33,"ion-label"),e.EFF(34,"Repo Name"),e.k0s(),e.j41(35,"ion-input",11),e.mxI("ngModelChange",function(h){return e.DH7(c.repoName,h)||(c.repoName=h),h}),e.k0s()()()(),e.j41(36,"ion-card",6)(37,"ion-card-title",7),e.EFF(38,"3. Branch Name"),e.k0s(),e.j41(39,"ion-card-content")(40,"p",8),e.EFF(41," Add the name of the branch you want to sync with DevProbeAI. "),e.k0s()(),e.j41(42,"ion-card")(43,"ion-card-content")(44,"ion-label"),e.EFF(45,"Branch Name"),e.k0s(),e.j41(46,"ion-input",12),e.mxI("ngModelChange",function(h){return e.DH7(c.branchName,h)||(c.branchName=h),h}),e.k0s()()()(),e.j41(47,"ion-card",6)(48,"ion-card-title",7),e.EFF(49,"4. Owner Name"),e.k0s(),e.j41(50,"ion-card-content")(51,"p",8),e.EFF(52," Add the name of the owner of the repo you want to sync with DevProbeAI. "),e.k0s()(),e.j41(53,"ion-card")(54,"ion-card-content")(55,"ion-label"),e.EFF(56,"Owner Name"),e.k0s(),e.j41(57,"ion-input",12),e.mxI("ngModelChange",function(h){return e.DH7(c.owner,h)||(c.owner=h),h}),e.k0s()()()(),e.j41(58,"ion-button",13),e.bIt("click",function(){return c.syncRepo()}),e.EFF(59,"Sync Repo"),e.k0s()()()(),e.nrm(60,"app-title",0),e.j41(61,"ion-row",2)(62,"ion-col",5)(63,"p"),e.EFF(64,"Receive push notifications when new data is available. Like new tests, incidents, etc."),e.k0s()(),e.j41(65,"ion-col",3)(66,"ion-button",14),e.bIt("click",function(){return c.subscribe()}),e.EFF(67,"Subscribe"),e.k0s()()(),e.j41(68,"ion-row")(69,"ion-col",15)(70,"h1",16),e.EFF(71),e.k0s()()()()()),2&t&&(e.Y8G("title","Settings"),e.R7$(),e.Y8G("fullscreen",!0),e.R7$(2),e.Y8G("title","Account SingOut"),e.R7$(5),e.Y8G("title","Sync GitHub Repo"),e.R7$(16),e.R50("ngModel",c.gitKey),e.R7$(11),e.R50("ngModel",c.repoName),e.R7$(11),e.R50("ngModel",c.branchName),e.R7$(11),e.R50("ngModel",c.owner),e.R7$(3),e.Y8G("title","Receive Push Notifications"),e.R7$(11),e.SpI("Version: ",c.version,""))},dependencies:[s.BC,s.vS,r.Jm,r.b_,r.I9,r.tN,r.hU,r.W9,r.lO,r.$w,r.he,r.ln,r.Gw,a.l,o.W]}),E})()}];let _=(()=>{var d;class E{}return(d=E).\u0275fac=function(t){return new(t||d)},d.\u0275mod=e.$C({type:d}),d.\u0275inj=e.G2t({imports:[f.iI.forChild(p),f.iI]}),E})();var v=n(5553);let y=(()=>{var d;class E{}return(d=E).\u0275fac=function(t){return new(t||d)},d.\u0275mod=e.$C({type:d}),d.\u0275inj=e.G2t({imports:[m.MD,s.YN,r.bv,_,v.h]}),E})()},4796:(O,b,n)=>{n.d(b,{u:()=>u});var m=n(467),s=n(8737),r=n(4262),f=n(4438);let u=(()=>{var e;class g{constructor(i,a){this.auth=i,this.firestore=a}registerUser(i){var a=this;return(0,m.A)(function*(){try{const o=yield(0,s.eJ)(a.auth,i.email,i.password);return o.user?(yield(0,r.BN)((0,r.H9)(a.firestore,"users",o.user.uid),{email:i.email,name:i.name,orgName:i.orgName,uid:o.user.uid}),yield(0,r.BN)((0,r.H9)(a.firestore,"teams",`${i.orgName}`),{name:i.orgName,members:[o.user.uid]}),o):null}catch{return null}})()}loginUser(i){var a=this;return(0,m.A)(function*(){try{var o;const l=yield(0,s.x9)(a.auth,i.email,i.password);if(null!==(o=l.user)&&void 0!==o&&o.uid){const p=yield(0,r.x7)((0,r.H9)(a.firestore,"users",l.user.uid));if(p.exists())return localStorage.setItem("user",JSON.stringify(p.data())),l}}catch(l){console.error(l)}return null})()}logoutUser(){var i=this;return(0,m.A)(function*(){yield i.auth.signOut()})()}addMember(i){var a=this;return(0,m.A)(function*(){try{const o=yield(0,s.eJ)(a.auth,i.email,i.password);if(!o.user)return!1;const l={email:i.email,name:i.name,orgName:i.orgName,uid:o.user.uid};return yield(0,r.BN)((0,r.H9)(a.firestore,"users",o.user.uid),l),l}catch{return!1}})()}}return(e=g).\u0275fac=function(i){return new(i||e)(f.KVO(s.Nj),f.KVO(r._7))},e.\u0275prov=f.jDH({token:e,factory:e.\u0275fac,providedIn:"root"}),g})()},7473:(O,b,n)=>{n.d(b,{J:()=>e});var m=n(467),s=n(4262),r=n(4438),f=n(1626),u=n(5092);let e=(()=>{var g;class P{constructor(a,o,l){this.firestore=a,this.http=o,this.teamService=l}saveNotificationID(a,o){var l=this;return(0,m.A)(function*(){const p=(0,s.H9)(l.firestore,"users",a.uid),_=yield(0,s.x7)(p);if(_.exists()){const v=_.data();return v.notificationID=o,yield(0,s.BN)(p,v),!0}return console.log("No such document!"),!1})()}getNotificationUser(a){var o=this;return(0,m.A)(function*(){const l=(0,s.H9)(o.firestore,"users",a.uid),p=yield(0,s.x7)(l);if(p.exists()){const _=p.data();return _.notificationID?_.notificationID:""}return console.log("No such document!"),null})()}notifyIncidentToUser(a,o){var l=this;return(0,m.A)(function*(){try{const _=(yield l.teamService.getTeamByOrganization(o)).filter(y=>a.includes(y.name));console.log("team",_);const v="https://devprobeapi.onrender.com/sendNotification";for(let y of _){let d=yield l.getNotificationUser(y);if(console.log("sid",d),""!==d){const S={sid:d,title:"New Incident",type:"new_incident",message:`Hey ${y.name}, you have been assigned a new incident`,target:"https://devprobe-89481.web.app/incident-manager-chooser"};yield l.http.post(v,S).toPromise(),console.log("Notification sent successfully")}else console.log("no sid")}}catch(p){console.log(p)}})()}}return(g=P).\u0275fac=function(a){return new(a||g)(r.KVO(s._7),r.KVO(f.Qq),r.KVO(u.O))},g.\u0275prov=r.jDH({token:g,factory:g.\u0275fac,providedIn:"root"}),P})()},5092:(O,b,n)=>{n.d(b,{O:()=>u});var m=n(467),s=n(4262),r=n(4438),f=n(4796);let u=(()=>{var e;class g{constructor(i,a){this.firestore=i,this.authService=a}getTeamByOrganization(i){var a=this;return(0,m.A)(function*(){let o=(0,s.H9)(a.firestore,"teams",i);const _=(yield(0,s.x7)(o)).data();let v=[];for(let y=0;y<_.members.length;y++){o=(0,s.H9)(a.firestore,"users",_.members[y]);const E=(yield(0,s.x7)(o)).data();v.push(E)}return v})()}removeMember(i,a){var o=this;return(0,m.A)(function*(){try{let l=(0,s.H9)(o.firestore,"teams",i);const v=(yield(0,s.x7)(l)).data();let y=v.members.filter(E=>E!==a);return yield(0,s.BN)(l,{name:v.name,members:y}),l=(0,s.H9)(o.firestore,"users",a),yield(0,s.BN)(l,{}),yield o.authService,!0}catch{return!1}})()}addMember(i){var a=this;return(0,m.A)(function*(){try{const o=yield a.authService.addMember(i);if(!o)return!1;const l=(0,s.H9)(a.firestore,"teams",i.orgName),_=(yield(0,s.x7)(l)).data();console.log(_);const v=_;let y=v.members;return y.push(o.uid),console.log(y),yield(0,s.mZ)(l,{name:v.name,members:y}),o.uid}catch{return!1}})()}}return(e=g).\u0275fac=function(i){return new(i||e)(r.KVO(s._7),r.KVO(f.u))},e.\u0275prov=r.jDH({token:e,factory:e.\u0275fac,providedIn:"root"}),g})()}}]);