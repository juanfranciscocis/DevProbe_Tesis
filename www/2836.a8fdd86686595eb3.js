"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[2836],{5553:(F,M,g)=>{g.d(M,{h:()=>_});var T=g(177),P=g(7863),m=g(4438);let _=(()=>{var j;class t{}return(j=t).\u0275fac=function(R){return new(R||j)},j.\u0275mod=m.$C({type:j}),j.\u0275inj=m.G2t({imports:[T.MD,P.bv]}),t})()},3241:(F,M,g)=>{g.d(M,{p:()=>_});var T=g(4438),P=g(177),m=g(7863);let _=(()=>{var j;class t{constructor(R){this.location=R,this.title="Header Title"}ngOnInit(){}goBack(){this.location.back()}}return(j=t).\u0275fac=function(R){return new(R||j)(T.rXU(P.aZ))},j.\u0275cmp=T.VBU({type:j,selectors:[["app-header-return"]],inputs:{title:"title"},decls:6,vars:2,consts:[[3,"translucent"],["slot","start","menu","menu-id"],["name","arrow-back","slot","start",1,"p-4","bigger-icon",3,"click"]],template:function(R,O){1&R&&(T.j41(0,"ion-header",0)(1,"ion-toolbar"),T.nrm(2,"ion-menu-button",1),T.j41(3,"ion-icon",2),T.bIt("click",function(){return O.goBack()}),T.k0s(),T.j41(4,"ion-title"),T.EFF(5),T.k0s()()()),2&R&&(T.Y8G("translucent",!0),T.R7$(5),T.JRh(O.title))},dependencies:[m.eU,m.iq,m.MC,m.BC,m.ai],styles:[".bigger-icon[_ngcontent-%COMP%]{font-size:1.5em}"]}),t})()},2836:(F,M,g)=>{g.r(M),g.d(M,{LoadTestPageModule:()=>Z});var T=g(177),P=g(4341),m=g(7863),_=g(7650),j=g(467),t=g(4438),v=g(4262);class R{static toArtilleryData(n){return function x(s,n){return L(s,n,N)}(JSON.parse(n),b("ArtilleryData"))}static artilleryDataToJson(n){return JSON.stringify(function I(s,n){return L(s,n,$)}(n,b("ArtilleryData")),null,2)}}function O(s,n,p,e=""){const r=D(s);throw Error(`Invalid value${p?` for key "${p}"`:""}${e?` on ${e}`:""}. Expected ${r} but got ${JSON.stringify(n)}`)}function D(s){return Array.isArray(s)?2===s.length&&void 0===s[0]?`an optional ${D(s[1])}`:`one of [${s.map(n=>D(n)).join(", ")}]`:"object"==typeof s&&void 0!==s.literal?s.literal:typeof s}function N(s){if(void 0===s.jsonToJS){const n={};s.props.forEach(p=>n[p.json]={key:p.js,typ:p.typ}),s.jsonToJS=n}return s.jsonToJS}function $(s){if(void 0===s.jsToJSON){const n={};s.props.forEach(p=>n[p.js]={key:p.json,typ:p.typ}),s.jsToJSON=n}return s.jsToJSON}function L(s,n,p,e="",r=""){if("any"===n)return s;if(null===n)return null===s?s:O(n,s,e,r);if(!1===n)return O(n,s,e,r);let a;for(;"object"==typeof n&&void 0!==n.ref;)a=n.ref,n=W[n.ref];return Array.isArray(n)?function i(o,f){return-1!==o.indexOf(f)?f:O(o.map(d=>S(d)),f,e,r)}(n,s):"object"==typeof n?n.hasOwnProperty("unionMembers")?function u(o,f){const d=o.length;for(let C=0;C<d;C++){const A=o[C];try{return L(f,A,p)}catch{}}return O(o,f,e,r)}(n.unionMembers,s):n.hasOwnProperty("arrayItems")?function h(o,f){return Array.isArray(f)?f.map(d=>L(d,o,p)):O(S("array"),f,e,r)}(n.arrayItems,s):n.hasOwnProperty("props")?function y(o,f,d){if(null===d||"object"!=typeof d||Array.isArray(d))return O(S(a||"object"),d,e,r);const C={};return Object.getOwnPropertyNames(o).forEach(A=>{const k=o[A],H=Object.prototype.hasOwnProperty.call(d,A)?d[A]:void 0;C[k.key]=void 0!==H?L(H,k.typ,p,A,a):void 0}),Object.getOwnPropertyNames(d).forEach(A=>{Object.prototype.hasOwnProperty.call(o,A)||(C[A]=L(d[A],f,p,A,a))}),C}(p(n),n.additional,s):O(n,s,e,r):n===Date&&"number"!=typeof s?function c(o){if(null===o)return null;const f=new Date(o);return isNaN(f.valueOf())?O(S("Date"),o,e,r):f}(s):function l(o,f){return typeof o==typeof f?f:O(o,f,e,r)}(n,s)}function S(s){return{literal:s}}function E(s,n){return{props:s,additional:n}}function w(s){return{props:[],additional:s}}function b(s){return{ref:s}}const W={ArtilleryData:E([{json:"aggregate",js:"aggregate",typ:b("Aggregate")},{json:"intermediate",js:"intermediate",typ:function G(s){return{arrayItems:s}}(b("Intermediate"))},{json:"date",js:"date",typ:""}],!1),Aggregate:E([{json:"counters",js:"counters",typ:w(0)},{json:"rates",js:"rates",typ:b("Rates")},{json:"firstCounterAt",js:"firstCounterAt",typ:0},{json:"firstHistogramAt",js:"firstHistogramAt",typ:0},{json:"lastCounterAt",js:"lastCounterAt",typ:0},{json:"lastHistogramAt",js:"lastHistogramAt",typ:0},{json:"firstMetricAt",js:"firstMetricAt",typ:0},{json:"lastMetricAt",js:"lastMetricAt",typ:0},{json:"period",js:"period",typ:0},{json:"summaries",js:"summaries",typ:b("Histograms")},{json:"histograms",js:"histograms",typ:b("Histograms")}],!1),Histograms:E([{json:"http.response_time",js:"http.response_time",typ:w(3.14)},{json:"plugins.metrics-by-endpoint.response_time./",js:"plugins.metrics-by-endpoint.response_time./",typ:w(3.14)},{json:"vusers.session_length",js:"vusers.session_length",typ:function U(...s){return{unionMembers:s}}(void 0,w(3.14))}],!1),Rates:E([{json:"http.request_rate",js:"http.request_rate",typ:0}],!1),Intermediate:E([{json:"counters",js:"counters",typ:w(0)},{json:"rates",js:"rates",typ:b("Rates")},{json:"http.request_rate",js:"http.request_rate",typ:null},{json:"firstCounterAt",js:"firstCounterAt",typ:0},{json:"firstHistogramAt",js:"firstHistogramAt",typ:0},{json:"lastCounterAt",js:"lastCounterAt",typ:0},{json:"lastHistogramAt",js:"lastHistogramAt",typ:0},{json:"firstMetricAt",js:"firstMetricAt",typ:0},{json:"lastMetricAt",js:"lastMetricAt",typ:0},{json:"period",js:"period",typ:""},{json:"summaries",js:"summaries",typ:b("Histograms")},{json:"histograms",js:"histograms",typ:b("Histograms")}],!1)};var B=g(1626);let J=(()=>{var s;class n{constructor(e,r){this.firestore=e,this.http=r,this.url="https://devprobeapi.onrender.com/create_load_test"}getLoadTestHistory(e,r,l){var u=this;return(0,j.A)(function*(){const i=(0,v.H9)(u.firestore,"teams",e,"products",r,"load_test",l),h=yield(0,v.x7)(i);if(h.exists()){let c=h.data();console.log(c);let y=Object.keys(c);console.log(y);for(let a of y)c[a]=R.toArtilleryData(c[a]);return c}return{}})()}sendLoadTest(e,r,l,u){var i=this;return(0,j.A)(function*(){try{const h={team:e,product:r,service:l,target:`https://${u}`};return yield i.http.post(i.url,h).toPromise()}catch{return{}}})()}}return(s=n).\u0275fac=function(e){return new(e||s)(t.KVO(v._7),t.KVO(B.Qq))},s.\u0275prov=t.jDH({token:s,factory:s.\u0275fac,providedIn:"root"}),n})();var z=g(8453),K=g(3241),X=g(2820);function Y(s,n){if(1&s){const p=t.RV6();t.j41(0,"ion-item",17),t.bIt("click",function(){const r=t.eBV(p).$implicit,l=t.XpG();return t.Njj(l.viewHistory(r))}),t.j41(1,"ion-label"),t.EFF(2),t.k0s(),t.nrm(3,"ion-icon",18),t.k0s()}if(2&s){const p=n.$implicit;t.R7$(2),t.JRh(p)}}const V=[{path:"",component:(()=>{var s;class n{constructor(e,r,l,u,i){this.router=e,this.activatedRoute=r,this.loadTestService=l,this.loadingCtrl=u,this.alertCtrl=i,this.productStep="",this.productObjective="",this.orgName="",this.target="",this.description="",this.loadTestResults={},this.totalNumberOfRequests=0,this.statusCodesOptions={tooltip:{trigger:"axis"},xAxis:{type:"category",boundaryGap:!1,data:[]},yAxis:{type:"value"},series:[]},this.responseTimeOptions={tooltip:{trigger:"axis"},xAxis:{type:"category",boundaryGap:!1,data:[]},yAxis:{type:"value"},series:[]},this.listOfDates=[]}ngOnInit(){}ionViewWillEnter(){var e=this;return(0,j.A)(function*(){yield e.showLoading(),e.getParams(),yield e.getHistoryResults().then(()=>{e.plotCodes(),e.totalRequests(),e.responseTime()}),yield e.hideLoading()})()}getParams(){this.activatedRoute.params.subscribe(r=>{this.productObjective=r.productObjective,this.productStep=r.step});const e=JSON.parse(localStorage.getItem("user"));this.orgName=e.orgName,console.log(this.orgName),console.log(this.productObjective),console.log(this.productStep)}sendRequest(){var e=this;return(0,j.A)(function*(){if(yield e.showLoading(),e.target.startsWith("http://")||e.target.startsWith("https://")||e.target.endsWith("/"))return yield e.hideLoading(),void(yield e.showAlert("No http or https is needed, check for slashes at the end of the domain","Please enter a valid host"));yield e.loadTestService.sendLoadTest(e.orgName,e.productObjective,e.productStep,e.target).then(function(){var r=(0,j.A)(function*(l){yield e.hideLoading(),console.log("data",l),l&&(yield e.showAlert("Test sent, please wait a few seconds to GET RESULTS","Success"))});return function(l){return r.apply(this,arguments)}}()),yield e.hideLoading()})()}getHistoryResults(){var e=this;return(0,j.A)(function*(){e.loadTestResults=yield e.loadTestService.getLoadTestHistory(e.orgName,e.productObjective,e.productStep)})()}totalRequests(){let e=Object.keys(this.loadTestResults),r={},l=0;for(let u of e){let i=this.loadTestResults[u].aggregate.counters,h=this.loadTestResults[u].date,c=Object.keys(i).filter(y=>y.startsWith("http.requests"));for(let y of c)r[h]||(r[h]={}),r[h][y]=(r[h][y]||0)+i[y]}for(let u of Object.keys(r))l+=r[u]["http.requests"];this.totalNumberOfRequests=l}byCodes(){let e=Object.keys(this.loadTestResults),r={};for(let l of e){let u=this.loadTestResults[l].aggregate.counters,i=this.loadTestResults[l].date.split("-").slice(0,3).join("-"),h=Object.keys(u).filter(c=>c.startsWith("http.codes."));r[i]||(r[i]={});for(let c of h)r[i][c]=(r[i][c]||0)+u[c]}return r=this.ordenarDiccionarioPorFechas(r),r}normalizarFecha(e){const[r,l,u]=e.split("-").map(c=>parseInt(c,10));return`${r}-${l<10?`0${l}`:l.toString()}-${u<10?`0${u}`:u.toString()}`}ordenarDiccionarioPorFechas(e){const l=Object.keys(e).sort((i,h)=>{const c=new Date(this.normalizarFecha(i)),y=new Date(this.normalizarFecha(h));return c.getTime()-y.getTime()}),u={};return l.forEach(i=>{u[i]=e[i]}),u}plotCodes(){var e=this;return(0,j.A)(function*(){let r=e.byCodes();console.log(r);let l=Object.keys(r);e.listOfDates=l;let u=new Set;for(let y of l){let o=Object.keys(r[y]);for(let f of o)u.add(f)}let i={};for(let y in r){let a=r[y];for(let o of u)i[o]||(i[o]=[]),i[o].push(a[o]||0)}let h=["#36b311","#306fc6","#ed3b3b","#f4ba20"];for(let y in i){let o,a=y.split(".").pop();null!=a&&a.startsWith("2")&&(o=h[0]),null!=a&&a.startsWith("3")&&(o=h[1]),null!=a&&a.startsWith("4")&&(o=h[2]),null!=a&&a.startsWith("5")&&(o=h[3]),o||(o="#000000"),e.statusCodesOptions.series.push({name:y,type:"line",data:i[y],lineStyle:{color:o},itemStyle:{color:o}})}e.statusCodesOptions.xAxis={type:"category",boundaryGap:!1,data:l},e.statusCodesOptions={...e.statusCodesOptions};let c=document.getElementById("httpCodesChart");console.log(c),c.style.width="100%",c.style.height="25em"})()}responseTime(){let e=Object.keys(this.loadTestResults),r={};for(let a of e){let o=this.loadTestResults[a].aggregate.histograms,f=this.loadTestResults[a].date,d=Object.keys(o).filter(C=>C.startsWith("http.response_time"));for(let C of d)r[f]=o[C]}let l=Object.entries(r).reduce((a,[o,f])=>{const d=o.split("-").slice(0,3).join("-");return a[d]=a[d]||[],a[d].push(f),a},{}),u=Object.keys(l).sort((a,o)=>new Date(a).getTime()-new Date(o).getTime()),i={count:0,max:0,min:0,mean:0,median:0,p50:0,p90:0,p95:0,p99:0,p999:0},h={};u.forEach(a=>{let o={count:0,max:0,min:0,mean:0,median:0,p50:0,p90:0,p95:0,p99:0,p999:0},f=0;l[a].forEach(d=>{o.count+=d.count,o.max+=d.max,o.min+=d.min,o.mean+=d.mean,o.median+=d.median,o.p50+=d.p50,o.p90+=d.p90,o.p95+=d.p95,o.p99+=d.p99,o.p999+=d.p999,f++});for(let d in o)"count"!==d&&f>0&&(o[d]=o[d]/f);h[a]=o,i.count+=o.count,i.max+=o.max,i.min+=o.min,i.mean+=o.mean,i.median+=o.median,i.p50+=o.p50,i.p90+=o.p90,i.p95+=o.p95,i.p99+=o.p99,i.p999+=o.p999});let c=u.length;c>0&&(i.mean/=c,i.median/=c,i.p50/=c,i.p90/=c,i.p95/=c,i.p99/=c,i.p999/=c,i.max/=c,i.min/=c);for(let a in i)"count"===a||"p90"===a||"p50"===a||"p999"===a||this.responseTimeOptions.series.push({name:a,type:"bar",data:[i[a]],label:{show:!0,formatter:o=>`${o.value.toFixed(2)} ms`}});this.responseTimeOptions.xAxis={type:"category",boundaryGap:!1,data:["Category"]},this.responseTimeOptions={...this.responseTimeOptions};let y=document.getElementById("httpResponseTimeChart");console.log(y),y.style.width="100%",y.style.height="25em"}showLoading(){var e=this;return(0,j.A)(function*(){yield(yield e.loadingCtrl.create({})).present()})()}hideLoading(){var e=this;return(0,j.A)(function*(){yield e.loadingCtrl.dismiss()})()}showAlert(e,r){var l=this;return(0,j.A)(function*(){const u=yield l.alertCtrl.create({header:r,message:e,buttons:["OK"]});return yield u.present(),yield u.onDidDismiss(),!0})()}viewHistory(e){}}return(s=n).\u0275fac=function(e){return new(e||s)(t.rXU(_.Ix),t.rXU(_.nX),t.rXU(J),t.rXU(m.Xi),t.rXU(m.hG))},s.\u0275cmp=t.VBU({type:s,selectors:[["app-load-test"]],decls:43,vars:13,consts:[[3,"title"],[3,"fullscreen"],[1,"lg:m-10","md:m-10"],["size","12"],["label","Target","placeholder","Enter a target","type","text","labelPlacement","stacked",1,"",3,"ngModelChange","ngModel"],["size","12","size-md","12","size-lg","12",1,"flex","flex-row","justify-end"],["color","primary","size","small",1,"",3,"click"],["name","add"],[1,"w-full","p-6","flex","flex-col","justify-center","items-center"],[1,"text-3xl"],[1,"text-2xl","text-white"],[1,"h-[25em]","w-full"],["id","httpCodesChart","echarts","",1,"demo-chart","h-full","w-full",3,"options"],["id","httpResponseTimeChart","echarts","",1,"demo-chart","h-full","w-full",3,"options"],["size","12",1,"w-full"],[1,"w-full"],["class","w-full",3,"click",4,"ngFor","ngForOf"],[1,"w-full",3,"click"],["name","arrow-forward","color","primary"]],template:function(e,r){1&e&&(t.nrm(0,"app-header-return",0),t.j41(1,"ion-content",1)(2,"ion-grid"),t.nrm(3,"app-title",0),t.j41(4,"ion-row",2)(5,"ion-col",3)(6,"ion-card")(7,"ion-card-content")(8,"ion-input",4),t.mxI("ngModelChange",function(u){return t.DH7(r.target,u)||(r.target=u),u}),t.k0s()()()()(),t.j41(9,"ion-row",2)(10,"ion-col",5)(11,"ion-button",6),t.bIt("click",function(){return r.sendRequest()}),t.EFF(12,"Load Target "),t.nrm(13,"ion-icon",7),t.k0s()()(),t.nrm(14,"app-title",0),t.j41(15,"ion-row",2)(16,"ion-card",8)(17,"ion-card-header")(18,"ion-card-title",9),t.EFF(19,"Total Number of Requests"),t.k0s()(),t.j41(20,"ion-card-content")(21,"h1",10),t.EFF(22),t.nI1(23,"number"),t.k0s()()()(),t.j41(24,"ion-row",2)(25,"ion-card",8)(26,"ion-card-header")(27,"ion-card-title",9),t.EFF(28,"HTTP Status Codes"),t.k0s()(),t.j41(29,"ion-card-content",11),t.nrm(30,"div",12),t.k0s()()(),t.j41(31,"ion-row",2)(32,"ion-card",8)(33,"ion-card-header")(34,"ion-card-title",9),t.EFF(35,"HTTP Response Time"),t.k0s()(),t.j41(36,"ion-card-content",11),t.nrm(37,"div",13),t.k0s()()(),t.nrm(38,"app-title",0),t.j41(39,"ion-row",2)(40,"ion-col",14)(41,"ion-list",15),t.DNE(42,Y,4,1,"ion-item",16),t.k0s()()()()()),2&e&&(t.Y8G("title","Load Test  For "+r.productStep),t.R7$(),t.Y8G("fullscreen",!0),t.R7$(2),t.Y8G("title","New Load Test"),t.R7$(5),t.R50("ngModel",r.target),t.R7$(6),t.Y8G("title","Analytics For "+r.productStep),t.R7$(8),t.JRh(t.i5U(23,10,r.totalNumberOfRequests,"1.0-0")),t.R7$(8),t.Y8G("options",r.statusCodesOptions),t.R7$(7),t.Y8G("options",r.responseTimeOptions),t.R7$(),t.Y8G("title","Results for date: "),t.R7$(4),t.Y8G("ngForOf",r.listOfDates))},dependencies:[T.Sq,P.BC,P.vS,m.Jm,m.b_,m.I9,m.ME,m.tN,m.hU,m.W9,m.lO,m.iq,m.$w,m.uz,m.he,m.nf,m.ln,m.Gw,z.W,K.p,X.$P,T.QX]}),n})()}];let q=(()=>{var s;class n{}return(s=n).\u0275fac=function(e){return new(e||s)},s.\u0275mod=t.$C({type:s}),s.\u0275inj=t.G2t({imports:[_.iI.forChild(V),_.iI]}),n})();var Q=g(5553);let Z=(()=>{var s;class n{}return(s=n).\u0275fac=function(e){return new(e||s)},s.\u0275mod=t.$C({type:s}),s.\u0275inj=t.G2t({imports:[T.MD,P.YN,m.bv,q,Q.h]}),n})()}}]);