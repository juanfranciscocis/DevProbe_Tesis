"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[2836],{5553:(w,E,u)=>{u.d(E,{h:()=>b});var g=u(177),P=u(7863),d=u(4438);let b=(()=>{var f;class s{}return(f=s).\u0275fac=function(A){return new(A||f)},f.\u0275mod=d.$C({type:f}),f.\u0275inj=d.G2t({imports:[g.MD,P.bv]}),s})()},3241:(w,E,u)=>{u.d(E,{p:()=>b});var g=u(4438),P=u(177),d=u(7863);let b=(()=>{var f;class s{constructor(A){this.location=A,this.title="Header Title"}ngOnInit(){}goBack(){this.location.back()}}return(f=s).\u0275fac=function(A){return new(A||f)(g.rXU(P.aZ))},f.\u0275cmp=g.VBU({type:f,selectors:[["app-header-return"]],inputs:{title:"title"},decls:6,vars:2,consts:[[3,"translucent"],["slot","start","menu","menu-id"],["name","arrow-back","slot","start",1,"p-4","bigger-icon",3,"click"]],template:function(A,O){1&A&&(g.j41(0,"ion-header",0)(1,"ion-toolbar"),g.nrm(2,"ion-menu-button",1),g.j41(3,"ion-icon",2),g.bIt("click",function(){return O.goBack()}),g.k0s(),g.j41(4,"ion-title"),g.EFF(5),g.k0s()()()),2&A&&(g.Y8G("translucent",!0),g.R7$(5),g.JRh(O.title))},dependencies:[d.eU,d.iq,d.MC,d.BC,d.ai],styles:[".bigger-icon[_ngcontent-%COMP%]{font-size:1.5em}"]}),s})()},2836:(w,E,u)=>{u.r(E),u.d(E,{LoadTestPageModule:()=>q});var g=u(177),P=u(4341),d=u(7863),b=u(7650),f=u(467),s=u(4438),M=u(4262);class A{static toArtilleryData(o){return function F(t,o){return v(t,o,U)}(JSON.parse(o),R("ArtilleryData"))}static artilleryDataToJson(o){return JSON.stringify(function x(t,o){return v(t,o,$)}(o,R("ArtilleryData")),null,2)}}function O(t,o,l,e=""){const r=_(t);throw Error(`Invalid value${l?` for key "${l}"`:""}${e?` on ${e}`:""}. Expected ${r} but got ${JSON.stringify(o)}`)}function _(t){return Array.isArray(t)?2===t.length&&void 0===t[0]?`an optional ${_(t[1])}`:`one of [${t.map(o=>_(o)).join(", ")}]`:"object"==typeof t&&void 0!==t.literal?t.literal:typeof t}function U(t){if(void 0===t.jsonToJS){const o={};t.props.forEach(l=>o[l.json]={key:l.js,typ:l.typ}),t.jsonToJS=o}return t.jsonToJS}function $(t){if(void 0===t.jsToJSON){const o={};t.props.forEach(l=>o[l.js]={key:l.json,typ:l.typ}),t.jsToJSON=o}return t.jsToJSON}function v(t,o,l,e="",r=""){if("any"===o)return t;if(null===o)return null===t?t:O(o,t,e,r);if(!1===o)return O(o,t,e,r);let p;for(;"object"==typeof o&&void 0!==o.ref;)p=o.ref,o=G[o.ref];return Array.isArray(o)?function j(n,i){return-1!==n.indexOf(i)?i:O(n.map(T=>N(T)),i,e,r)}(o,t):"object"==typeof o?o.hasOwnProperty("unionMembers")?function c(n,i){const T=n.length;for(let L=0;L<T;L++){const C=n[L];try{return v(i,C,l)}catch{}}return O(n,i,e,r)}(o.unionMembers,t):o.hasOwnProperty("arrayItems")?function y(n,i){return Array.isArray(i)?i.map(T=>v(T,n,l)):O(N("array"),i,e,r)}(o.arrayItems,t):o.hasOwnProperty("props")?function m(n,i,T){if(null===T||"object"!=typeof T||Array.isArray(T))return O(N(p||"object"),T,e,r);const L={};return Object.getOwnPropertyNames(n).forEach(C=>{const H=n[C],I=Object.prototype.hasOwnProperty.call(T,C)?T[C]:void 0;L[H.key]=void 0!==I?v(I,H.typ,l,C,p):void 0}),Object.getOwnPropertyNames(T).forEach(C=>{Object.prototype.hasOwnProperty.call(n,C)||(L[C]=v(T[C],i,l,C,p))}),L}(l(o),o.additional,t):O(o,t,e,r):o===Date&&"number"!=typeof t?function h(n){if(null===n)return null;const i=new Date(n);return isNaN(i.valueOf())?O(N("Date"),n,e,r):i}(t):function a(n,i){return typeof n==typeof i?i:O(n,i,e,r)}(o,t)}function N(t){return{literal:t}}function S(t,o){return{props:t,additional:o}}function D(t){return{props:[],additional:t}}function R(t){return{ref:t}}const G={ArtilleryData:S([{json:"aggregate",js:"aggregate",typ:R("Aggregate")},{json:"intermediate",js:"intermediate",typ:function J(t){return{arrayItems:t}}(R("Intermediate"))},{json:"date",js:"date",typ:""}],!1),Aggregate:S([{json:"counters",js:"counters",typ:D(0)},{json:"rates",js:"rates",typ:R("Rates")},{json:"firstCounterAt",js:"firstCounterAt",typ:0},{json:"firstHistogramAt",js:"firstHistogramAt",typ:0},{json:"lastCounterAt",js:"lastCounterAt",typ:0},{json:"lastHistogramAt",js:"lastHistogramAt",typ:0},{json:"firstMetricAt",js:"firstMetricAt",typ:0},{json:"lastMetricAt",js:"lastMetricAt",typ:0},{json:"period",js:"period",typ:0},{json:"summaries",js:"summaries",typ:R("Histograms")},{json:"histograms",js:"histograms",typ:R("Histograms")}],!1),Histograms:S([{json:"http.response_time",js:"http.response_time",typ:D(3.14)},{json:"plugins.metrics-by-endpoint.response_time./",js:"plugins.metrics-by-endpoint.response_time./",typ:D(3.14)},{json:"vusers.session_length",js:"vusers.session_length",typ:function k(...t){return{unionMembers:t}}(void 0,D(3.14))}],!1),Rates:S([{json:"http.request_rate",js:"http.request_rate",typ:0}],!1),Intermediate:S([{json:"counters",js:"counters",typ:D(0)},{json:"rates",js:"rates",typ:R("Rates")},{json:"http.request_rate",js:"http.request_rate",typ:null},{json:"firstCounterAt",js:"firstCounterAt",typ:0},{json:"firstHistogramAt",js:"firstHistogramAt",typ:0},{json:"lastCounterAt",js:"lastCounterAt",typ:0},{json:"lastHistogramAt",js:"lastHistogramAt",typ:0},{json:"firstMetricAt",js:"firstMetricAt",typ:0},{json:"lastMetricAt",js:"lastMetricAt",typ:0},{json:"period",js:"period",typ:""},{json:"summaries",js:"summaries",typ:R("Histograms")},{json:"histograms",js:"histograms",typ:R("Histograms")}],!1)};var W=u(1626);let B=(()=>{var t;class o{constructor(e,r){this.firestore=e,this.http=r,this.url="https://devprobeapi.onrender.com/create_load_test"}getLoadTestHistory(e,r,a){var c=this;return(0,f.A)(function*(){const j=(0,M.H9)(c.firestore,"teams",e,"products",r,"load_test",a),y=yield(0,M.x7)(j);if(y.exists()){let h=y.data();console.log(h);let m=Object.keys(h);console.log(m);for(let p of m){let i=A.toArtilleryData(h[p]);h[p]=i}return h}return{}})()}sendLoadTest(e,r,a,c){var j=this;return(0,f.A)(function*(){try{const y={team:e,product:r,service:a,target:`https://${c}`};return yield j.http.post(j.url,y).toPromise()}catch{return{}}})()}}return(t=o).\u0275fac=function(e){return new(e||t)(s.KVO(M._7),s.KVO(W.Qq))},t.\u0275prov=s.jDH({token:t,factory:t.\u0275fac,providedIn:"root"}),o})();var K=u(8453),X=u(3241),z=u(2820);const Y=[{path:"",component:(()=>{var t;class o{constructor(e,r,a,c,j){this.router=e,this.activatedRoute=r,this.loadTestService=a,this.loadingCtrl=c,this.alertCtrl=j,this.productStep="",this.productObjective="",this.orgName="",this.target="",this.description="",this.loadTestResults={},this.statusCodesOptions={tooltip:{trigger:"axis"},xAxis:{type:"category",boundaryGap:!1,data:[]},yAxis:{type:"value"},series:[]},this.totalNumberOfRequests=0}ngOnInit(){}ionViewWillEnter(){var e=this;return(0,f.A)(function*(){e.getParams(),yield e.getHistoryResults().then(()=>{e.byCodes(),e.totalRequests()})})()}getParams(){this.activatedRoute.params.subscribe(r=>{this.productObjective=r.productObjective,this.productStep=r.step});const e=JSON.parse(localStorage.getItem("user"));this.orgName=e.orgName,console.log(this.orgName),console.log(this.productObjective),console.log(this.productStep)}sendRequest(){var e=this;return(0,f.A)(function*(){if(yield e.showLoading(),e.target.startsWith("http://")||e.target.startsWith("https://")||e.target.endsWith("/"))return yield e.hideLoading(),void(yield e.showAlert("No http or https is needed, check for slashes at the end of the domain","Please enter a valid host"));yield e.loadTestService.sendLoadTest(e.orgName,e.productObjective,e.productStep,e.target).then(function(){var r=(0,f.A)(function*(a){yield e.hideLoading(),console.log("data",a),a&&(yield e.showAlert("Test sent, please wait a few seconds to GET RESULTS","Success"))});return function(a){return r.apply(this,arguments)}}()),yield e.hideLoading()})()}getHistoryResults(){var e=this;return(0,f.A)(function*(){yield e.showLoading(),yield e.loadTestService.getLoadTestHistory(e.orgName,e.productObjective,e.productStep).then(r=>{e.loadTestResults=r,console.log(e.loadTestResults)}),yield e.hideLoading()})()}totalRequests(){let e=Object.keys(this.loadTestResults),r={};console.log(e);let a=0;for(let c of e){let j=this.loadTestResults[c].aggregate.counters,y=this.loadTestResults[c].date,h=Object.keys(j).filter(m=>m.startsWith("http.requests"));for(let m of h)r[y]||(r[y]={}),r[y][m]=(r[y][m]||0)+j[m]}for(let c of Object.keys(r))a+=r[c]["http.requests"];this.totalNumberOfRequests=a,console.log(this.totalNumberOfRequests)}byCodes(){let e=Object.keys(this.loadTestResults),r={};for(let h of e){let m=this.loadTestResults[h].aggregate.counters,p=this.loadTestResults[h].date,n=Object.keys(m).filter(i=>i.startsWith("http.codes."));for(let i of n)r[p]||(r[p]={}),r[p][i]=(r[p][i]||0)+m[i]}const a={};Object.entries(r).forEach(([h,m])=>{const p=h.split("-").slice(0,3).join("-");a[p]||(a[p]={}),Object.entries(m).forEach(([n,i])=>{a[p][n]?a[p][n]+=i:"number"==typeof i&&(a[p][n]=i)})});const c=Object.keys(a).sort((h,m)=>new Date(h).getTime()-new Date(m).getTime());let j=new Set;for(let h in a)for(let m in a[h])j.add(m);this.statusCodesOptions.series=[];for(let h of j){let m=[];c.forEach(i=>{m.push(a[i][h]||0)});let n,p=parseInt(h.split(".")[2],10);n=p<300?"#00c600":p<400?"#0080ff":p<500?"#e41313":"#ff7300",this.statusCodesOptions.series.push({name:h,type:"line",data:m,lineStyle:{color:n},itemStyle:{color:n}})}this.statusCodesOptions.xAxis.data=c,this.statusCodesOptions={...this.statusCodesOptions};let y=document.getElementById("httpCodesChart");y.style.width="100%",y.style.height="25em"}showLoading(){var e=this;return(0,f.A)(function*(){yield(yield e.loadingCtrl.create({})).present()})()}hideLoading(){var e=this;return(0,f.A)(function*(){yield e.loadingCtrl.dismiss()})()}showAlert(e,r){var a=this;return(0,f.A)(function*(){const c=yield a.alertCtrl.create({header:r,message:e,buttons:["OK"]});return yield c.present(),yield c.onDidDismiss(),!0})()}}return(t=o).\u0275fac=function(e){return new(e||t)(s.rXU(b.Ix),s.rXU(b.nX),s.rXU(B),s.rXU(d.Xi),s.rXU(d.hG))},t.\u0275cmp=s.VBU({type:t,selectors:[["app-load-test"]],decls:29,vars:10,consts:[[3,"title"],[3,"fullscreen"],[1,"lg:m-10","md:m-10"],["size","12","size-md","8","size-lg","8",1,""],["label","Target","placeholder","Enter a target","type","text","labelPlacement","stacked",1,"",3,"ngModelChange","ngModel"],["size","12","size-md","12","size-lg","12",1,"flex","flex-row","justify-end"],["color","primary","size","small",1,"",3,"click"],["name","add"],[1,"w-full","p-6","flex","flex-col","justify-center","items-center"],[1,"text-3xl"],[1,"text-2xl","text-white"],[1,"h-[25em]","w-full"],["id","httpCodesChart","echarts","",1,"demo-chart","h-full","w-full",3,"options"]],template:function(e,r){1&e&&(s.nrm(0,"app-header-return",0),s.j41(1,"ion-content",1)(2,"ion-grid"),s.nrm(3,"app-title",0),s.j41(4,"ion-row",2)(5,"ion-col",3)(6,"ion-input",4),s.mxI("ngModelChange",function(c){return s.DH7(r.target,c)||(r.target=c),c}),s.k0s()()(),s.j41(7,"ion-row",2)(8,"ion-col",5)(9,"ion-button",6),s.bIt("click",function(){return r.sendRequest()}),s.EFF(10,"Load Target "),s.nrm(11,"ion-icon",7),s.k0s()()(),s.nrm(12,"app-title",0),s.j41(13,"ion-row",2)(14,"ion-card",8)(15,"ion-card-header")(16,"ion-card-title",9),s.EFF(17,"Total Number of Requests"),s.k0s()(),s.j41(18,"ion-card-content")(19,"h1",10),s.EFF(20),s.nI1(21,"number"),s.k0s()()()(),s.j41(22,"ion-row",2)(23,"ion-card",8)(24,"ion-card-header")(25,"ion-card-title",9),s.EFF(26,"HTTP Status Codes"),s.k0s()(),s.j41(27,"ion-card-content",11),s.nrm(28,"div",12),s.k0s()()()()()),2&e&&(s.Y8G("title","Load Test  For "+r.productStep),s.R7$(),s.Y8G("fullscreen",!0),s.R7$(2),s.Y8G("title","New Load Test"),s.R7$(3),s.R50("ngModel",r.target),s.R7$(6),s.Y8G("title","Analytics For "+r.productStep),s.R7$(8),s.JRh(s.i5U(21,7,r.totalNumberOfRequests,"1.0-0")),s.R7$(8),s.Y8G("options",r.statusCodesOptions))},dependencies:[P.BC,P.vS,d.Jm,d.b_,d.I9,d.ME,d.tN,d.hU,d.W9,d.lO,d.iq,d.$w,d.ln,d.Gw,K.W,X.p,z.$P,g.QX]}),o})()}];let V=(()=>{var t;class o{}return(t=o).\u0275fac=function(e){return new(e||t)},t.\u0275mod=s.$C({type:t}),t.\u0275inj=s.G2t({imports:[b.iI.forChild(Y),b.iI]}),o})();var Q=u(5553);let q=(()=>{var t;class o{}return(t=o).\u0275fac=function(e){return new(e||t)},t.\u0275mod=s.$C({type:t}),t.\u0275inj=s.G2t({imports:[g.MD,P.YN,d.bv,V,Q.h]}),o})()}}]);