"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[2836],{5553:(H,L,h)=>{h.d(L,{h:()=>b});var j=h(177),P=h(7863),g=h(4438);let b=(()=>{var y;class s{}return(y=s).\u0275fac=function(A){return new(A||y)},y.\u0275mod=g.$C({type:y}),y.\u0275inj=g.G2t({imports:[j.MD,P.bv]}),s})()},3241:(H,L,h)=>{h.d(L,{p:()=>b});var j=h(4438),P=h(177),g=h(7863);let b=(()=>{var y;class s{constructor(A){this.location=A,this.title="Header Title"}ngOnInit(){}goBack(){this.location.back()}}return(y=s).\u0275fac=function(A){return new(A||y)(j.rXU(P.aZ))},y.\u0275cmp=j.VBU({type:y,selectors:[["app-header-return"]],inputs:{title:"title"},decls:6,vars:2,consts:[[3,"translucent"],["slot","start","menu","menu-id"],["name","arrow-back","slot","start",1,"p-4","bigger-icon",3,"click"]],template:function(A,O){1&A&&(j.j41(0,"ion-header",0)(1,"ion-toolbar"),j.nrm(2,"ion-menu-button",1),j.j41(3,"ion-icon",2),j.bIt("click",function(){return O.goBack()}),j.k0s(),j.j41(4,"ion-title"),j.EFF(5),j.k0s()()()),2&A&&(j.Y8G("translucent",!0),j.R7$(5),j.JRh(O.title))},dependencies:[g.eU,g.iq,g.MC,g.BC,g.ai],styles:[".bigger-icon[_ngcontent-%COMP%]{font-size:1.5em}"]}),s})()},2836:(H,L,h)=>{h.r(L),h.d(L,{LoadTestPageModule:()=>q});var j=h(177),P=h(4341),g=h(7863),b=h(7650),y=h(467),s=h(4438),M=h(4262);class A{static toArtilleryData(r){return function F(t,r){return E(t,r,I)}(JSON.parse(r),R("ArtilleryData"))}static artilleryDataToJson(r){return JSON.stringify(function $(t,r){return E(t,r,k)}(r,R("ArtilleryData")),null,2)}}function O(t,r,f,e=""){const o=_(t);throw Error(`Invalid value${f?` for key "${f}"`:""}${e?` on ${e}`:""}. Expected ${o} but got ${JSON.stringify(r)}`)}function _(t){return Array.isArray(t)?2===t.length&&void 0===t[0]?`an optional ${_(t[1])}`:`one of [${t.map(r=>_(r)).join(", ")}]`:"object"==typeof t&&void 0!==t.literal?t.literal:typeof t}function I(t){if(void 0===t.jsonToJS){const r={};t.props.forEach(f=>r[f.json]={key:f.js,typ:f.typ}),t.jsonToJS=r}return t.jsonToJS}function k(t){if(void 0===t.jsToJSON){const r={};t.props.forEach(f=>r[f.js]={key:f.json,typ:f.typ}),t.jsToJSON=r}return t.jsToJSON}function E(t,r,f,e="",o=""){if("any"===r)return t;if(null===r)return null===t?t:O(r,t,e,o);if(!1===r)return O(r,t,e,o);let n;for(;"object"==typeof r&&void 0!==r.ref;)n=r.ref,r=J[r.ref];return Array.isArray(r)?function a(u,i){return-1!==u.indexOf(i)?i:O(u.map(T=>w(T)),i,e,o)}(r,t):"object"==typeof r?r.hasOwnProperty("unionMembers")?function c(u,i){const T=u.length;for(let v=0;v<T;v++){const C=u[v];try{return E(i,C,f)}catch{}}return O(u,i,e,o)}(r.unionMembers,t):r.hasOwnProperty("arrayItems")?function m(u,i){return Array.isArray(i)?i.map(T=>E(T,u,f)):O(w("array"),i,e,o)}(r.arrayItems,t):r.hasOwnProperty("props")?function l(u,i,T){if(null===T||"object"!=typeof T||Array.isArray(T))return O(w(n||"object"),T,e,o);const v={};return Object.getOwnPropertyNames(u).forEach(C=>{const x=u[C],N=Object.prototype.hasOwnProperty.call(T,C)?T[C]:void 0;v[x.key]=void 0!==N?E(N,x.typ,f,C,n):void 0}),Object.getOwnPropertyNames(T).forEach(C=>{Object.prototype.hasOwnProperty.call(u,C)||(v[C]=E(T[C],i,f,C,n))}),v}(f(r),r.additional,t):O(r,t,e,o):r===Date&&"number"!=typeof t?function d(u){if(null===u)return null;const i=new Date(u);return isNaN(i.valueOf())?O(w("Date"),u,e,o):i}(t):function p(u,i){return typeof u==typeof i?i:O(u,i,e,o)}(r,t)}function w(t){return{literal:t}}function D(t,r){return{props:t,additional:r}}function S(t){return{props:[],additional:t}}function R(t){return{ref:t}}const J={ArtilleryData:D([{json:"aggregate",js:"aggregate",typ:R("Aggregate")},{json:"intermediate",js:"intermediate",typ:function U(t){return{arrayItems:t}}(R("Intermediate"))},{json:"date",js:"date",typ:""}],!1),Aggregate:D([{json:"counters",js:"counters",typ:S(0)},{json:"rates",js:"rates",typ:R("Rates")},{json:"firstCounterAt",js:"firstCounterAt",typ:0},{json:"firstHistogramAt",js:"firstHistogramAt",typ:0},{json:"lastCounterAt",js:"lastCounterAt",typ:0},{json:"lastHistogramAt",js:"lastHistogramAt",typ:0},{json:"firstMetricAt",js:"firstMetricAt",typ:0},{json:"lastMetricAt",js:"lastMetricAt",typ:0},{json:"period",js:"period",typ:0},{json:"summaries",js:"summaries",typ:R("Histograms")},{json:"histograms",js:"histograms",typ:R("Histograms")}],!1),Histograms:D([{json:"http.response_time",js:"http.response_time",typ:S(3.14)},{json:"plugins.metrics-by-endpoint.response_time./",js:"plugins.metrics-by-endpoint.response_time./",typ:S(3.14)},{json:"vusers.session_length",js:"vusers.session_length",typ:function G(...t){return{unionMembers:t}}(void 0,S(3.14))}],!1),Rates:D([{json:"http.request_rate",js:"http.request_rate",typ:0}],!1),Intermediate:D([{json:"counters",js:"counters",typ:S(0)},{json:"rates",js:"rates",typ:R("Rates")},{json:"http.request_rate",js:"http.request_rate",typ:null},{json:"firstCounterAt",js:"firstCounterAt",typ:0},{json:"firstHistogramAt",js:"firstHistogramAt",typ:0},{json:"lastCounterAt",js:"lastCounterAt",typ:0},{json:"lastHistogramAt",js:"lastHistogramAt",typ:0},{json:"firstMetricAt",js:"firstMetricAt",typ:0},{json:"lastMetricAt",js:"lastMetricAt",typ:0},{json:"period",js:"period",typ:""},{json:"summaries",js:"summaries",typ:R("Histograms")},{json:"histograms",js:"histograms",typ:R("Histograms")}],!1)};var W=h(1626);let B=(()=>{var t;class r{constructor(e,o){this.firestore=e,this.http=o,this.url="https://devprobeapi.onrender.com/create_load_test"}getLoadTestHistory(e,o,p){var c=this;return(0,y.A)(function*(){const a=(0,M.H9)(c.firestore,"teams",e,"products",o,"load_test",p),m=yield(0,M.x7)(a);if(m.exists()){let d=m.data();console.log(d);let l=Object.keys(d);console.log(l);for(let n of l){let i=A.toArtilleryData(d[n]);d[n]=i}return d}return{}})()}sendLoadTest(e,o,p,c){var a=this;return(0,y.A)(function*(){try{const m={team:e,product:o,service:p,target:`https://${c}`};return yield a.http.post(a.url,m).toPromise()}catch{return{}}})()}}return(t=r).\u0275fac=function(e){return new(e||t)(s.KVO(M._7),s.KVO(W.Qq))},t.\u0275prov=s.jDH({token:t,factory:t.\u0275fac,providedIn:"root"}),r})();var K=h(8453),X=h(3241),z=h(2820);const Y=[{path:"",component:(()=>{var t;class r{constructor(e,o,p,c,a){this.router=e,this.activatedRoute=o,this.loadTestService=p,this.loadingCtrl=c,this.alertCtrl=a,this.productStep="",this.productObjective="",this.orgName="",this.target="",this.description="",this.loadTestResults={},this.totalNumberOfRequests=0,this.statusCodesOptions={tooltip:{trigger:"axis"},xAxis:{type:"category",boundaryGap:!1,data:[]},yAxis:{type:"value"},series:[]},this.responseTimeOptions={tooltip:{trigger:"axis"},xAxis:{type:"category",boundaryGap:!1,data:[]},yAxis:{type:"value"},series:[]}}ngOnInit(){}ionViewWillEnter(){var e=this;return(0,y.A)(function*(){e.getParams(),yield e.getHistoryResults().then(()=>{e.byCodes(),e.totalRequests(),e.responseTime()})})()}getParams(){this.activatedRoute.params.subscribe(o=>{this.productObjective=o.productObjective,this.productStep=o.step});const e=JSON.parse(localStorage.getItem("user"));this.orgName=e.orgName,console.log(this.orgName),console.log(this.productObjective),console.log(this.productStep)}sendRequest(){var e=this;return(0,y.A)(function*(){if(yield e.showLoading(),e.target.startsWith("http://")||e.target.startsWith("https://")||e.target.endsWith("/"))return yield e.hideLoading(),void(yield e.showAlert("No http or https is needed, check for slashes at the end of the domain","Please enter a valid host"));yield e.loadTestService.sendLoadTest(e.orgName,e.productObjective,e.productStep,e.target).then(function(){var o=(0,y.A)(function*(p){yield e.hideLoading(),console.log("data",p),p&&(yield e.showAlert("Test sent, please wait a few seconds to GET RESULTS","Success"))});return function(p){return o.apply(this,arguments)}}()),yield e.hideLoading()})()}getHistoryResults(){var e=this;return(0,y.A)(function*(){yield e.showLoading(),yield e.loadTestService.getLoadTestHistory(e.orgName,e.productObjective,e.productStep).then(o=>{e.loadTestResults=o,console.log(e.loadTestResults)}),yield e.hideLoading()})()}totalRequests(){let e=Object.keys(this.loadTestResults),o={};console.log(e);let p=0;for(let c of e){let a=this.loadTestResults[c].aggregate.counters,m=this.loadTestResults[c].date,d=Object.keys(a).filter(l=>l.startsWith("http.requests"));for(let l of d)o[m]||(o[m]={}),o[m][l]=(o[m][l]||0)+a[l]}for(let c of Object.keys(o))p+=o[c]["http.requests"];this.totalNumberOfRequests=p,console.log(this.totalNumberOfRequests)}byCodes(){let e=Object.keys(this.loadTestResults),o={};for(let m of e){let d=this.loadTestResults[m].aggregate.counters,l=this.loadTestResults[m].date.split("-").slice(0,3).join("-"),n=Object.keys(d).filter(u=>u.startsWith("http.codes."));o[l]||(o[l]={});for(let u of n)o[l][u]=(o[l][u]||0)+d[u]}const p=Object.keys(o).sort((m,d)=>new Date(m).getTime()-new Date(d).getTime());let c=new Set;for(let m in o)for(let d in o[m])c.add(d);this.statusCodesOptions.series=[];for(let m of c){let d=[];p.forEach(u=>{d.push(o[u][m]||0)});let n,l=parseInt(m.split(".")[2],10);n=l<300?"#00c600":l<400?"#0080ff":l<500?"#e41313":"#ff7300",this.statusCodesOptions.series.push({name:m,type:"line",data:d,lineStyle:{color:n},itemStyle:{color:n}})}this.statusCodesOptions.xAxis.data=p,this.statusCodesOptions={...this.statusCodesOptions};let a=document.getElementById("httpCodesChart");a&&(a.style.width="100%",a.style.height="25em")}responseTime(){let e=Object.keys(this.loadTestResults),o={};for(let l of e){let n=this.loadTestResults[l].aggregate.histograms,u=this.loadTestResults[l].date,i=Object.keys(n).filter(T=>T.startsWith("http.response_time"));for(let T of i)o[u]=n[T]}let p=Object.entries(o).reduce((l,[n,u])=>{const i=n.split("-").slice(0,3).join("-");return l[i]=l[i]||[],l[i].push(u),l},{});console.log(p);let c=Object.keys(p).sort((l,n)=>new Date(l).getTime()-new Date(n).getTime()),a={count:0,max:0,min:0,mean:0,median:0,p50:0,p90:0,p95:0,p99:0,p999:0},m={};console.log(c),c.forEach(l=>{let n={count:0,max:0,min:0,mean:0,median:0,p50:0,p90:0,p95:0,p99:0,p999:0},u=0;p[l].forEach(i=>{n.count+=i.count,n.max+=i.max,n.min+=i.min,n.mean+=i.mean,n.median+=i.median,n.p50+=i.p50,n.p90+=i.p90,n.p95+=i.p95,n.p99+=i.p99,n.p999+=i.p999,u++});for(let i in n)"count"!==i&&u>0&&(n[i]=n[i]/u);m[l]=n,a.count+=n.count,a.max+=n.max,a.min+=n.min,a.mean+=n.mean,a.median+=n.median,a.p50+=n.p50,a.p90+=n.p90,a.p95+=n.p95,a.p99+=n.p99,a.p999+=n.p999});let d=c.length;d>0&&(a.mean/=d,a.median/=d,a.p50/=d,a.p90/=d,a.p95/=d,a.p99/=d,a.p999/=d,a.max/=d,a.min/=d);for(let l in a)"count"===l||"p90"===l||"p50"===l||"p999"===l||this.responseTimeOptions.series.push({name:l,type:"bar",data:[a[l]],label:{show:!0,formatter:n=>`${n.value.toFixed(2)} ms`}});console.log("this.responseTimeOptions",this.responseTimeOptions),this.responseTimeOptions.xAxis={type:"category",boundaryGap:!1,data:["Category"]},this.responseTimeOptions={...this.responseTimeOptions}}showLoading(){var e=this;return(0,y.A)(function*(){yield(yield e.loadingCtrl.create({})).present()})()}hideLoading(){var e=this;return(0,y.A)(function*(){yield e.loadingCtrl.dismiss()})()}showAlert(e,o){var p=this;return(0,y.A)(function*(){const c=yield p.alertCtrl.create({header:o,message:e,buttons:["OK"]});return yield c.present(),yield c.onDidDismiss(),!0})()}}return(t=r).\u0275fac=function(e){return new(e||t)(s.rXU(b.Ix),s.rXU(b.nX),s.rXU(B),s.rXU(g.Xi),s.rXU(g.hG))},t.\u0275cmp=s.VBU({type:t,selectors:[["app-load-test"]],decls:36,vars:11,consts:[[3,"title"],[3,"fullscreen"],[1,"lg:m-10","md:m-10"],["size","12","size-md","8","size-lg","8",1,""],["label","Target","placeholder","Enter a target","type","text","labelPlacement","stacked",1,"",3,"ngModelChange","ngModel"],["size","12","size-md","12","size-lg","12",1,"flex","flex-row","justify-end"],["color","primary","size","small",1,"",3,"click"],["name","add"],[1,"w-full","p-6","flex","flex-col","justify-center","items-center"],[1,"text-3xl"],[1,"text-2xl","text-white"],[1,"h-[25em]","w-full"],["id","httpCodesChart","echarts","",1,"demo-chart","h-full","w-full",3,"options"],["id","httpResponseTimeChart","echarts","",1,"demo-chart","h-full","w-full",3,"options"]],template:function(e,o){1&e&&(s.nrm(0,"app-header-return",0),s.j41(1,"ion-content",1)(2,"ion-grid"),s.nrm(3,"app-title",0),s.j41(4,"ion-row",2)(5,"ion-col",3)(6,"ion-input",4),s.mxI("ngModelChange",function(c){return s.DH7(o.target,c)||(o.target=c),c}),s.k0s()()(),s.j41(7,"ion-row",2)(8,"ion-col",5)(9,"ion-button",6),s.bIt("click",function(){return o.sendRequest()}),s.EFF(10,"Load Target "),s.nrm(11,"ion-icon",7),s.k0s()()(),s.nrm(12,"app-title",0),s.j41(13,"ion-row",2)(14,"ion-card",8)(15,"ion-card-header")(16,"ion-card-title",9),s.EFF(17,"Total Number of Requests"),s.k0s()(),s.j41(18,"ion-card-content")(19,"h1",10),s.EFF(20),s.nI1(21,"number"),s.k0s()()()(),s.j41(22,"ion-row",2)(23,"ion-card",8)(24,"ion-card-header")(25,"ion-card-title",9),s.EFF(26,"HTTP Status Codes"),s.k0s()(),s.j41(27,"ion-card-content",11),s.nrm(28,"div",12),s.k0s()()(),s.j41(29,"ion-row",2)(30,"ion-card",8)(31,"ion-card-header")(32,"ion-card-title",9),s.EFF(33,"HTTP Response Time"),s.k0s()(),s.j41(34,"ion-card-content",11),s.nrm(35,"div",13),s.k0s()()()()()),2&e&&(s.Y8G("title","Load Test  For "+o.productStep),s.R7$(),s.Y8G("fullscreen",!0),s.R7$(2),s.Y8G("title","New Load Test"),s.R7$(3),s.R50("ngModel",o.target),s.R7$(6),s.Y8G("title","Analytics For "+o.productStep),s.R7$(8),s.JRh(s.i5U(21,8,o.totalNumberOfRequests,"1.0-0")),s.R7$(8),s.Y8G("options",o.statusCodesOptions),s.R7$(7),s.Y8G("options",o.responseTimeOptions))},dependencies:[P.BC,P.vS,g.Jm,g.b_,g.I9,g.ME,g.tN,g.hU,g.W9,g.lO,g.iq,g.$w,g.ln,g.Gw,K.W,X.p,z.$P,j.QX]}),r})()}];let V=(()=>{var t;class r{}return(t=r).\u0275fac=function(e){return new(e||t)},t.\u0275mod=s.$C({type:t}),t.\u0275inj=s.G2t({imports:[b.iI.forChild(Y),b.iI]}),r})();var Q=h(5553);let q=(()=>{var t;class r{}return(t=r).\u0275fac=function(e){return new(e||t)},t.\u0275mod=s.$C({type:t}),t.\u0275inj=s.G2t({imports:[j.MD,P.YN,g.bv,V,Q.h]}),r})()}}]);