"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[8533],{8533:(P,m,u)=>{u.r(m),u.d(m,{LatencyTestPageModule:()=>C});var f=u(177),y=u(4341),c=u(7863),g=u(305),d=u(467),e=u(4438),R=u(9640),T=u(1681),L=u(8453),v=u(3241);function A(o,a){if(1&o){const l=e.RV6();e.j41(0,"ion-chip",19),e.bIt("click",function(){const i=e.eBV(l).$implicit,n=e.XpG();return e.Njj(n.selectCountry(i))}),e.EFF(1),e.k0s()}if(2&o){const l=a.$implicit,t=e.XpG();e.Y8G("color",t.isCountrySelected(l)?"primary":""),e.R7$(),e.SpI(" ",l," ")}}function S(o,a){if(1&o&&(e.j41(0,"ion-item")(1,"ion-label"),e.EFF(2),e.k0s(),e.j41(3,"ion-label"),e.EFF(4),e.k0s(),e.j41(5,"ion-label"),e.EFF(6),e.k0s()()),2&o){const l=a.$implicit;e.R7$(2),e.Lme("FROM ",l.cityFrom,",",l.countryFrom,""),e.R7$(2),e.SpI("",l.latency," ms"),e.R7$(2),e.Lme(" TO ",l.cityTo,",",l.countryTo,"")}}function F(o,a){if(1&o){const l=e.RV6();e.j41(0,"ion-item",20),e.bIt("click",function(){const i=e.eBV(l).$implicit,n=e.XpG();return e.Njj(n.viewHistory(i))}),e.j41(1,"ion-label"),e.EFF(2),e.k0s(),e.nrm(3,"ion-icon",21),e.k0s()}if(2&o){const l=a.$implicit;e.R7$(2),e.JRh(l)}}const I=[{path:"",component:(()=>{var o;class a{constructor(t,i,n,s,r,p){this.ripeService=t,this.loadingCtrl=i,this.locationService=n,this.route=s,this.alertCtrl=r,this.router=p,this.user={},this.orgName="",this.productObjective="",this.productStep="",this.host="portfoliojuanfranciscocisneros.web.app",this.description="NEW IONIC",this.type="ping",this.ripeResults=[],this.ripeHistoryResultsID=[],this.selectedCountries=[],this.countries={names:["BRAZIL","AUSTRALIA","USA","RUSSIA","UK","GERMANY","ITALY","SPAIN","FRANCE","JAPAN","ARGENTINA","SOUTH_AFRICA","SAUDI_ARABIA","GUATEMALA","THAILAND","INDIA"],probeIDs:[1003561,1007336,1008100,1000053,1002575,1005576,1006903,1004167,1004967,61328,62589,62590,62643,51757,1004373,1007631]}}ngOnInit(){}ionViewWillEnter(){var t=this;return(0,d.A)(function*(){yield t.showLoading(),t.route.params.subscribe(n=>{t.productObjective=n.productObjective,t.productStep=n.step;const s=new Date,r=s.getDate()+"-"+(s.getMonth()+1)+"-"+s.getFullYear()+"-"+s.getHours()+":"+s.getMinutes()+":"+s.getSeconds();t.description=n.productObjective+"-"+n.step+"-"+r});const i=localStorage.getItem("user");i&&(t.user=JSON.parse(i),t.orgName=t.user.orgName,yield t.getHistoryResults(t.orgName,t.productObjective),yield t.hideLoading())})()}sendRequest(){var t=this;return(0,d.A)(function*(){if(yield t.showLoading(),t.host.startsWith("http://")||t.host.startsWith("https://")||t.host.endsWith("/"))return yield t.hideLoading(),void(yield t.showAlert("No http or https is needed, check for slashes at the end of the domain","Please enter a valid host"));if(0===t.selectedCountries.length)return yield t.hideLoading(),void(yield t.showAlert("Please select at least one country","Error"));let i="";for(let h=0;h<t.selectedCountries.length;h++)i+=t.countries.probeIDs[t.countries.names.indexOf(t.selectedCountries[h])]+",";const n=yield t.ripeService.sendMeasurementRequest(t.host,t.description,t.type,i);yield t.hideLoading();const s=!1!==n?`Test sent, please wait a few seconds to GET RESULTS for ID: ${n}`:"Test not sent",r=!1!==n?"Success":"Error";!1!==n?(yield t.showAlert(s,r))&&(yield t.showLoading(),yield new Promise(h=>setTimeout(h,5e3)),yield t.hideLoading(),yield t.getResults()):yield t.showAlert(s,r)})()}getResults(){var t=this;return(0,d.A)(function*(){yield t.showLoading(),t.ripeResults=[];try{let i=yield t.ripeService.getMeasurementResults();if(!i)return yield t.hideLoading(),void(yield t.showAlert("Please send a test first","Error"));i.subscribe(function(){var n=(0,d.A)(function*(s){if(0===s.length)return yield t.hideLoading(),yield t.showAlert("No data found yet","Trying again"),void(yield t.getResults());for(let r=0;r<s.length;r++)t.ripeResults.push({latency:s[r].avg,dst_addr:s[r].dst_addr,from:s[r].from,toLatitude:0,toLongitude:0,fromLatitude:0,fromLongitude:0,cityTo:"",countryTo:"",cityFrom:"",countryFrom:"",id:t.ripeService.measurementID});yield t.ripeService.saveMeasurementResults(t.orgName,t.productObjective,t.description,t.ripeResults).then((0,d.A)(function*(){yield t.locationService.getLocation(t.ripeResults).then(r=>{t.ripeResults=r,t.locationService.saveLocationResults(t.orgName,t.productObjective,t.description,r).then(function(){var p=(0,d.A)(function*(h){h&&(yield t.getHistoryResults(t.orgName,t.productObjective),yield t.hideLoading(),yield t.showAlert("Data saved and Showing Results, you can get more results in the test history","Success"))});return function(h){return p.apply(this,arguments)}}())})}))});return function(s){return n.apply(this,arguments)}}())}catch{yield t.hideLoading(),yield t.showAlert("Error getting results","Error")}})()}handleChange(t){this.type=t.detail.value}getHistoryResults(t,i){var n=this;return(0,d.A)(function*(){n.ripeHistoryResultsID=[];const s=yield n.ripeService.getHistoryResults(t,i);for(let r=0;r<s.length;r++)s[r].id.split("-")[1]===n.productStep&&n.ripeHistoryResultsID.push(s[r].id);n.ripeHistoryResultsID.sort((r,p)=>new Date(p.split("-")[2])-new Date(r.split("-")[2]))})()}selectCountry(t){const i=this.selectedCountries.indexOf(t);i>-1?this.selectedCountries.splice(i,1):this.selectedCountries.push(t)}isCountrySelected(t){return this.selectedCountries.includes(t)}showLoading(){var t=this;return(0,d.A)(function*(){yield(yield t.loadingCtrl.create({})).present()})()}hideLoading(){var t=this;return(0,d.A)(function*(){yield t.loadingCtrl.dismiss()})()}showAlert(t,i){var n=this;return(0,d.A)(function*(){const s=yield n.alertCtrl.create({header:i,message:t,buttons:["OK"]});return yield s.present(),yield s.onDidDismiss(),!0})()}viewHistory(t){var i=this;return(0,d.A)(function*(){yield i.router.navigate(["/latency-results"],{queryParams:{description:t,productObjective:i.productObjective,step:i.productStep}})})()}}return(o=a).\u0275fac=function(t){return new(t||o)(e.rXU(R.Q),e.rXU(c.Xi),e.rXU(T.N),e.rXU(g.nX),e.rXU(c.hG),e.rXU(g.Ix))},o.\u0275cmp=e.VBU({type:o,selectors:[["app-latency-test"]],inputs:{host:"host",description:"description"},decls:39,vars:9,consts:[[3,"title"],[3,"fullscreen"],[1,"lg:m-10","md:m-10"],["size","12","size-md","4","size-lg","4",1,""],["label","Host Name","placeholder","Enter a host name","type","text","labelPlacement","stacked",1,"",3,"ngModelChange","ngModel"],["size","12","size-md","4","size-lg","4"],["readonly","true","label","Description","placeholder","Enter a description","type","text","labelPlacement","stacked",1,"",3,"ngModelChange","ngModel"],["size","12","size-md","12","size-lg","12"],[1,"text-xl"],[1,"m-2",3,"color"],["size","12","size-md","12","size-lg","12",1,"flex","flex-row","justify-end"],["color","primary","size","small",1,"",3,"click"],["name","add"],[4,"ngFor","ngForOf"],["size","12","size-md","12","size-lg","12",1,"flex","flex-row","justify-end","items-center"],[1,"m-2"],["color","warning","size","small",1,"",3,"click"],["name","refresh"],[3,"click",4,"ngFor","ngForOf"],[1,"m-2",3,"click","color"],[3,"click"],["name","arrow-forward","color","primary"]],template:function(t,i){1&t&&(e.nrm(0,"app-header-return",0),e.j41(1,"ion-content",1)(2,"ion-grid"),e.nrm(3,"app-title",0),e.j41(4,"ion-row",2)(5,"ion-col",3)(6,"ion-input",4),e.mxI("ngModelChange",function(s){return e.DH7(i.host,s)||(i.host=s),s}),e.k0s()(),e.j41(7,"ion-col",5)(8,"ion-input",6),e.mxI("ngModelChange",function(s){return e.DH7(i.description,s)||(i.description=s),s}),e.k0s()()(),e.j41(9,"ion-row",2)(10,"ion-col",7)(11,"h3",8),e.EFF(12,"Select Countries to test"),e.k0s()()(),e.j41(13,"ion-row",2)(14,"ion-col",7),e.Z7z(15,A,2,2,"ion-chip",9,e.fX1),e.k0s()(),e.j41(17,"ion-row",2)(18,"ion-col",10)(19,"ion-button",11),e.bIt("click",function(){return i.sendRequest()}),e.EFF(20,"Add Test "),e.nrm(21,"ion-icon",12),e.k0s()()(),e.nrm(22,"app-title",0),e.j41(23,"ion-row",2)(24,"ion-col",7)(25,"ion-list"),e.DNE(26,S,7,5,"ion-item",13),e.k0s()()(),e.j41(27,"ion-row",2)(28,"ion-col",14)(29,"ion-label",15),e.EFF(30,"Not all results are shown? "),e.k0s(),e.j41(31,"ion-button",16),e.bIt("click",function(){return i.getResults()}),e.EFF(32,"GET MORE RESULTS "),e.nrm(33,"ion-icon",17),e.k0s()()(),e.nrm(34,"app-title",0),e.j41(35,"ion-row",2)(36,"ion-col",7)(37,"ion-list"),e.DNE(38,F,4,1,"ion-item",18),e.k0s()()()()()),2&t&&(e.Y8G("title","Latency Test"),e.R7$(),e.Y8G("fullscreen",!0),e.R7$(2),e.Y8G("title","New Latency Test"),e.R7$(3),e.R50("ngModel",i.host),e.R7$(2),e.R50("ngModel",i.description),e.R7$(7),e.Dyx(i.countries.names),e.R7$(7),e.Y8G("title","Test Results"),e.R7$(4),e.Y8G("ngForOf",i.ripeResults),e.R7$(8),e.Y8G("title","Test Results History"),e.R7$(4),e.Y8G("ngForOf",i.ripeHistoryResultsID))},dependencies:[f.Sq,y.BC,y.vS,c.Jm,c.ZB,c.hU,c.W9,c.lO,c.iq,c.$w,c.uz,c.he,c.nf,c.ln,c.Gw,L.W,v.p]}),a})()}];let j=(()=>{var o;class a{}return(o=a).\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.$C({type:o}),o.\u0275inj=e.G2t({imports:[g.iI.forChild(I),g.iI]}),a})();var w=u(5553);let C=(()=>{var o;class a{}return(o=a).\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.$C({type:o}),o.\u0275inj=e.G2t({imports:[f.MD,y.YN,c.bv,j,w.h]}),a})()}}]);