"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[8533],{5553:(v,R,c)=>{c.d(R,{h:()=>m});var d=c(177),f=c(7863),r=c(4438);let m=(()=>{var l;class e{}return(l=e).\u0275fac=function(g){return new(g||l)},l.\u0275mod=r.$C({type:l}),l.\u0275inj=r.G2t({imports:[d.MD,f.bv]}),e})()},3241:(v,R,c)=>{c.d(R,{p:()=>m});var d=c(4438),f=c(177),r=c(7863);let m=(()=>{var l;class e{constructor(g){this.location=g,this.title="Header Title"}ngOnInit(){}goBack(){this.location.back()}}return(l=e).\u0275fac=function(g){return new(g||l)(d.rXU(f.aZ))},l.\u0275cmp=d.VBU({type:l,selectors:[["app-header-return"]],inputs:{title:"title"},decls:6,vars:2,consts:[[3,"translucent"],["slot","start","menu","menu-id"],["name","arrow-back","slot","start",1,"p-4","bigger-icon",3,"click"]],template:function(g,T){1&g&&(d.j41(0,"ion-header",0)(1,"ion-toolbar"),d.nrm(2,"ion-menu-button",1),d.j41(3,"ion-icon",2),d.bIt("click",function(){return T.goBack()}),d.k0s(),d.j41(4,"ion-title"),d.EFF(5),d.k0s()()()),2&g&&(d.Y8G("translucent",!0),d.R7$(5),d.JRh(T.title))},dependencies:[r.eU,r.iq,r.MC,r.BC,r.ai],styles:[".bigger-icon[_ngcontent-%COMP%]{font-size:1.5em}"]}),e})()},8533:(v,R,c)=>{c.r(R),c.d(R,{LatencyTestPageModule:()=>F});var d=c(177),f=c(4341),r=c(7863),m=c(4848),l=c(467),e=c(4438),_=c(9640),g=c(1681),T=c(8453),L=c(3241);function C(s,p){if(1&s){const u=e.RV6();e.j41(0,"ion-chip",19),e.bIt("click",function(){const n=e.eBV(u).$implicit,o=e.XpG();return e.Njj(o.selectCountry(n))}),e.EFF(1),e.k0s()}if(2&s){const u=p.$implicit,t=e.XpG();e.Y8G("color",t.isCountrySelected(u)?"primary":""),e.R7$(),e.SpI(" ",u," ")}}function A(s,p){if(1&s&&(e.j41(0,"ion-item")(1,"ion-label"),e.EFF(2),e.k0s(),e.j41(3,"ion-label"),e.EFF(4),e.k0s(),e.j41(5,"ion-label"),e.EFF(6),e.k0s()()),2&s){const u=p.$implicit;e.R7$(2),e.Lme("FROM ",u.cityFrom,",",u.countryFrom,""),e.R7$(2),e.SpI("",u.latency," ms"),e.R7$(2),e.Lme(" TO ",u.cityTo,",",u.countryTo,"")}}function E(s,p){if(1&s){const u=e.RV6();e.j41(0,"ion-item",20),e.bIt("click",function(){const n=e.eBV(u).$implicit,o=e.XpG();return e.Njj(o.viewHistory(n))}),e.j41(1,"ion-label"),e.EFF(2),e.k0s(),e.nrm(3,"ion-icon",21),e.k0s()}if(2&s){const u=p.$implicit;e.R7$(2),e.JRh(u)}}const M=[{path:"",component:(()=>{var s;class p{constructor(t,n,o,i,a,h){this.ripeService=t,this.loadingCtrl=n,this.locationService=o,this.route=i,this.alertCtrl=a,this.router=h,this.user={},this.orgName="",this.productObjective="",this.productStep="",this.host="portfoliojuanfranciscocisneros.web.app",this.description="NEW IONIC",this.type="ping",this.ripeResults=[],this.ripeHistoryResultsID=[],this.selectedCountries=[],this.countries={names:["BRAZIL","AUSTRALIA","USA","RUSSIA","UK","GERMANY","ITALY","SPAIN","FRANCE","JAPAN","ARGENTINA","SOUTH_AFRICA","SAUDI_ARABIA","GUATEMALA","THAILAND","INDIA"],probeIDs:[1003561,1007336,1008100,1000053,1002575,1005576,1006903,1004167,1004967,61328,62589,62590,62643,51757,1004373,1007631]}}ngOnInit(){}ionViewWillEnter(){var t=this;return(0,l.A)(function*(){yield t.showLoading(),t.route.params.subscribe(o=>{t.productObjective=o.productObjective,t.productStep=o.step;const i=new Date,a=i.getDate()+"-"+(i.getMonth()+1)+"-"+i.getFullYear()+"-"+i.getHours()+":"+i.getMinutes()+":"+i.getSeconds();t.description=o.productObjective+"-"+o.step+"-"+a});const n=localStorage.getItem("user");n&&(t.user=JSON.parse(n),t.orgName=t.user.orgName,yield t.getHistoryResults(t.orgName,t.productObjective),yield t.hideLoading())})()}sendRequest(){var t=this;return(0,l.A)(function*(){if(yield t.showLoading(),t.host.startsWith("http://")||t.host.startsWith("https://")||t.host.endsWith("/"))return yield t.hideLoading(),void(yield t.showAlert("No http or https is needed, check for slashes at the end of the domain","Please enter a valid host"));if(0===t.selectedCountries.length)return yield t.hideLoading(),void(yield t.showAlert("Please select at least one country","Error"));let n="";for(let y=0;y<t.selectedCountries.length;y++)n+=t.countries.probeIDs[t.countries.names.indexOf(t.selectedCountries[y])]+",";const o=yield t.ripeService.sendMeasurementRequest(t.host,t.description,t.type,n);yield t.hideLoading();const i=!1!==o?`Test sent, please wait a few seconds to GET RESULTS for ID: ${o}`:"Test not sent",a=!1!==o?"Success":"Error";!1!==o?(yield t.showAlert(i,a))&&(yield t.showLoading(),yield new Promise(y=>setTimeout(y,5e3)),yield t.hideLoading(),yield t.getResults()):yield t.showAlert(i,a)})()}getResults(){var t=this;return(0,l.A)(function*(){yield t.showLoading(),t.ripeResults=[];try{let n=yield t.ripeService.getMeasurementResults();if(!n)return yield t.hideLoading(),void(yield t.showAlert("Please send a test first","Error"));n.subscribe(function(){var o=(0,l.A)(function*(i){if(0===i.length)return yield t.hideLoading(),yield t.showAlert("No data found yet","Trying again"),void(yield t.getResults());for(let a=0;a<i.length;a++)t.ripeResults.push({latency:i[a].avg,dst_addr:i[a].dst_addr,from:i[a].from,toLatitude:0,toLongitude:0,fromLatitude:0,fromLongitude:0,cityTo:"",countryTo:"",cityFrom:"",countryFrom:"",id:t.ripeService.measurementID});yield t.ripeService.saveMeasurementResults(t.orgName,t.productObjective,t.description,t.ripeResults).then((0,l.A)(function*(){yield t.locationService.getLocation(t.ripeResults).then(a=>{t.ripeResults=a,t.locationService.saveLocationResults(t.orgName,t.productObjective,t.description,a).then(function(){var h=(0,l.A)(function*(y){y&&(yield t.getHistoryResults(t.orgName,t.productObjective),yield t.hideLoading(),yield t.showAlert("Data saved and Showing Results, you can get more results in the test history","Success"))});return function(y){return h.apply(this,arguments)}}())})}))});return function(i){return o.apply(this,arguments)}}())}catch{yield t.hideLoading(),yield t.showAlert("Error getting results","Error")}})()}handleChange(t){this.type=t.detail.value}getHistoryResults(t,n){var o=this;return(0,l.A)(function*(){o.ripeHistoryResultsID=[];const i=yield o.ripeService.getHistoryResults(t,n);for(let a=0;a<i.length;a++)i[a].id.split("-")[1]===o.productStep&&o.ripeHistoryResultsID.push(i[a].id);o.ripeHistoryResultsID.sort((a,h)=>new Date(h.split("-")[2])-new Date(a.split("-")[2]))})()}selectCountry(t){const n=this.selectedCountries.indexOf(t);n>-1?this.selectedCountries.splice(n,1):this.selectedCountries.push(t)}isCountrySelected(t){return this.selectedCountries.includes(t)}showLoading(){var t=this;return(0,l.A)(function*(){yield(yield t.loadingCtrl.create({})).present()})()}hideLoading(){var t=this;return(0,l.A)(function*(){yield t.loadingCtrl.dismiss()})()}showAlert(t,n){var o=this;return(0,l.A)(function*(){const i=yield o.alertCtrl.create({header:n,message:t,buttons:["OK"]});return yield i.present(),yield i.onDidDismiss(),!0})()}viewHistory(t){var n=this;return(0,l.A)(function*(){yield n.router.navigate(["/latency-results"],{queryParams:{description:t,productObjective:n.productObjective,step:n.productStep}})})()}}return(s=p).\u0275fac=function(t){return new(t||s)(e.rXU(_.Q),e.rXU(r.Xi),e.rXU(g.N),e.rXU(m.nX),e.rXU(r.hG),e.rXU(m.Ix))},s.\u0275cmp=e.VBU({type:s,selectors:[["app-latency-test"]],inputs:{host:"host",description:"description"},decls:39,vars:9,consts:[[3,"title"],[3,"fullscreen"],[1,"lg:m-10","md:m-10"],["size","12","size-md","4","size-lg","4",1,""],["label","Host Name","placeholder","Enter a host name","type","text","labelPlacement","stacked",1,"",3,"ngModelChange","ngModel"],["size","12","size-md","4","size-lg","4"],["readonly","true","label","Description","placeholder","Enter a description","type","text","labelPlacement","stacked",1,"",3,"ngModelChange","ngModel"],["size","12","size-md","12","size-lg","12"],[1,"text-xl"],[1,"m-2",3,"color"],["size","12","size-md","12","size-lg","12",1,"flex","flex-row","justify-end"],["color","primary","size","small",1,"",3,"click"],["name","add"],[4,"ngFor","ngForOf"],["size","12","size-md","12","size-lg","12",1,"flex","flex-row","justify-end","items-center"],[1,"m-2"],["color","warning","size","small",1,"",3,"click"],["name","refresh"],[3,"click",4,"ngFor","ngForOf"],[1,"m-2",3,"click","color"],[3,"click"],["name","arrow-forward","color","primary"]],template:function(t,n){1&t&&(e.nrm(0,"app-header-return",0),e.j41(1,"ion-content",1)(2,"ion-grid"),e.nrm(3,"app-title",0),e.j41(4,"ion-row",2)(5,"ion-col",3)(6,"ion-input",4),e.mxI("ngModelChange",function(i){return e.DH7(n.host,i)||(n.host=i),i}),e.k0s()(),e.j41(7,"ion-col",5)(8,"ion-input",6),e.mxI("ngModelChange",function(i){return e.DH7(n.description,i)||(n.description=i),i}),e.k0s()()(),e.j41(9,"ion-row",2)(10,"ion-col",7)(11,"h3",8),e.EFF(12,"Select Countries to test"),e.k0s()()(),e.j41(13,"ion-row",2)(14,"ion-col",7),e.Z7z(15,C,2,2,"ion-chip",9,e.fX1),e.k0s()(),e.j41(17,"ion-row",2)(18,"ion-col",10)(19,"ion-button",11),e.bIt("click",function(){return n.sendRequest()}),e.EFF(20,"Add Test "),e.nrm(21,"ion-icon",12),e.k0s()()(),e.nrm(22,"app-title",0),e.j41(23,"ion-row",2)(24,"ion-col",7)(25,"ion-list"),e.DNE(26,A,7,5,"ion-item",13),e.k0s()()(),e.j41(27,"ion-row",2)(28,"ion-col",14)(29,"ion-label",15),e.EFF(30,"Not all results are shown? "),e.k0s(),e.j41(31,"ion-button",16),e.bIt("click",function(){return n.getResults()}),e.EFF(32,"GET MORE RESULTS "),e.nrm(33,"ion-icon",17),e.k0s()()(),e.nrm(34,"app-title",0),e.j41(35,"ion-row",2)(36,"ion-col",7)(37,"ion-list"),e.DNE(38,E,4,1,"ion-item",18),e.k0s()()()()()),2&t&&(e.Y8G("title","Latency Test"),e.R7$(),e.Y8G("fullscreen",!0),e.R7$(2),e.Y8G("title","New Latency Test"),e.R7$(3),e.R50("ngModel",n.host),e.R7$(2),e.R50("ngModel",n.description),e.R7$(7),e.Dyx(n.countries.names),e.R7$(7),e.Y8G("title","Test Results"),e.R7$(4),e.Y8G("ngForOf",n.ripeResults),e.R7$(8),e.Y8G("title","Test Results History"),e.R7$(4),e.Y8G("ngForOf",n.ripeHistoryResultsID))},dependencies:[d.Sq,f.BC,f.vS,r.Jm,r.ZB,r.hU,r.W9,r.lO,r.iq,r.$w,r.uz,r.he,r.nf,r.ln,r.Gw,T.W,L.p]}),p})()}];let P=(()=>{var s;class p{}return(s=p).\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.$C({type:s}),s.\u0275inj=e.G2t({imports:[m.iI.forChild(M),m.iI]}),p})();var I=c(5553);let F=(()=>{var s;class p{}return(s=p).\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.$C({type:s}),s.\u0275inj=e.G2t({imports:[d.MD,f.YN,r.bv,P,I.h]}),p})()}}]);