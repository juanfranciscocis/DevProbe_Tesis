"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[7907],{5553:(G,f,a)=>{a.d(f,{h:()=>m});var l=a(177),C=a(7863),c=a(4438);let m=(()=>{var s;class e{}return(s=e).\u0275fac=function(h){return new(h||s)},s.\u0275mod=c.$C({type:s}),s.\u0275inj=c.G2t({imports:[l.MD,C.bv]}),e})()},3241:(G,f,a)=>{a.d(f,{p:()=>m});var l=a(4438),C=a(177),c=a(7863);let m=(()=>{var s;class e{constructor(h){this.location=h,this.title="Header Title"}ngOnInit(){}goBack(){this.location.back()}}return(s=e).\u0275fac=function(h){return new(h||s)(l.rXU(C.aZ))},s.\u0275cmp=l.VBU({type:s,selectors:[["app-header-return"]],inputs:{title:"title"},decls:6,vars:2,consts:[[3,"translucent"],["slot","start","menu","menu-id"],["name","arrow-back","slot","start",1,"p-4","bigger-icon",3,"click"]],template:function(h,O){1&h&&(l.j41(0,"ion-header",0)(1,"ion-toolbar"),l.nrm(2,"ion-menu-button",1),l.j41(3,"ion-icon",2),l.bIt("click",function(){return O.goBack()}),l.k0s(),l.j41(4,"ion-title"),l.EFF(5),l.k0s()()()),2&h&&(l.Y8G("translucent",!0),l.R7$(5),l.JRh(O.title))},dependencies:[c.eU,c.iq,c.MC,c.BC,c.ai],styles:[".bigger-icon[_ngcontent-%COMP%]{font-size:1.5em}"]}),e})()},7907:(G,f,a)=>{a.r(f),a.d(f,{GraphTracePageModule:()=>x});var l=a(177),C=a(4341),c=a(7863),m=a(305),s=a(467),e=a(4438),y=a(2588),h=a(3241),O=a(4688);function R(i,g){if(1&i&&(e.j41(0,"ion-col",9)(1,"ion-card",10)(2,"ion-card-title",11)(3,"h1",12),e.EFF(4),e.k0s()(),e.nrm(5,"br")(6,"div",13),e.k0s()()),2&i){const p=g.$implicit,t=e.XpG();e.R7$(4),e.JRh(p),e.R7$(2),e.Y8G("options",t.countryOptions[p])}}const D=[{path:"",component:(()=>{var i;class g{constructor(t,o){this.ripeService=t,this.route=o,this.orgName="",this.productObjective="",this.user={},this.data=[],this.countries=[],this.countryOptions={}}ionViewWillEnter(){var t=this;return(0,s.A)(function*(){t.route.queryParams.subscribe(r=>{t.productObjective=r.product});const o=localStorage.getItem("user");o&&(t.user=JSON.parse(o),t.orgName=t.user.orgName,t.data=[],t.getResultsHistoryforRtt().then(()=>{t.groupByDate().then(()=>{t.groupByCountry().then(()=>{t.populateCountries(),t.generateCountryOptions()})})}))})()}getResultsHistoryforRtt(){var t=this;return(0,s.A)(function*(){yield t.ripeService.getHistoryResults(t.orgName,t.productObjective).then(o=>{for(let r=0;r<o.length;r++){let u=o[r].id.split("-");t.data.push({id:u[1],date:u[3]+"/"+u[2]+"/"+u[4],time:u[5],data:o[r].data.data})}console.log(t.data)})})()}groupByDate(){var t=this;return(0,s.A)(function*(){let o={};for(let n=0;n<t.data.length;n++){let d=t.data[n].date;o[d]||(o[d]=[]),o[d].push(...t.data[n].data)}const r=Object.keys(o).sort((n,d)=>new Date(n).getTime()-new Date(d).getTime());let u={};for(let n of r)u[n]=o[n];t.data=u,console.log(t.data)})()}groupByCountry(){var t=this;return(0,s.A)(function*(){let o={};for(let r in t.data){let u=t.data[r];o[r]||(o[r]={});for(let n=0;n<u.length;n++){let d=u[n].src_country;"No country found"!==d&&(o[r][d]||(o[r][d]=[]),o[r][d].push(u[n]))}}t.data=o,console.log(t.data)})()}populateCountries(){var t=this;return(0,s.A)(function*(){const o=new Set;for(let r in t.data)for(let u in t.data[r])o.add(u);t.countries=Array.from(o),console.log(t.countries)})()}getRandomColor(){let o="#";for(let r=0;r<6;r++)o+="0123456789ABCDEF"[Math.floor(16*Math.random())];return o}generateCountryOptions(){for(let t of this.countries){const o=[],r=[];for(let n in this.data){let d=0,P=0;if(this.data[n][t]){for(let M=0;M<this.data[n][t].length;M++){let T=this.data[n][t][M];for(let v=0;v<T.result.length;v++)"number"==typeof T.result[v].result[0].rtt&&(d+=T.result[v].result[0].rtt,P++)}P>0&&(o.push(n),r.push(d/P))}}const u=this.getRandomColor();this.countryOptions[t]={legend:{data:[t],align:"left",backgroundColor:"rgba(255, 255, 255, 0.9)"},tooltip:{},xAxis:{data:o,silent:!1,splitLine:{show:!1}},yAxis:{},series:[{name:t,type:"bar",data:r,itemStyle:{color:u},animationDelay:n=>10*n}],animationEasing:"elasticOut",animationDelayUpdate:n=>5*n}}}refresh(){window.location.reload()}ngOnInit(){}}return(i=g).\u0275fac=function(t){return new(t||i)(e.rXU(y.N),e.rXU(m.nX))},i.\u0275cmp=e.VBU({type:i,selectors:[["app-graph-trace"]],decls:11,vars:3,consts:[[3,"title"],[3,"fullscreen"],[1,"lg:m-10"],["size","6","size-md","6","size-lg","6"],[1,"text-4xl","lg:text-6xl","font-bold"],["size","6","size-md","6","size-lg","6",1,"text-right"],["name","refresh",1,"text-4xl","lg:text-6xl","font-bold","onreloadhover",3,"click"],[1,"lg:m-10","md:m-10"],["size","12","size-md","6","size-lg","6","class","flex flex-row justify-center",4,"ngFor","ngForOf"],["size","12","size-md","6","size-lg","6",1,"flex","flex-row","justify-center"],[1,"w-full","h-96","p-6","flex","flex-col","justify-center","items-center"],[1,""],[1,"text-6xl","font-bold","text-white"],["echarts","",1,"demo-chart","h-full","w-full","min-w-full",3,"options"]],template:function(t,o){1&t&&(e.nrm(0,"app-header-return",0),e.j41(1,"ion-content",1)(2,"ion-grid")(3,"ion-row",2)(4,"ion-col",3)(5,"h1",4),e.EFF(6,"Traceroute Graph"),e.k0s()(),e.j41(7,"ion-col",5)(8,"ion-icon",6),e.bIt("click",function(){return o.refresh()}),e.k0s()()(),e.j41(9,"ion-row",7),e.DNE(10,R,7,2,"ion-col",8),e.k0s()()()),2&t&&(e.Y8G("title","Traceroute Graph"),e.R7$(),e.Y8G("fullscreen",!0),e.R7$(9),e.Y8G("ngForOf",o.countries))},dependencies:[l.Sq,c.b_,c.tN,c.hU,c.W9,c.lO,c.iq,c.ln,h.p,O.$P],styles:["@keyframes _ngcontent-%COMP%_rotate90deg{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.onreloadhover[_ngcontent-%COMP%]:hover{animation:_ngcontent-%COMP%_rotate90deg .9s linear infinite}"]}),g})()}];let _=(()=>{var i;class g{}return(i=g).\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.$C({type:i}),i.\u0275inj=e.G2t({imports:[m.iI.forChild(D),m.iI]}),g})();var E=a(5553);let x=(()=>{var i;class g{}return(i=g).\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.$C({type:i}),i.\u0275inj=e.G2t({imports:[l.MD,C.YN,c.bv,_,E.h]}),g})()}}]);