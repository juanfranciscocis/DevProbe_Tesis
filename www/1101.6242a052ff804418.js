"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[1101],{1101:(x,G,i)=>{i.r(G),i.d(G,{FlameGraphPageModule:()=>U});var b=i(177),C=i(4341),h=i(7863),p=i(305),f=i(467),a=i(4438),M=i(6560),P=i(7616);let w=(()=>{var t;class c{constructor(e,o,u,n){this.flameGraphService=e,this.loadingCtrl=o,this.router=u,this.route=n,this.product={},this.date="",this.config={data:R}}ionViewWillEnter(){this.getProductAndDateFromParams(),this.getFlameGraph()}getProductAndDateFromParams(){this.route.queryParams.subscribe(e=>{this.product=JSON.parse(e.product),this.date=e.date}),console.log(this.product.productObjective),console.log(this.date)}getFlameGraph(){var e=this;return(0,f.A)(function*(){try{yield e.showLoading();const o=localStorage.getItem("user");if(!o)return;const n=JSON.parse(o).orgName;console.log(n);const r=yield e.flameGraphService.getFlameGraphByDate(n,e.product.productObjective,e.date);console.log(r);let l=[],s=[];for(let v in r){const d=null==r?void 0:r[v];s=Object.keys(d),console.log("keys",s);const j=100/s.length;for(let y in s){const F=[];for(let m=0;m<d[s[y]].length;m++)F[m]=e.transformToRawData(d[s[y]][m]);console.log("server1",F);const A={label:s[y],value:j,children:[...F]};l.push(A)}console.log("server",l)}l=[{label:"root",value:100,children:l}],e.config={data:l},console.log("final object",l),yield e.hideLoading()}catch(o){console.log(o)}})()}showLoading(){var e=this;return(0,f.A)(function*(){yield(yield e.loadingCtrl.create({})).present()})()}hideLoading(){var e=this;return(0,f.A)(function*(){yield e.loadingCtrl.dismiss()})()}ngOnInit(){}average(e){const o=e.map(Number);return o.reduce((n,r)=>n+r,0)/o.length}transformToRawData(e){const o=e.cpu_usage?this.average(e.cpu_usage):0,u=[];for(const n in e){if("id"===n||"cpu_usage"===n)continue;const r=e[n];if("object"!=typeof r||Array.isArray(r))"object"!=typeof r&&u.push({label:n,value:0,children:[]});else if("sub_services"===n)for(const l in r){const s=r[l],d={label:l,value:s.cpu_usage?this.average(s.cpu_usage):0,children:this.transformToRawData(s).children};u.push(d)}else{const s={label:n,value:r.cpu_usage?this.average(r.cpu_usage):0,children:this.transformToRawData(r).children};u.push(s)}}return{label:e.id,value:o,children:u}}}return(t=c).\u0275fac=function(e){return new(e||t)(a.rXU(M.x),a.rXU(h.Xi),a.rXU(p.Ix),a.rXU(p.nX))},t.\u0275cmp=a.VBU({type:t,selectors:[["app-flame-graph"]],decls:13,vars:3,consts:[[3,"translucent"],[3,"fullscreen"],["collapse","condense"],["size","large"],[1,"wrapper-responsive"],[3,"config"]],template:function(e,o){1&e&&(a.j41(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-title"),a.EFF(3,"flame-graph"),a.k0s()()(),a.j41(4,"ion-content",1)(5,"ion-header",2)(6,"ion-toolbar")(7,"ion-title",3),a.EFF(8,"flame-graph"),a.k0s()()(),a.j41(9,"h3"),a.EFF(10," Responsive "),a.k0s(),a.j41(11,"div",4),a.nrm(12,"ngx-flamegraph",5),a.k0s()()),2&e&&(a.Y8G("translucent",!0),a.R7$(4),a.Y8G("fullscreen",!0),a.R7$(8),a.Y8G("config",o.config))},dependencies:[h.W9,h.eU,h.BC,h.ai,P.E],styles:[".wrapper-fixed-width[_ngcontent-%COMP%]{width:900px;margin:auto}.wrapper-responsive[_ngcontent-%COMP%]{width:100%;margin:auto}h2[_ngcontent-%COMP%], h3[_ngcontent-%COMP%]{text-align:center;-webkit-user-select:none;user-select:none}"]}),c})();const R=[{label:"root",value:100,children:[]}],D=[{path:"",component:w}];let O=(()=>{var t;class c{}return(t=c).\u0275fac=function(e){return new(e||t)},t.\u0275mod=a.$C({type:t}),t.\u0275inj=a.G2t({imports:[p.iI.forChild(D),p.iI]}),c})(),U=(()=>{var t;class c{}return(t=c).\u0275fac=function(e){return new(e||t)},t.\u0275mod=a.$C({type:t}),t.\u0275inj=a.G2t({imports:[b.MD,C.YN,h.bv,O,P.n]}),c})()}}]);